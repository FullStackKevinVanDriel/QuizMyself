<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="deployed-sha" content="__COMMIT_SHA__">
    <title>QuizMyself - Quiz Yourself on Anything</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: #1a1a2e;
            color: #eaeaea;
            min-height: 100vh;
            line-height: 1.6;
            padding-top: 64px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 1px solid #333;
            margin-bottom: 30px;
        }

        h1 {
            color: #4fc3f7;
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #888;
            font-size: 0.95rem;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: #16213e;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4fc3f7;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #888;
        }

        .menu {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .btn {
            background: #0f3460;
            color: #eaeaea;
            border: none;
            padding: 18px 25px;
            font-size: 1.1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }

        .btn:hover {
            background: #1a4a7a;
            transform: translateX(5px);
        }

        .btn-primary {
            background: #4fc3f7;
            color: #1a1a2e;
            font-weight: bold;
        }

        .btn-primary:hover {
            background: #81d4fa;
        }

        .btn-danger {
            background: #e94560;
        }

        .btn-danger:hover {
            background: #ff6b6b;
        }

        .btn-success {
            background: #27ae60;
        }

        .btn-success:hover {
            background: #2ecc71;
        }

        .btn-small {
            padding: 10px 20px;
            font-size: 0.95rem;
        }

        .quiz-card {
            background: #16213e;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
        }

        .category-badge {
            display: inline-block;
            background: #0f3460;
            color: #4fc3f7;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 1.2rem;
            margin-bottom: 25px;
            line-height: 1.7;
        }


        .choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .choice-btn {
            background: #0f3460;
            color: #eaeaea;
            border: 2px solid transparent;
            padding: 15px 20px;
            font-size: 1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }

        .choice-btn:hover {
            border-color: #4fc3f7;
        }

        .choice-btn.correct {
            background: #27ae60;
            border-color: #2ecc71;
        }

        .choice-btn.incorrect {
            background: #e94560;
            border-color: #ff6b6b;
        }

        .choice-btn.disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .btn-group .btn {
            flex: 1;
            text-align: center;
            min-width: 120px;
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            padding: 15px;
            background: #0f3460;
            border-radius: 10px;
        }

        .checkbox-container input {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-container label {
            cursor: pointer;
            color: #888;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #0f3460;
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4fc3f7, #27ae60);
            transition: width 0.3s;
        }

        .hidden {
            display: none !important;
        }

        /* Category Filter */
        .category-filter {
            background: #16213e;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .category-filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .category-filter-title {
            color: #4fc3f7;
            font-size: 0.95rem;
            font-weight: bold;
        }

        .category-filter-actions {
            display: flex;
            gap: 10px;
        }

        .category-filter-actions button {
            background: none;
            border: none;
            color: #888;
            font-size: 0.8rem;
            cursor: pointer;
            padding: 2px 6px;
        }

        .category-filter-actions button:hover {
            color: #4fc3f7;
        }

        .category-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .category-chip {
            background: #0f3460;
            color: #888;
            border: 2px solid #333;
            padding: 8px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .category-chip:hover {
            border-color: #4fc3f7;
            color: #eaeaea;
        }

        .category-chip.active {
            background: #1a4a7a;
            border-color: #4fc3f7;
            color: #4fc3f7;
        }

        /* Course Content Items */
        .course-item {
            background: #0f3460;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .course-item-category {
            display: inline-block;
            background: #16213e;
            color: #4fc3f7;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            margin-bottom: 10px;
        }

        .course-item-question {
            color: #eaeaea;
            font-size: 1rem;
            font-weight: bold;
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .course-item-answer {
            color: #aaa;
            font-size: 0.9rem;
            line-height: 1.6;
            padding-left: 10px;
            border-left: 3px solid #4fc3f7;
        }

        .result-card {
            text-align: center;
            padding: 40px;
        }

        .result-score {
            font-size: 4rem;
            font-weight: bold;
            color: #4fc3f7;
            margin: 20px 0;
        }

        .result-message {
            font-size: 1.3rem;
            margin-bottom: 30px;
        }

        .pass {
            color: #27ae60;
        }

        .fail {
            color: #e94560;
        }

        .streak-indicator {
            display: inline-block;
            background: #27ae60;
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            margin-left: 10px;
        }

        .question-counter {
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .back-link {
            display: inline-block;
            color: #4fc3f7;
            text-decoration: none;
            padding: 10px 18px;
            background: #1a1a2e;
            border: 2px solid #4fc3f7;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .back-link:hover {
            background: #4fc3f7;
            color: #1a1a2e;
            text-decoration: none;
        }

        .deploy-banner {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #f39c12;
            color: #1a1a2e;
            text-align: center;
            padding: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            z-index: 1000;
        }

        .deploy-banner.hidden {
            display: none;
        }

        body.has-banner {
            padding-top: 40px;
        }

        /* Top Bar */
        .top-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 54px;
            background: #0d1117;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 5px 10px;
            z-index: 1000;
            box-sizing: border-box;
        }

        .top-bar-status {
            display: flex;
            align-items: center;
            height: 44px;
            padding: 0 15px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
        }

        .top-bar-status.pro {
            background: linear-gradient(135deg, #1a472a, #2d5a3d);
            border: 2px solid #ffd700;
            color: #ffd700;
        }

        .top-bar-status.free {
            background: #1a1a2e;
            border: 2px solid #666;
            color: #888;
        }

        .top-bar-status .pro-badge {
            background: linear-gradient(135deg, #ffd700, #ffaa00);
            color: #1a1a2e;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            margin-left: 8px;
        }

        /* Hamburger Menu */
        .hamburger-menu {
            position: relative;
        }

        .hamburger-btn {
            background: #1a1a2e;
            border: 2px solid #4fc3f7;
            color: #4fc3f7;
            font-size: 24px;
            width: 44px;
            height: 44px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hamburger-btn:hover {
            background: #4fc3f7;
            color: #1a1a2e;
        }

        .hamburger-dropdown {
            position: absolute;
            top: 50px;
            right: 0;
            background: #1a1a2e;
            border: 2px solid #4fc3f7;
            border-radius: 8px;
            min-width: 220px;
            padding: 10px 0;
            display: none;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }

        .hamburger-dropdown.show {
            display: block;
        }

        .hamburger-dropdown .menu-item {
            padding: 12px 20px;
            color: #ccc;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hamburger-dropdown .menu-item:hover {
            background: rgba(79, 195, 247, 0.1);
        }

        .hamburger-dropdown .menu-divider {
            border-top: 1px solid #333;
            margin: 8px 0;
        }

        .hamburger-dropdown .menu-label {
            padding: 8px 20px;
            color: #666;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .hamburger-dropdown .menu-value {
            padding: 4px 20px 12px;
            color: #4fc3f7;
            font-size: 14px;
            font-weight: bold;
        }

        .hamburger-dropdown .pro-indicator {
            background: linear-gradient(135deg, #ffd700, #ffaa00);
            color: #1a1a2e;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
        }

        .menu-upgrade-btn {
            display: block;
            width: calc(100% - 30px);
            margin: 8px 15px;
            padding: 10px 16px;
            background: linear-gradient(135deg, #ffd700, #ffaa00);
            color: #1a1a2e;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .menu-upgrade-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
        }

        .menu-signin-form {
            display: flex;
            gap: 8px;
            padding: 8px 15px;
        }

        .menu-signin-form input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #4fc3f7;
            border-radius: 6px;
            background: #0d1117;
            color: white;
            font-size: 14px;
            min-width: 0;
        }

        .menu-signin-form input::placeholder {
            color: #666;
        }

        .menu-signin-btn {
            padding: 8px 16px;
            background: #4fc3f7;
            color: #1a1a2e;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
        }

        .menu-signin-btn:hover {
            background: #81d4fa;
        }

        .menu-hint {
            padding: 4px 15px 12px;
            color: #666;
            font-size: 11px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }

            h1 {
                font-size: 1.4rem;
            }

            .question-text {
                font-size: 1.1rem;
            }

            .btn-group {
                flex-direction: column;
            }

            .btn-group .btn {
                width: 100%;
            }
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: #16213e;
            border-radius: 15px;
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            border-bottom: 1px solid #333;
        }

        .modal-header h2 {
            color: #4fc3f7;
            font-size: 1.3rem;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            color: #888;
            font-size: 1.8rem;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }

        .modal-close:hover {
            color: #e94560;
        }

        .modal-body {
            padding: 25px;
            overflow-y: auto;
            flex: 1;
        }

        .modal-body h3 {
            color: #4fc3f7;
            margin: 20px 0 10px 0;
            font-size: 1.1rem;
        }

        .modal-body h3:first-child {
            margin-top: 0;
        }

        .modal-body p, .modal-body li {
            color: #ccc;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .modal-body ul {
            padding-left: 20px;
            margin-bottom: 15px;
        }

        .modal-body .key-term {
            color: #81d4fa;
            font-weight: bold;
        }

        /* Import Drop Zone */
        .drop-zone {
            border: 2px dashed #4fc3f7;
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 20px;
        }

        .drop-zone:hover, .drop-zone.drag-over {
            background: rgba(79, 195, 247, 0.1);
            border-color: #81d4fa;
        }

        .drop-zone-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .drop-zone-text {
            color: #888;
            margin-bottom: 5px;
        }

        .drop-zone-subtext {
            color: #666;
            font-size: 0.85rem;
        }

        .import-textarea {
            width: 100%;
            min-height: 150px;
            background: #0f3460;
            border: 1px solid #333;
            border-radius: 8px;
            color: #eaeaea;
            padding: 15px;
            font-family: monospace;
            font-size: 0.9rem;
            resize: vertical;
            margin-bottom: 15px;
        }

        .import-textarea:focus {
            outline: none;
            border-color: #4fc3f7;
        }

        .import-preview {
            background: #0f3460;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .import-preview-item {
            padding: 8px 0;
            border-bottom: 1px solid #333;
        }

        .import-preview-item:last-child {
            border-bottom: none;
        }

        .import-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            color: #888;
        }

        .import-stats span {
            color: #4fc3f7;
            font-weight: bold;
        }

        .format-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .format-tab {
            padding: 8px 16px;
            background: #0f3460;
            border: none;
            border-radius: 5px;
            color: #888;
            cursor: pointer;
            transition: all 0.2s;
        }

        .format-tab:hover {
            color: #eaeaea;
        }

        .format-tab.active {
            background: #4fc3f7;
            color: #1a1a2e;
        }

        /* Pro Badge & Upgrade */
        .pro-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ffd700, #ffaa00);
            color: #1a1a2e;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-left: 8px;
        }

        .upgrade-banner {
            background: linear-gradient(135deg, #1a1a2e, #2a2a4e);
            border: 2px dashed #666;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: center;
        }

        .upgrade-banner h3 {
            color: #aaa;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .upgrade-banner p {
            color: #666;
            font-size: 0.85rem;
            margin-bottom: 12px;
        }

        .pro-member-banner {
            background: linear-gradient(135deg, #1a472a, #2d5a3d);
            border: 3px solid #ffd700;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            text-align: center;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .pro-member-banner h3 {
            color: #ffd700;
            margin-bottom: 8px;
            font-size: 1.3rem;
        }

        .pro-member-banner p {
            color: #90EE90;
            font-size: 0.95rem;
        }

        .btn-upgrade {
            background: linear-gradient(135deg, #ffd700, #ffaa00);
            color: #1a1a2e;
            font-weight: bold;
            border: none;
            padding: 10px 25px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-upgrade:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
        }

        .pricing-card {
            background: #0f3460;
            border-radius: 12px;
            padding: 25px;
            margin: 10px 0;
            text-align: center;
        }

        .pricing-card.featured {
            border: 2px solid #ffd700;
            position: relative;
        }

        .pricing-card.featured::before {
            content: 'BEST VALUE';
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: #ffd700;
            color: #1a1a2e;
            padding: 3px 12px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .pricing-price {
            font-size: 2rem;
            color: #4fc3f7;
            font-weight: bold;
        }

        .pricing-price span {
            font-size: 1rem;
            color: #888;
        }

        .pricing-features {
            text-align: left;
            margin: 15px 0;
            color: #aaa;
        }

        .pricing-features li {
            padding: 5px 0;
            list-style: none;
        }

        .pricing-features li::before {
            content: '‚úì ';
            color: #27ae60;
        }

        .free-limit-warning {
            background: #2d1f1f;
            border: 1px solid #e94560;
            border-radius: 8px;
            padding: 10px 15px;
            margin: 10px 0;
            color: #e94560;
            font-size: 0.9rem;
        }

        .help-btn {
            background: none;
            border: 2px solid #4fc3f7;
            color: #4fc3f7;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .help-btn:hover {
            background: #4fc3f7;
            color: #1a1a2e;
        }

        .question-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .question-header .category-badge {
            margin-bottom: 0;
        }

        /* Mastered Questions List */
        .mastered-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .mastered-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 12px 15px;
            background: #0f3460;
            border-radius: 8px;
            margin-bottom: 10px;
            gap: 15px;
        }

        .mastered-item-text {
            flex: 1;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .mastered-item-category {
            color: #4fc3f7;
            font-size: 0.75rem;
            margin-bottom: 5px;
        }

        .unmaster-btn {
            background: #e94560;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .unmaster-btn:hover {
            background: #ff6b6b;
        }

        .empty-list-message {
            text-align: center;
            color: #888;
            padding: 30px;
        }
        /* Auth tabs */
        .auth-tabs {
            display: flex;
            margin-bottom: 15px;
        }

        .auth-tab {
            flex: 1;
            padding: 8px;
            background: #0f3460;
            border: none;
            color: #888;
            cursor: pointer;
            font-size: 12px;
        }

        .auth-tab.active {
            background: #1a4a7a;
            color: #4fc3f7;
        }

        .auth-tab:first-child {
            border-radius: 5px 0 0 5px;
        }

        .auth-tab:last-child {
            border-radius: 0 5px 5px 0;
        }

        .auth-form input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            background: #0f3460;
            border: 1px solid #333;
            border-radius: 5px;
            color: #eaeaea;
            font-size: 14px;
            box-sizing: border-box;
        }

        .auth-error {
            color: #e94560;
            font-size: 0.85rem;
            margin-top: 10px;
            padding: 8px;
            background: rgba(233, 69, 96, 0.1);
            border-radius: 5px;
        }

        .menu-link-btn {
            background: none;
            border: none;
            color: #4fc3f7;
            cursor: pointer;
            font-size: 0.85rem;
            padding: 5px 20px;
            text-decoration: underline;
        }

        .keyword-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #0f3460;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .keyword-item-info {
            flex: 1;
        }

        .keyword-item-name {
            font-weight: bold;
        }

        .keyword-item-name.active {
            color: #4fc3f7;
        }

        .keyword-item-date {
            font-size: 0.8rem;
            color: #888;
        }

        .keyword-item-actions {
            display: flex;
            gap: 8px;
        }

        /* Welcome Screen */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow-y: auto;
        }

        .welcome-content {
            max-width: 500px;
            text-align: center;
        }

        .welcome-logo {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .welcome-title {
            font-size: 2.5rem;
            color: #4fc3f7;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .welcome-tagline {
            font-size: 1.2rem;
            color: #888;
            margin-bottom: 30px;
        }

        .welcome-features {
            text-align: left;
            background: rgba(15, 52, 96, 0.5);
            border-radius: 12px;
            padding: 20px 25px;
            margin-bottom: 30px;
        }

        .welcome-feature {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 15px;
        }

        .welcome-feature:last-child {
            margin-bottom: 0;
        }

        .welcome-feature-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .welcome-feature-text {
            color: #eaeaea;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .welcome-category-section {
            margin-bottom: 25px;
        }

        .welcome-category-title {
            color: #4fc3f7;
            font-size: 1rem;
            margin-bottom: 15px;
        }

        .welcome-categories {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .welcome-category-chip {
            background: #0f3460;
            color: #888;
            border: 2px solid #333;
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .welcome-category-chip:hover {
            border-color: #4fc3f7;
            color: #eaeaea;
        }

        .welcome-category-chip.selected {
            background: #1a4a7a;
            border-color: #4fc3f7;
            color: #4fc3f7;
        }

        .welcome-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .welcome-btn {
            padding: 16px 32px;
            font-size: 1.1rem;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: bold;
        }

        .welcome-btn-primary {
            background: #4fc3f7;
            color: #1a1a2e;
        }

        .welcome-btn-primary:hover {
            background: #81d4fa;
            transform: translateY(-2px);
        }

        .welcome-btn-secondary {
            background: transparent;
            color: #888;
            border: 1px solid #333;
        }

        .welcome-btn-secondary:hover {
            color: #eaeaea;
            border-color: #4fc3f7;
        }

        .welcome-footer {
            margin-top: 20px;
            color: #666;
            font-size: 0.85rem;
        }
    </style>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
</head>
<body>
    <div id="deploy-banner" class="deploy-banner hidden">Deploying update...</div>

    <!-- Welcome Screen -->
    <div id="welcome-screen" class="welcome-screen hidden">
        <div class="welcome-content">
            <div class="welcome-logo">üìö</div>
            <h1 class="welcome-title">QuizMyself</h1>
            <p class="welcome-tagline">Quiz yourself on anything</p>

            <div class="welcome-features">
                <div class="welcome-feature">
                    <span class="welcome-feature-icon">‚ú®</span>
                    <span class="welcome-feature-text">Import your own study material from files or paste text directly</span>
                </div>
                <div class="welcome-feature">
                    <span class="welcome-feature-icon">üéØ</span>
                    <span class="welcome-feature-text">Track your progress with spaced repetition learning</span>
                </div>
                <div class="welcome-feature">
                    <span class="welcome-feature-icon">‚òÅÔ∏è</span>
                    <span class="welcome-feature-text">Sync across devices with a free account</span>
                </div>
            </div>

            <div class="welcome-category-section">
                <p class="welcome-category-title">Try a demo quiz to get started:</p>
                <div class="welcome-categories" id="welcome-categories">
                    <!-- Populated by JavaScript -->
                </div>
            </div>

            <div class="welcome-actions">
                <button class="welcome-btn welcome-btn-primary" onclick="startWelcomeQuiz()">Start Quiz</button>
                <button class="welcome-btn welcome-btn-secondary" onclick="dismissWelcome()">Skip intro</button>
            </div>

            <p class="welcome-footer">No account required to try it out</p>
        </div>
    </div>

    <!-- Top Bar -->
    <div class="top-bar">
        <div class="top-bar-status free" id="top-bar-status" onclick="toggleHamburgerMenu()">
            <span id="top-bar-status-text">Free Account</span>
        </div>
        <!-- Hamburger Menu -->
        <div class="hamburger-menu" id="hamburger-menu">
            <button class="hamburger-btn" onclick="toggleHamburgerMenu()">‚ò∞</button>
            <div class="hamburger-dropdown" id="hamburger-dropdown">
                <!-- Signed Out State -->
                <div id="menu-signin-section">
                    <div class="auth-tabs">
                        <button class="auth-tab active" onclick="showAuthTab('login')">Login</button>
                        <button class="auth-tab" onclick="showAuthTab('register')">Register</button>
                    </div>
                    <div id="auth-login-form" class="auth-form">
                        <input type="email" id="login-email" placeholder="Email" onkeypress="if(event.key==='Enter')handleLogin()">
                        <input type="password" id="login-password" placeholder="Password" onkeypress="if(event.key==='Enter')handleLogin()">
                        <button class="menu-signin-btn" onclick="handleLogin()" style="width:100%">Sign In</button>
                        <a href="#" onclick="showForgotPassword(); return false;" style="display:block; text-align:center; margin-top:8px; color:#4fc3f7; font-size:13px;">Forgot password?</a>
                    </div>
                    <div id="auth-forgot-form" class="auth-form" style="display: none;">
                        <p style="color:#888; font-size:13px; margin-bottom:10px;">Enter your email to receive a password reset link.</p>
                        <input type="email" id="forgot-email" placeholder="Email" onkeypress="if(event.key==='Enter')handleForgotPassword()">
                        <button class="menu-signin-btn" onclick="handleForgotPassword()" style="width:100%">Send Reset Link</button>
                        <a href="#" onclick="hideForgotPassword(); return false;" style="display:block; text-align:center; margin-top:8px; color:#4fc3f7; font-size:13px;">Back to login</a>
                    </div>
                    <div id="auth-register-form" class="auth-form" style="display: none;">
                        <input type="email" id="register-email" placeholder="Email">
                        <input type="password" id="register-password" placeholder="Password (6+ chars)">
                        <input type="password" id="register-confirm" placeholder="Confirm Password" onkeypress="if(event.key==='Enter')handleRegister()">
                        <button class="menu-signin-btn" onclick="handleRegister()" style="width:100%">Create Account</button>
                    </div>
                    <div id="auth-error" class="auth-error" style="display: none;"></div>
                    <div class="menu-divider"></div>
                    <div class="menu-hint">Or use quick access (limited features):</div>
                    <div class="menu-signin-form">
                        <input type="text" id="menu-keyword-input" placeholder="Keyword only"
                            onkeypress="if(event.key==='Enter')submitKeywordFromMenu()">
                        <button class="menu-signin-btn" onclick="submitKeywordFromMenu()">Go</button>
                    </div>
                </div>
                <!-- Signed In State -->
                <div id="menu-account-section" style="display: none;">
                    <div id="menu-email-section">
                        <div class="menu-label">Account</div>
                        <div class="menu-value" id="menu-email">-</div>
                        <div class="menu-divider"></div>
                    </div>
                    <div class="menu-label">Active Keyword</div>
                    <div class="menu-value" id="menu-keyword">None selected</div>
                    <button id="manage-keywords-btn" class="menu-link-btn" onclick="showKeywordManager()">Manage Keywords</button>
                    <div class="menu-divider"></div>
                    <div class="menu-label">Status</div>
                    <div class="menu-value" id="menu-license-status">Free Account</div>
                    <button id="menu-upgrade-btn" class="menu-upgrade-btn" onclick="showUpgradeModal()">Upgrade to Pro</button>
                    <div class="menu-divider"></div>
                    <div class="menu-item" onclick="handleSignOut();">Sign Out</div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>QuizMyself</h1>
            <p class="subtitle">Quiz Yourself on Anything</p>
        </header>

        <div id="stats-bar" class="stats-bar">
            <div class="stat">
                <div class="stat-value" id="total-count">0</div>
                <div class="stat-label">Total</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="mastered-count">0</div>
                <div class="stat-label">Mastered</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="remaining-count">0</div>
                <div class="stat-label">Remaining</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="accuracy">0%</div>
                <div class="stat-label">Accuracy</div>
            </div>
        </div>

        <!-- Main Menu -->
        <div id="menu-screen" class="menu">
            <!-- Category Filter for Demo Questions -->
            <div id="category-filter" class="category-filter">
                <div class="category-filter-header">
                    <span class="category-filter-title">Filter by Category</span>
                    <div class="category-filter-actions">
                        <button onclick="selectAllCategories()">All</button>
                        <button onclick="clearAllCategories()">None</button>
                    </div>
                </div>
                <div class="category-chips" id="category-chips">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
            <button class="btn btn-primary" onclick="startPractice()">Practice Quiz</button>
            <button id="resume-exam-btn" class="btn hidden" onclick="resumeExam()" style="background: #ff9800; color: #1a1a2e; font-weight: bold;">Resume Exam</button>
            <button class="btn" onclick="startFinalExam()">Final Exam (100% Required)</button>
            <button class="btn" onclick="showProgress()">View Progress</button>
            <button class="btn" onclick="showMasteredList()">Manage Mastered Questions</button>
            <button id="course-content-btn" class="btn" onclick="showCourseContent()" style="text-align: center;">View Study Material</button>
            <a id="raw-content-link" href="course-content.html" class="btn hidden" style="text-align: center; text-decoration: none;">View Raw Source (138 Lessons)</a>
            <button class="btn btn-success btn-small" onclick="showImportModal()">Import Quiz Data</button>
            <button class="btn btn-small" onclick="showSourcesModal()">View Imported Sources</button>
            <button class="btn btn-danger btn-small" onclick="resetProgress()">Reset All Progress</button>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden">
            <a href="#" class="back-link" onclick="backToMenu(); return false;">&larr; Back to Menu</a>
            <div class="quiz-card">
                <div class="question-counter" id="question-counter"></div>
                <div class="question-header">
                    <span class="category-badge" id="category-badge"></span>
                    <button class="help-btn" onclick="openStudyMaterial()">?</button>
                    <span class="streak-indicator hidden" id="streak-indicator"></span>
                </div>
                <p class="question-text" id="question-text"></p>

                <!-- Multiple Choice -->
                <div id="choice-phase">
                    <div class="choices" id="choices-container"></div>
                    <div id="practice-next-btn" class="btn-group hidden" style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="proceedToNextQuestion()">Next Question</button>
                    </div>
                </div>

                <!-- I Already Know This Button -->
                <div style="margin-top: 20px;">
                    <button class="btn btn-small" onclick="markAlwaysKnow()" style="opacity: 0.7;">I already know this</button>
                </div>
            </div>
        </div>

        <!-- Final Exam Screen -->
        <div id="exam-screen" class="hidden">
            <a href="#" class="back-link" onclick="backToMenu(); return false;">&larr; Back to Menu</a>
            <div class="progress-bar">
                <div class="progress-fill" id="exam-progress"></div>
            </div>
            <div class="quiz-card">
                <div class="question-counter" id="exam-counter"></div>
                <div class="question-header">
                    <span class="category-badge" id="exam-category"></span>
                    <button class="help-btn" onclick="openStudyMaterial()">?</button>
                </div>
                <p class="question-text" id="exam-question"></p>
                <div class="choices" id="exam-choices"></div>
                <div id="exam-next-btn" class="btn-group hidden" style="margin-top: 20px;">
                    <button class="btn btn-primary" onclick="proceedToNextExamQuestion()">Next Question</button>
                </div>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="hidden">
            <div class="quiz-card result-card">
                <h2 id="result-title">Final Exam Results</h2>
                <div class="result-score" id="result-score">0%</div>
                <p class="result-message" id="result-message"></p>
                <div class="btn-group" style="justify-content: center;">
                    <button class="btn btn-primary" onclick="backToMenu()">Back to Menu</button>
                    <button class="btn" id="retry-btn" onclick="startFinalExam()">Retry Exam</button>
                </div>
            </div>
        </div>

        <!-- Progress Screen -->
        <div id="progress-screen" class="hidden">
            <a href="#" class="back-link" onclick="backToMenu(); return false;">&larr; Back to Menu</a>
            <div class="quiz-card">
                <h2 style="margin-bottom: 20px;">Your Progress</h2>
                <div id="progress-details"></div>
            </div>
        </div>

        <!-- Mastered Questions Screen -->
        <div id="mastered-screen" class="hidden">
            <a href="#" class="back-link" onclick="backToMenu(); return false;">&larr; Back to Menu</a>
            <div class="quiz-card">
                <h2 style="margin-bottom: 20px;">Mastered Questions</h2>
                <p style="color: #888; margin-bottom: 15px;">Click "Remove" to add a question back to your practice queue.</p>
                <div id="mastered-list" class="mastered-list"></div>
            </div>
        </div>

        <!-- Course Content Screen -->
        <div id="course-content-screen" class="hidden">
            <a href="#" class="back-link" onclick="backToMenu(); return false;">&larr; Back to Menu</a>
            <div class="quiz-card">
                <h2 style="margin-bottom: 10px;">Study Material</h2>
                <p style="color: #888; margin-bottom: 20px;">Learn from the quiz questions and their explanations.</p>
                <div id="course-content-filter" class="category-filter" style="margin-bottom: 20px;">
                    <div class="category-filter-header">
                        <span class="category-filter-title">Filter by Category</span>
                    </div>
                    <div class="category-chips" id="course-category-chips">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
                <div id="course-content-list"></div>
            </div>
        </div>
    </div>

    <!-- Study Material Modal -->
    <div id="study-modal" class="modal-overlay hidden" onclick="closeModalOnOverlay(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 id="modal-title">Study Material</h2>
                <button class="modal-close" onclick="closeStudyMaterial()">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
            </div>
        </div>
    </div>

    <!-- Import Quiz Modal -->
    <div id="import-modal" class="modal-overlay hidden" onclick="closeImportModalOnOverlay(event)">
        <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 600px;">
            <div class="modal-header">
                <h2>Import Quiz Data</h2>
                <button class="modal-close" onclick="closeImportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Drop Zone -->
                <div class="drop-zone" id="drop-zone" onclick="document.getElementById('file-input').click()">
                    <div class="drop-zone-icon">üìÅ</div>
                    <div class="drop-zone-text">Drop a file here or click to browse</div>
                    <div class="drop-zone-subtext">Supports JSON, CSV, or TXT files</div>
                    <input type="file" id="file-input" accept=".json,.csv,.txt" style="display: none;" onchange="handleFileSelect(event)">
                </div>

                <!-- Or paste text -->
                <p style="text-align: center; color: #666; margin-bottom: 15px;">‚Äî or paste text directly ‚Äî</p>

                <textarea id="import-textarea" class="import-textarea" placeholder="Paste your quiz data here...

Supported formats:

JSON:
[{&quot;q&quot;: &quot;Question?&quot;, &quot;a&quot;: &quot;Answer&quot;, &quot;choices&quot;: [&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;], &quot;correct&quot;: 0}]

Q&amp;A Format:
Q: What is the capital of France?
A: Paris

CSV:
question,answer,choice1,choice2,choice3,choice4,correct
&quot;Question?&quot;,&quot;Answer&quot;,&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,0"></textarea>

                <!-- Preview Section -->
                <div id="import-preview-section" style="display: none;">
                    <div class="import-stats">
                        <div>Questions found: <span id="import-count">0</span></div>
                        <div>Format: <span id="import-format">Unknown</span></div>
                    </div>
                    <div class="import-preview" id="import-preview"></div>
                </div>

                <!-- Action Buttons -->
                <div class="btn-group" style="margin-top: 20px;">
                    <button class="btn" onclick="parseImportData()">Preview Import</button>
                    <button class="btn btn-primary" id="import-confirm-btn" onclick="confirmImport()" disabled>Import Questions</button>
                </div>

                <!-- Import Options -->
                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #333;">
                    <label style="display: flex; align-items: center; gap: 10px; color: #888; cursor: pointer;">
                        <input type="checkbox" id="import-replace" style="width: 18px; height: 18px;">
                        Replace existing questions (instead of adding to them)
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Sources Modal -->
    <div id="sources-modal" class="modal-overlay hidden" onclick="closeSourcesModalOnOverlay(event)">
        <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 700px;">
            <div class="modal-header">
                <h2>Imported Sources</h2>
                <button class="modal-close" onclick="closeSourcesModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Storage Info -->
                <div id="sources-storage-info" style="margin-bottom: 20px; padding: 15px; background: #2a2a2a; border-radius: 8px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span>Storage Used:</span>
                        <span id="sources-storage-text">Loading...</span>
                    </div>
                    <div style="margin-top: 10px; height: 8px; background: #444; border-radius: 4px; overflow: hidden;">
                        <div id="sources-storage-bar" style="height: 100%; background: linear-gradient(90deg, #4CAF50, #8BC34A); width: 0%; transition: width 0.3s;"></div>
                    </div>
                </div>

                <!-- Sources List -->
                <div id="sources-list" style="max-height: 400px; overflow-y: auto;">
                    <div style="text-align: center; padding: 40px; color: #888;">Loading sources...</div>
                </div>

                <!-- View Source Content -->
                <div id="source-content-view" style="display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 id="source-content-title" style="margin: 0; color: #ffd700;"></h3>
                        <button class="btn btn-small" onclick="hideSourceContent()">Back to List</button>
                    </div>
                    <pre id="source-content-text" style="background: #1a1a1a; padding: 15px; border-radius: 8px; max-height: 350px; overflow: auto; white-space: pre-wrap; word-wrap: break-word; font-size: 13px; line-height: 1.5;"></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Upgrade Modal -->
    <div id="upgrade-modal" class="modal-overlay hidden" onclick="closeUpgradeModalOnOverlay(event)">
        <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 500px;">
            <div class="modal-header">
                <h2>Upgrade to Pro</h2>
                <button class="modal-close" onclick="closeUpgradeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Login Required Message -->
                <div id="upgrade-login-required" style="display: none; text-align: center; padding: 20px 0;">
                    <div style="font-size: 48px; margin-bottom: 15px;">üîê</div>
                    <h3 style="color: #ffd700; margin-bottom: 10px;">Account Required</h3>
                    <p style="color: #ccc; margin-bottom: 20px; line-height: 1.6;">
                        To upgrade to Pro, you need to create an account first.<br>
                        This ensures your license is securely tied to your account.
                    </p>
                    <button class="btn btn-primary" onclick="closeUpgradeModal(); openHamburgerMenu();" style="padding: 12px 30px; font-size: 16px;">
                        Sign In / Create Account
                    </button>
                    <p style="color: #888; font-size: 0.85rem; margin-top: 15px;">
                        Already have a license key? Sign in first to activate it.
                    </p>
                </div>

                <!-- Upgrade Content (shown when logged in) -->
                <div id="upgrade-content">
                <div class="pricing-card featured">
                    <h3 style="color: #ffd700; margin-bottom: 10px;">Pro Monthly</h3>
                    <div class="pricing-price">$4.99<span>/mo</span></div>
                    <ul class="pricing-features">
                        <li>Unlimited imported questions</li>
                        <li>Cloud sync across devices</li>
                        <li>Priority support</li>
                        <li>Early access to new features</li>
                    </ul>
                    <button class="btn-upgrade" onclick="startCheckout('monthly')" style="width: 100%;">Subscribe Monthly</button>
                </div>

                <div class="pricing-card">
                    <h3 style="color: #4fc3f7; margin-bottom: 10px;">Pro Yearly</h3>
                    <div class="pricing-price">$29.99<span>/yr</span></div>
                    <p style="color: #27ae60; font-size: 0.85rem; margin-bottom: 10px;">Save 50%!</p>
                    <ul class="pricing-features">
                        <li>Everything in Pro Monthly</li>
                        <li>2 months free</li>
                    </ul>
                    <button class="btn btn-primary" onclick="startCheckout('yearly')" style="width: 100%;">Subscribe Yearly</button>
                </div>

                <!-- License Status (shown after payment) -->
                <div id="license-status-section" style="display: none; margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #1a472a, #2d5a3d); border-radius: 8px; border: 1px solid #ffd700;">
                    <div id="license-pending" style="display: none;">
                        <p style="color: #ffd700; font-weight: bold; margin-bottom: 10px;">‚è≥ Payment Received!</p>
                        <p style="color: #ccc; font-size: 0.9rem; margin-bottom: 15px;">Your license is being processed. This usually takes a few seconds. Check your email for the license key, or click below to check again.</p>
                        <button class="btn btn-primary" onclick="checkForLicense()" id="check-license-btn" style="width: 100%;">Check for License</button>
                    </div>
                    <div id="license-found" style="display: none;">
                        <p style="color: #27ae60; font-weight: bold; margin-bottom: 10px;">‚úì License Found!</p>
                        <p style="color: #ccc; font-size: 0.9rem; margin-bottom: 10px;">Your license key:</p>
                        <div style="background: #0f3460; padding: 12px; border-radius: 6px; font-family: monospace; color: #ffd700; font-size: 14px; word-break: break-all; margin-bottom: 10px;" id="license-display"></div>
                        <button class="btn btn-small" onclick="copyLicenseKey()" style="width: 100%;">Copy License Key</button>
                    </div>
                </div>

                <!-- License Key Entry -->
                <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #333;">
                    <p style="color: #888; font-size: 0.9rem; margin-bottom: 10px;">Already have a license key?</p>
                    <input type="text" id="license-key-input" placeholder="XXXX-XXXX-XXXX-XXXX"
                        style="width: 100%; padding: 10px; font-size: 14px; border-radius: 6px; border: 1px solid #333; background: #0f3460; color: white; margin-bottom: 10px; box-sizing: border-box;">
                    <button class="btn btn-small" onclick="activateLicense()" style="width: 100%;">Activate License</button>
                </div>

                <p id="upgrade-error" style="color: #e94560; margin-top: 10px; display: none;"></p>
                <p id="upgrade-success" style="color: #27ae60; margin-top: 10px; display: none;"></p>
                </div><!-- End upgrade-content -->
            </div>
        </div>
    </div>

    <!-- Pro Features Modal -->
    <div id="pro-features-modal" class="modal-overlay hidden" onclick="closeProFeaturesModal()">
        <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 450px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #1a472a, #2d5a3d); border-bottom: 2px solid #ffd700;">
                <h2 style="color: #ffd700;">Pro Member Benefits</h2>
                <button class="modal-close" onclick="closeProFeaturesModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 20px;">
                    <span style="background: linear-gradient(135deg, #ffd700, #ffaa00); color: #1a1a2e; padding: 8px 20px; border-radius: 20px; font-weight: bold; font-size: 18px;">PRO</span>
                </div>
                <ul style="list-style: none; padding: 0;">
                    <li style="padding: 12px 0; border-bottom: 1px solid #333; display: flex; align-items: center; gap: 12px;">
                        <span style="color: #27ae60; font-size: 20px;">‚úì</span>
                        <span><strong>Unlimited imported questions</strong><br><span style="color: #888; font-size: 13px;">Import as many quizzes as you need</span></span>
                    </li>
                    <li style="padding: 12px 0; border-bottom: 1px solid #333; display: flex; align-items: center; gap: 12px;">
                        <span style="color: #27ae60; font-size: 20px;">‚úì</span>
                        <span><strong>Cloud sync across devices</strong><br><span style="color: #888; font-size: 13px;">Your progress follows you everywhere</span></span>
                    </li>
                    <li style="padding: 12px 0; border-bottom: 1px solid #333; display: flex; align-items: center; gap: 12px;">
                        <span style="color: #27ae60; font-size: 20px;">‚úì</span>
                        <span><strong>Priority support</strong><br><span style="color: #888; font-size: 13px;">Get help when you need it</span></span>
                    </li>
                    <li style="padding: 12px 0; display: flex; align-items: center; gap: 12px;">
                        <span style="color: #27ae60; font-size: 20px;">‚úì</span>
                        <span><strong>Early access to new features</strong><br><span style="color: #888; font-size: 13px;">Be the first to try new updates</span></span>
                    </li>
                </ul>
                <div style="margin-top: 20px; padding: 15px; background: #0d1117; border-radius: 8px; text-align: center;">
                    <div style="color: #888; font-size: 12px; margin-bottom: 5px;">License Key</div>
                    <div style="color: #4fc3f7; font-family: monospace; font-size: 14px;" id="pro-license-display">-</div>
                </div>
                <p style="text-align: center; color: #27ae60; margin-top: 15px;">Thank you for supporting QuizMyself!</p>
            </div>
        </div>
    </div>

    <!-- Keyword Manager Modal -->
    <div id="keyword-modal" class="modal-overlay hidden" onclick="closeKeywordModal()">
        <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 500px;">
            <div class="modal-header">
                <h2>Manage Keywords</h2>
                <button class="modal-close" onclick="closeKeywordModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px;">
                    <h3 style="font-size: 1rem; color: #4fc3f7; margin-bottom: 10px;">Add New Keyword</h3>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="new-keyword-input" placeholder="Enter keyword" style="flex: 1; padding: 10px; background: #0f3460; border: 1px solid #333; border-radius: 5px; color: white;">
                        <button class="btn btn-primary btn-small" onclick="handleAddKeyword()">Add</button>
                    </div>
                </div>

                <div style="margin-bottom: 20px;">
                    <h3 style="font-size: 1rem; color: #4fc3f7; margin-bottom: 10px;">Claim Existing Progress</h3>
                    <p style="color: #888; font-size: 0.85rem; margin-bottom: 10px;">
                        Have progress from before creating an account? Claim it here.
                    </p>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="claim-keyword-input" placeholder="Keyword to claim" style="flex: 1; padding: 10px; background: #0f3460; border: 1px solid #333; border-radius: 5px; color: white;">
                        <button class="btn btn-small" onclick="handleClaimKeyword()">Claim</button>
                    </div>
                </div>

                <div>
                    <h3 style="font-size: 1rem; color: #4fc3f7; margin-bottom: 10px;">Your Keywords</h3>
                    <div id="keyword-list" style="max-height: 300px; overflow-y: auto;"></div>
                </div>

                <div id="keyword-modal-message" style="margin-top: 15px; display: none; padding: 10px; border-radius: 5px;"></div>
            </div>
        </div>
    </div>

    <script>
        // Owner account that can see all data
        const OWNER_EMAIL = 'noxestyle@gmail.com';

        // Demo questions for non-owner users - 7 categories of engaging trivia
        const demoQuestions = [
            // POP CULTURE (10 questions)
            { id: 1, category: "Pop Culture", q: "Which social media platform is known for its disappearing messages called 'Snaps'?", a: "Snapchat pioneered the ephemeral messaging format where photos and videos disappear after being viewed", choices: ["Instagram", "TikTok", "Snapchat", "Twitter"], correct: 2 },
            { id: 2, category: "Pop Culture", q: "What fictional country is the setting for Marvel's Black Panther?", a: "Wakanda is a technologically advanced fictional African nation, home to the superhero Black Panther", choices: ["Latveria", "Wakanda", "Genosha", "Sokovia"], correct: 1 },
            { id: 3, category: "Pop Culture", q: "Which video game franchise features a character named Mario who rescues Princess Peach?", a: "Super Mario Bros. is Nintendo's flagship franchise, first appearing in 1985", choices: ["Sonic the Hedgehog", "The Legend of Zelda", "Super Mario Bros.", "Donkey Kong"], correct: 2 },
            { id: 4, category: "Pop Culture", q: "What is the name of the fictional wizarding school in Harry Potter?", a: "Hogwarts School of Witchcraft and Wizardry is where Harry Potter learns magic in J.K. Rowling's series", choices: ["Beauxbatons", "Durmstrang", "Ilvermorny", "Hogwarts"], correct: 3 },
            { id: 5, category: "Pop Culture", q: "Which streaming service created the shows 'Stranger Things' and 'The Crown'?", a: "Netflix has produced numerous original series including these award-winning shows", choices: ["Netflix", "Amazon Prime", "Hulu", "Disney+"], correct: 0 },
            { id: 6, category: "Pop Culture", q: "What is the best-selling video game console of all time?", a: "The PlayStation 2 sold over 155 million units worldwide between 2000 and 2013", choices: ["Nintendo Wii", "PlayStation 2", "Xbox 360", "Nintendo Switch"], correct: 1 },
            { id: 7, category: "Pop Culture", q: "Which K-pop group performed 'Dynamite' and has a massive fanbase called ARMY?", a: "BTS (Bangtan Sonyeondan) became a global phenomenon with their song Dynamite in 2020", choices: ["BLACKPINK", "EXO", "BTS", "TWICE"], correct: 2 },
            { id: 8, category: "Pop Culture", q: "What animated series features the Simpson family living in Springfield?", a: "The Simpsons debuted in 1989 and became the longest-running American animated program", choices: ["Family Guy", "South Park", "The Simpsons", "Futurama"], correct: 2 },
            { id: 9, category: "Pop Culture", q: "Which company created the iPhone?", a: "Apple Inc. released the first iPhone in 2007, revolutionizing the smartphone industry", choices: ["Samsung", "Google", "Microsoft", "Apple"], correct: 3 },
            { id: 10, category: "Pop Culture", q: "What is the name of the virtual reality world in the movie 'Ready Player One'?", a: "The OASIS is a virtual universe where most of humanity spends their time in Ernest Cline's story", choices: ["The Matrix", "The OASIS", "Metaverse", "Second Life"], correct: 1 },

            // POLITICS (8 questions)
            { id: 11, category: "Politics", q: "How many members serve in the United States Senate?", a: "The U.S. Senate has 100 members, with 2 senators representing each of the 50 states", choices: ["50", "100", "435", "538"], correct: 1 },
            { id: 12, category: "Politics", q: "What is the term length for a U.S. House of Representatives member?", a: "Representatives serve 2-year terms, requiring frequent re-election campaigns", choices: ["2 years", "4 years", "6 years", "8 years"], correct: 0 },
            { id: 13, category: "Politics", q: "Which document begins with 'We the People'?", a: "The U.S. Constitution's preamble starts with these famous words, establishing popular sovereignty", choices: ["Declaration of Independence", "Bill of Rights", "U.S. Constitution", "Articles of Confederation"], correct: 2 },
            { id: 14, category: "Politics", q: "What is the minimum age requirement to become President of the United States?", a: "Article II of the Constitution requires the President to be at least 35 years old", choices: ["25 years", "30 years", "35 years", "40 years"], correct: 2 },
            { id: 15, category: "Politics", q: "Which branch of the U.S. government is responsible for interpreting laws?", a: "The Judicial Branch, headed by the Supreme Court, interprets the Constitution and federal laws", choices: ["Executive", "Legislative", "Judicial", "Administrative"], correct: 2 },
            { id: 16, category: "Politics", q: "What is the electoral college threshold needed to win the U.S. presidency?", a: "A candidate needs 270 electoral votes out of 538 total to win the presidency", choices: ["218", "270", "326", "435"], correct: 1 },
            { id: 17, category: "Politics", q: "Which amendment to the U.S. Constitution abolished slavery?", a: "The 13th Amendment, ratified in 1865, abolished slavery throughout the United States", choices: ["13th Amendment", "14th Amendment", "15th Amendment", "19th Amendment"], correct: 0 },
            { id: 18, category: "Politics", q: "What is the term for a two-chamber legislature?", a: "A bicameral legislature has two separate chambers, like the U.S. Congress with Senate and House", choices: ["Unicameral", "Bicameral", "Tricameral", "Parliamentary"], correct: 1 },

            // HISTORY (10 questions)
            { id: 19, category: "History", q: "In what year did World War II end?", a: "WWII ended in 1945 with Germany surrendering in May and Japan in September", choices: ["1943", "1944", "1945", "1946"], correct: 2 },
            { id: 20, category: "History", q: "Who was the first President of the United States?", a: "George Washington served as the first President from 1789 to 1797", choices: ["Thomas Jefferson", "John Adams", "Benjamin Franklin", "George Washington"], correct: 3 },
            { id: 21, category: "History", q: "What ancient wonder was located in Alexandria, Egypt?", a: "The Lighthouse of Alexandria (Pharos) was one of the Seven Wonders of the Ancient World", choices: ["Hanging Gardens", "Colossus of Rhodes", "Lighthouse of Alexandria", "Temple of Artemis"], correct: 2 },
            { id: 22, category: "History", q: "Which empire built the Colosseum in Rome?", a: "The Roman Empire constructed the Colosseum, completed in 80 AD under Emperor Titus", choices: ["Greek Empire", "Roman Empire", "Byzantine Empire", "Ottoman Empire"], correct: 1 },
            { id: 23, category: "History", q: "What was the name of the ship that brought the Pilgrims to America in 1620?", a: "The Mayflower transported 102 passengers from England to Plymouth, Massachusetts", choices: ["Santa Maria", "Mayflower", "HMS Victory", "Endeavour"], correct: 1 },
            { id: 24, category: "History", q: "Which civilization built Machu Picchu?", a: "The Inca Empire built Machu Picchu in the 15th century in present-day Peru", choices: ["Aztec", "Maya", "Inca", "Olmec"], correct: 2 },
            { id: 25, category: "History", q: "In what year did the Berlin Wall fall?", a: "The Berlin Wall fell on November 9, 1989, symbolizing the end of the Cold War", choices: ["1987", "1988", "1989", "1990"], correct: 2 },
            { id: 26, category: "History", q: "Who wrote the Declaration of Independence?", a: "Thomas Jefferson was the principal author of the Declaration of Independence in 1776", choices: ["George Washington", "Benjamin Franklin", "John Adams", "Thomas Jefferson"], correct: 3 },
            { id: 27, category: "History", q: "What ancient trade route connected China to the Mediterranean?", a: "The Silk Road was a network of trade routes connecting East Asia to the Mediterranean", choices: ["Spice Route", "Silk Road", "Amber Road", "Tea Route"], correct: 1 },
            { id: 28, category: "History", q: "Which queen ruled England for 63 years during the Victorian era?", a: "Queen Victoria reigned from 1837 to 1901, the longest reign until Queen Elizabeth II", choices: ["Queen Elizabeth I", "Queen Victoria", "Queen Anne", "Queen Mary"], correct: 1 },

            // ART (8 questions)
            { id: 29, category: "Art", q: "Who painted the Mona Lisa?", a: "Leonardo da Vinci painted the Mona Lisa between 1503 and 1519, now housed in the Louvre", choices: ["Michelangelo", "Raphael", "Leonardo da Vinci", "Botticelli"], correct: 2 },
            { id: 30, category: "Art", q: "What art movement is Salvador Dali associated with?", a: "Surrealism explored the unconscious mind through dreamlike imagery; Dali was a leading figure", choices: ["Impressionism", "Cubism", "Surrealism", "Pop Art"], correct: 2 },
            { id: 31, category: "Art", q: "Which artist is famous for painting sunflowers and 'Starry Night'?", a: "Vincent van Gogh created these iconic Post-Impressionist works in the late 1880s", choices: ["Claude Monet", "Vincent van Gogh", "Paul Cezanne", "Edgar Degas"], correct: 1 },
            { id: 32, category: "Art", q: "What famous sculpture depicts a man deep in thought?", a: "The Thinker was created by Auguste Rodin, originally part of a larger work called The Gates of Hell", choices: ["David", "The Thinker", "Venus de Milo", "Pieta"], correct: 1 },
            { id: 33, category: "Art", q: "Which artist painted the ceiling of the Sistine Chapel?", a: "Michelangelo painted the Sistine Chapel ceiling between 1508 and 1512 in Vatican City", choices: ["Leonardo da Vinci", "Raphael", "Michelangelo", "Caravaggio"], correct: 2 },
            { id: 34, category: "Art", q: "What museum in Paris houses the Mona Lisa?", a: "The Louvre Museum in Paris is home to the Mona Lisa and thousands of other artworks", choices: ["Musee d'Orsay", "The Louvre", "Centre Pompidou", "Rodin Museum"], correct: 1 },
            { id: 35, category: "Art", q: "Which art movement featured artists like Monet and Renoir painting with visible brushstrokes?", a: "Impressionism emerged in 1870s France, focusing on light, color, and everyday scenes", choices: ["Baroque", "Romanticism", "Impressionism", "Expressionism"], correct: 2 },
            { id: 36, category: "Art", q: "Who created the sculpture of David, depicting the biblical hero?", a: "Michelangelo carved the marble statue of David between 1501 and 1504 in Florence", choices: ["Donatello", "Bernini", "Michelangelo", "Rodin"], correct: 2 },

            // MUSIC (10 questions)
            { id: 37, category: "Music", q: "Which band performed 'Bohemian Rhapsody'?", a: "Queen released Bohemian Rhapsody in 1975, featuring Freddie Mercury's iconic vocals", choices: ["The Beatles", "Led Zeppelin", "Queen", "Pink Floyd"], correct: 2 },
            { id: 38, category: "Music", q: "What instrument has 88 keys?", a: "A standard piano has 88 keys, spanning over seven octaves", choices: ["Organ", "Piano", "Harpsichord", "Accordion"], correct: 1 },
            { id: 39, category: "Music", q: "Who is known as the 'King of Pop'?", a: "Michael Jackson earned this title through his groundbreaking music and performances", choices: ["Elvis Presley", "Prince", "Michael Jackson", "James Brown"], correct: 2 },
            { id: 40, category: "Music", q: "Which classical composer became deaf but continued to compose music?", a: "Ludwig van Beethoven began losing his hearing in his late 20s but composed his greatest works while deaf", choices: ["Mozart", "Bach", "Beethoven", "Chopin"], correct: 2 },
            { id: 41, category: "Music", q: "What music genre originated in New Orleans and features improvisation?", a: "Jazz emerged in New Orleans in the early 20th century, blending African and European musical traditions", choices: ["Blues", "Jazz", "Rock and Roll", "Country"], correct: 1 },
            { id: 42, category: "Music", q: "Which Beatles album features the iconic Abbey Road crosswalk cover?", a: "Abbey Road (1969) shows the four Beatles walking across a zebra crossing near their studio", choices: ["Sgt. Pepper's", "Let It Be", "Abbey Road", "Revolver"], correct: 2 },
            { id: 43, category: "Music", q: "What is the highest female singing voice called?", a: "Soprano is the highest female voice type, typically ranging from middle C to high C", choices: ["Alto", "Mezzo-soprano", "Soprano", "Contralto"], correct: 2 },
            { id: 44, category: "Music", q: "Which instrument is Yo-Yo Ma famous for playing?", a: "Yo-Yo Ma is a world-renowned cellist who has won multiple Grammy Awards", choices: ["Violin", "Cello", "Viola", "Double Bass"], correct: 1 },
            { id: 45, category: "Music", q: "What country is credited as the birthplace of opera?", a: "Opera originated in Italy during the late 16th century, with Florence being a key early center", choices: ["Germany", "France", "Italy", "Austria"], correct: 2 },
            { id: 46, category: "Music", q: "Which music streaming service is known for its green logo and was founded in Sweden?", a: "Spotify was founded in Stockholm, Sweden in 2006 and launched in 2008", choices: ["Apple Music", "Spotify", "Pandora", "Tidal"], correct: 1 },

            // MOVIES (10 questions)
            { id: 47, category: "Movies", q: "What film won the first Academy Award for Best Picture?", a: "Wings (1927) was the first film to win the Academy Award for Best Picture at the inaugural ceremony", choices: ["The Jazz Singer", "Wings", "Sunrise", "Ben-Hur"], correct: 1 },
            { id: 48, category: "Movies", q: "Who directed the Star Wars original trilogy?", a: "George Lucas created and directed the original Star Wars (1977), starting the iconic franchise", choices: ["Steven Spielberg", "George Lucas", "James Cameron", "Ridley Scott"], correct: 1 },
            { id: 49, category: "Movies", q: "What is the highest-grossing film of all time (adjusted for inflation)?", a: "Gone with the Wind (1939) remains the highest-grossing film when adjusted for inflation", choices: ["Avatar", "Titanic", "Gone with the Wind", "Avengers: Endgame"], correct: 2 },
            { id: 50, category: "Movies", q: "Which actor played the character of James Bond in the most films?", a: "Roger Moore played James Bond in seven films, more than any other actor", choices: ["Sean Connery", "Roger Moore", "Daniel Craig", "Pierce Brosnan"], correct: 1 },
            { id: 51, category: "Movies", q: "What 1994 film features the quote 'Life is like a box of chocolates'?", a: "Forrest Gump starred Tom Hanks and became one of the most quoted films in cinema history", choices: ["The Shawshank Redemption", "Pulp Fiction", "Forrest Gump", "The Lion King"], correct: 2 },
            { id: 52, category: "Movies", q: "Which film features a great white shark terrorizing a beach community?", a: "Jaws (1975) directed by Steven Spielberg became the first summer blockbuster", choices: ["The Meg", "Deep Blue Sea", "Jaws", "Sharknado"], correct: 2 },
            { id: 53, category: "Movies", q: "What was the first feature-length animated film by Disney?", a: "Snow White and the Seven Dwarfs (1937) was Disney's first full-length animated feature", choices: ["Fantasia", "Pinocchio", "Snow White and the Seven Dwarfs", "Dumbo"], correct: 2 },
            { id: 54, category: "Movies", q: "Which film franchise features a character named Ellen Ripley fighting aliens?", a: "The Alien franchise stars Sigourney Weaver as Ellen Ripley, beginning with Alien (1979)", choices: ["Predator", "Alien", "Species", "Event Horizon"], correct: 1 },
            { id: 55, category: "Movies", q: "What is the name of the fictional African kingdom in Coming to America?", a: "Zamunda is the fictional wealthy African nation ruled by King Jaffe Joffer in the 1988 comedy", choices: ["Wakanda", "Zamunda", "Genovia", "Aldovia"], correct: 1 },
            { id: 56, category: "Movies", q: "Which director is known for films like 'Inception', 'The Dark Knight', and 'Interstellar'?", a: "Christopher Nolan is celebrated for his complex narratives and practical effects", choices: ["David Fincher", "Denis Villeneuve", "Christopher Nolan", "Quentin Tarantino"], correct: 2 },

            // CURRENT EVENTS - Timeless/Evergreen Topics (9 questions)
            { id: 57, category: "Current Events", q: "What international organization has its headquarters in New York City?", a: "The United Nations headquarters has been in New York City since 1952", choices: ["World Bank", "United Nations", "NATO", "World Health Organization"], correct: 1 },
            { id: 58, category: "Current Events", q: "Which renewable energy source generates electricity from sunlight?", a: "Solar power converts sunlight directly into electricity using photovoltaic cells", choices: ["Wind power", "Hydroelectric", "Solar power", "Geothermal"], correct: 2 },
            { id: 59, category: "Current Events", q: "What does 'cryptocurrency' refer to?", a: "Cryptocurrency is digital currency using cryptography for security, operating on blockchain technology", choices: ["Government-issued digital currency", "Digital currency using cryptography", "Virtual currency in video games", "Credit card rewards points"], correct: 1 },
            { id: 60, category: "Current Events", q: "What is the European Union's common currency called?", a: "The Euro is used by 20 of the 27 EU member states in the eurozone", choices: ["Pound", "Euro", "Franc", "Mark"], correct: 1 },
            { id: 61, category: "Current Events", q: "Which global agreement addresses climate change by setting emission reduction targets?", a: "The Paris Agreement (2015) aims to limit global warming to 1.5-2 degrees Celsius", choices: ["Kyoto Protocol", "Paris Agreement", "Montreal Protocol", "Geneva Convention"], correct: 1 },
            { id: 62, category: "Current Events", q: "What does the acronym 'AI' stand for in technology?", a: "Artificial Intelligence refers to computer systems capable of performing tasks that require human intelligence", choices: ["Automated Integration", "Artificial Intelligence", "Advanced Internet", "Algorithmic Interface"], correct: 1 },
            { id: 63, category: "Current Events", q: "What is 'electric vehicle' commonly abbreviated as?", a: "EV stands for Electric Vehicle, which uses electric motors powered by batteries", choices: ["EV", "EC", "EM", "EP"], correct: 0 },
            { id: 64, category: "Current Events", q: "Which organization is responsible for space exploration including the Mars rovers?", a: "NASA (National Aeronautics and Space Administration) has sent multiple rovers to Mars", choices: ["SpaceX", "NASA", "ESA", "Blue Origin"], correct: 1 },
            { id: 65, category: "Current Events", q: "What does '5G' refer to in telecommunications?", a: "5G is the fifth generation of cellular network technology, offering faster speeds and lower latency", choices: ["5 Gigabytes of data", "Fifth generation cellular network", "5 Gigahertz frequency", "5 Global networks"], correct: 1 }
        ];

        // Question Bank - 200+ questions from WGU D322 course (owner only)
        const wguQuestions = [
            // IT Roles & Functions
            { id: 1, category: "IT Roles", q: "Computer Engineering (CE) primarily focuses on:", a: "The design of hardware systems and the software that makes them work, including drivers for peripheral devices and embedded systems", choices: ["The design of hardware systems and the software that makes them work", "The theoretical study of algorithms and computational complexity", "Integrating IT solutions with organizational business processes", "Managing and securing enterprise network infrastructure"], correct: 0 },
            { id: 2, category: "IT Roles", q: "The discipline of Computer Science (CS) is characterized by:", a: "The design and implementation of software with emphasis on developing effective ways to solve computing problems, including robotics, AI, and algorithms", choices: ["Building and maintaining physical computing hardware", "Design and implementation of software to solve computing problems", "Managing database systems and data warehouses", "Configuring and troubleshooting network systems"], correct: 1 },
            { id: 3, category: "IT Roles", q: "Software Engineering (SE) can be defined as:", a: "The development and maintenance of reliable and efficient software systems for enterprises", choices: ["Designing computer hardware and circuit boards", "Managing IT infrastructure and cloud services", "Development and maintenance of reliable software systems", "Analyzing business requirements without implementation"], correct: 2 },
            { id: 4, category: "IT Roles", q: "An organization uses Information Systems (IS) professionals to:", a: "Integrating IT solutions to meet organizational business goals, addressing systems that generate, process, and distribute information", choices: ["Writing low-level system drivers and firmware", "Building and repairing computer hardware", "Designing algorithms for artificial intelligence", "Integrating IT solutions to meet organizational business goals"], correct: 3 },
            { id: 5, category: "IT Roles", q: "The primary purpose of Information Technology (IT) is:", a: "The technology supporting information systems in an organization, responding to practical needs including reliable and secure solutions", choices: ["Technology supporting information systems in organizations", "Theoretical computer science research", "Developing new programming languages", "Manufacturing computer components"], correct: 0 },
            { id: 6, category: "IT Roles", q: "A System Administrator primarily:", a: "Providing technical support for hardware and software issues, including log-in issues, and understanding network vulnerabilities", choices: ["Designing software architecture and writing code", "Providing technical support for hardware and software issues", "Creating database schemas and SQL queries", "Developing machine learning models"], correct: 1 },
            { id: 7, category: "IT Roles", q: "Which role is responsible for designing, planning, and maintaining an organization's network?", a: "Designing, planning, setting up, and maintaining an organization's network", choices: ["Writing application software and APIs", "Managing database backups and recovery", "Network Engineer", "Developing cybersecurity policies and procedures"], correct: 2 },
            { id: 8, category: "IT Roles", q: "A Database Administrator's primary duties include:", a: "Installing and configuring databases, fixing database errors, and creating user accounts", choices: ["Configuring routers and network switches", "Managing cloud computing infrastructure", "Writing front-end user interfaces", "Installing and configuring databases"], correct: 3 },
            { id: 9, category: "IT Roles", q: "The role of Security Administrator involves:", a: "Installing, administering, and troubleshooting network security issues", choices: ["Installing and troubleshooting network security issues", "Developing web applications and services", "Managing database performance tuning", "Designing user experience interfaces"], correct: 0 },
            { id: 10, category: "IT Roles", q: "Select the description that matches a Web Administrator:", a: "Troubleshooting website errors, tracking and analyzing website usage data, and reporting security breaches", choices: ["Managing physical server hardware", "Troubleshooting website errors and analyzing usage data", "Designing network topology and architecture", "Writing database stored procedures"], correct: 1 },
            { id: 11, category: "IT Roles", q: "A Cloud Architect's core responsibility involves:", a: "Overseeing a company's cloud computing systems", choices: ["Installing and maintaining physical on-premises servers", "Writing embedded systems firmware", "Overseeing cloud computing systems", "Managing help desk support tickets"], correct: 2 },
            { id: 12, category: "IT Roles", q: "A Network Architect primarily focuses on:", a: "Designing networks, monitoring traffic, installing routers and modems, and upgrading hardware and software", choices: ["Developing mobile applications", "Creating data visualization dashboards", "Managing relational database systems", "Designing networks and monitoring traffic"], correct: 3 },
            { id: 13, category: "IT Roles", q: "Which role designs, builds, and implements security systems within IT networks?", a: "Designing, building, testing, and implementing security systems within an organization's IT network", choices: ["Security Architect", "Developing e-commerce web applications", "Managing software development lifecycles", "Creating business intelligence reports"], correct: 0 },
            { id: 14, category: "IT Roles", q: "An organization employs a Machine Learning Engineer to:", a: "Allows an organization to take full control of its data using Python, R, or Java with machine learning frameworks", choices: ["Repairs and maintains computer hardware", "Enables organizations to leverage data using ML frameworks", "Manages network infrastructure and protocols", "Designs relational database schemas"], correct: 1 },
            { id: 15, category: "IT Roles", q: "Software Engineers design and develop:", a: "Software that makes hardware and software systems work, including operating systems, database systems, and embedded systems", choices: ["Only client-facing web applications", "Only mobile applications for smartphones", "Software for hardware and software systems including OS and databases", "Only video games and entertainment software"], correct: 2 },
            { id: 16, category: "IT Roles", q: "A Computer Support Specialist primarily:", a: "Supporting, monitoring, and maintaining workplace technology and responding to user requests for help", choices: ["Developing enterprise software applications", "Creating machine learning algorithms", "Designing network security architecture", "Supporting and maintaining workplace technology"], correct: 3 },
            { id: 17, category: "IT Roles", q: "A Systems Analyst's primary function is to:", a: "Investigates business problems and creates information systems to provide solutions", choices: ["Investigates business problems and creates IS solutions", "Manages physical IT infrastructure", "Writes low-level operating system code", "Configures network firewalls and routers"], correct: 0 },
            { id: 18, category: "IT Roles", q: "The primary function of a Data Analyst is:", a: "Uses statistical and quantitative methods to gain insights that support organizational decision-making", choices: ["Manages database server administration", "Uses statistics to gain insights for decision-making", "Develops software applications from scratch", "Configures enterprise network systems"], correct: 1 },
            { id: 19, category: "IT Roles", q: "A Security Analyst is characterized by:", a: "Monitors an organization's network for security breaches", choices: ["Develops new encryption algorithms", "Designs database architecture", "Monitors networks for security breaches", "Creates mobile applications"], correct: 2 },
            { id: 20, category: "IT Roles", q: "In IT, a Project Manager is responsible for:", a: "Organizes people, time, and resources to ensure projects meet requirements and are completed on time and within budget", choices: ["Writes code and develops software", "Manages database administration", "Configures network infrastructure", "Organizes resources to complete projects on time and budget"], correct: 3 },

            // Data & Information
            { id: 21, category: "Data & Information", q: "Which describes the difference between data and information?", a: "Data includes raw facts or observations; information is data given context that makes it meaningful", choices: ["Data is raw facts; information is data with context", "Data is analyzed; information is raw and unprocessed", "Information is collected first; data is derived from it", "Data requires interpretation; information does not"], correct: 0 },
            { id: 22, category: "Data & Information", q: "The DIKW pyramid consists of four levels from bottom to top:", a: "Data, Information, Knowledge, Wisdom", choices: ["Data, Knowledge, Information, Wisdom", "Data, Information, Knowledge, Wisdom", "Facts, Information, Understanding, Insight", "Data, Information, Intelligence, Action"], correct: 1 },
            { id: 23, category: "Data & Information", q: "In the DIKW pyramid, knowledge refers to:", a: "A dynamic combination of experience, values, contextual information, expert insight, and grounded intuition", choices: ["Information that has been validated as accurate", "Structured data stored in a database system", "A combination of experience, values, and contextual information", "Raw facts that have been collected and organized"], correct: 2 },
            { id: 24, category: "Data & Information", q: "Wisdom, in the DIKW context, can be described as:", a: "Knowing the right thing to do", choices: ["Having accumulated large amounts of knowledge", "The ability to process information quickly", "Understanding how to collect accurate data", "Knowing the right thing to do"], correct: 3 },
            { id: 25, category: "Data & Information", q: "Structured data is characterized by:", a: "Data coded in a way that makes it easy to convert into a form usable for analysis, such as names, dates, and phone numbers", choices: ["Data easily converted for analysis like names and dates", "Data stored in NoSQL document databases", "Data that follows no predefined schema", "Data stored in uncompressed file formats"], correct: 0 },
            { id: 26, category: "Data & Information", q: "Unstructured data refers to:", a: "Data that is more complex and possibly stored in a format not easily decoded, such as text, videos, and audio", choices: ["Data organized in relational database tables", "Complex data not easily decoded like text and videos", "Data with clearly defined field types", "Data stored in spreadsheet columns"], correct: 1 },
            { id: 27, category: "Data & Information", q: "Big Data can be defined as:", a: "A large collection of data that is incapable of being processed by previous generations of analytical tools", choices: ["Any data stored in cloud infrastructure", "Data that exceeds 1 terabyte in size", "Large data collections requiring advanced analytical tools", "Enterprise data stored in data warehouses"], correct: 2 },
            { id: 28, category: "Data & Information", q: "The purpose of data hygiene is:", a: "The processes of ensuring the cleanliness of data - that it is relatively error-free", choices: ["Encrypting sensitive data for security", "Backing up data to prevent loss", "Compressing data to save storage space", "Processes ensuring data is error-free"], correct: 3 },
            { id: 29, category: "Data & Information", q: "Data scrubbing involves:", a: "The process of amending or removing data that is incorrect, incomplete, improperly formatted, or duplicated", choices: ["Amending or removing incorrect/incomplete data", "Permanently deleting data for compliance", "Converting data between different formats", "Transferring data between systems"], correct: 0 },
            { id: 30, category: "Data & Information", q: "The five quality data attributes are:", a: "Precise, valid, reliable, timely, and complete", choices: ["Accessible, secure, backed-up, indexed, normalized", "Precise, valid, reliable, timely, complete", "Encrypted, compressed, deduplicated, archived, replicated", "Structured, unstructured, semi-structured, metadata, binary"], correct: 1 },
            { id: 31, category: "Data & Information", q: "IaaS (Infrastructure as a Service) provides:", a: "A cloud model providing access in a virtualized environment with computing resources like network connections and virtual server space", choices: ["Cloud-hosted development tools and runtime environments for building apps", "Ready-to-use software applications delivered over the internet", "Virtual servers, storage, and networking resources on demand", "Managed container orchestration and serverless computing"], correct: 2 },
            { id: 32, category: "Data & Information", q: "What is PaaS (Platform as a Service)?", a: "A cloud model where customers access a platform supporting development and management of web applications", choices: ["Raw compute, storage, and networking resources you manage yourself", "Complete applications accessed through a web browser", "Managed databases and analytics services only", "Development frameworks and tools for building applications"], correct: 3 },
            { id: 33, category: "Data & Information", q: "What is SaaS (Software as a Service)?", a: "A model where software is licensed to customers with subscriptions and central hosting, like Gmail or Office 365", choices: ["Ready-to-use applications accessed via browser or API", "Virtual infrastructure resources like servers and storage", "Development environments and deployment pipelines", "Managed container and microservices platforms"], correct: 0 },
            { id: 34, category: "Data & Information", q: "What is personally identifiable information (PII)?", a: "Sensitive data including social security numbers, names, and telephone numbers that could identify an individual", choices: ["Anonymized data used for analytics", "Sensitive data that could identify an individual", "Encrypted corporate financial records", "Aggregated demographic statistics"], correct: 1 },

            // Computer Hardware
            { id: 35, category: "Hardware", q: "What are the four functions of a computer system according to IPOS?", a: "Input, Process, Output, Storage", choices: ["Input, Parse, Output, Store", "Initialize, Process, Operate, Save", "Input, Process, Output, Storage", "Input, Program, Output, System"], correct: 2 },
            { id: 36, category: "Hardware", q: "What is the CPU responsible for?", a: "Processing all information from programs and executing computer program instructions", choices: ["Storing data in volatile memory temporarily", "Managing network communications", "Rendering graphics and visual output", "Processing information and executing instructions"], correct: 3 },
            { id: 37, category: "Hardware", q: "What are the three parts of a CPU?", a: "Arithmetic Logic Unit (ALU), Control Unit, and Processor Registers", choices: ["ALU, Control Unit, Processor Registers", "Cache, Core, and Clock multiplier", "L1 Cache, L2 Cache, L3 Cache", "Northbridge, Southbridge, Memory Controller"], correct: 0 },
            { id: 38, category: "Hardware", q: "What does RAM stand for and what does it do?", a: "Random Access Memory - temporarily stores information created by programs for immediate access", choices: ["Read-only Access Memory - stores firmware permanently", "Random Access Memory - temporary storage for immediate access", "Rapid Application Memory - accelerates program execution", "Remote Access Memory - enables network data storage"], correct: 1 },
            { id: 39, category: "Hardware", q: "What is the difference between RAM and ROM?", a: "RAM is volatile (loses data when powered off) while ROM is non-volatile (retains data when powered off)", choices: ["RAM is slower but larger; ROM is faster but smaller", "RAM stores firmware; ROM stores user data", "RAM is volatile; ROM is non-volatile", "RAM is read-only; ROM is read-write"], correct: 2 },
            { id: 40, category: "Hardware", q: "What is the motherboard?", a: "The main circuit board containing both soldered components and sockets for removable components like CPU and RAM", choices: ["The processor that controls all computations", "The power supply unit for the computer", "The primary storage device for the operating system", "The main circuit board holding CPU, RAM, and other components"], correct: 3 },
            { id: 41, category: "Hardware", q: "What is a GPU (Graphics Processing Unit)?", a: "A processor that handles graphic data processing, especially important for 3D rendering", choices: ["A processor for handling graphic data and 3D rendering", "The main processor that runs all computer programs", "A type of high-speed volatile memory", "A controller for peripheral input devices"], correct: 0 },
            { id: 42, category: "Hardware", q: "What is the difference between HDD and SSD?", a: "HDD uses spinning magnetic disks (platters) while SSD uses static flash memory chips with no moving parts", choices: ["HDD is volatile memory; SSD is non-volatile", "HDD uses magnetic platters; SSD uses flash memory", "SSD uses spinning disks; HDD uses flash memory", "HDD stores more data; SSD cannot be partitioned"], correct: 1 },
            { id: 43, category: "Hardware", q: "What is a bit?", a: "The smallest unit of storage, set to either 0 or 1", choices: ["A group of 4 binary digits", "One eighth of a byte", "The smallest storage unit (0 or 1)", "A unit equal to 8 binary values"], correct: 2 },
            { id: 44, category: "Hardware", q: "What is a byte?", a: "A group of 8 bits, containing enough information to store a single character", choices: ["A single binary digit (0 or 1)", "A quarter of a kilobyte", "A unit of 1024 bits", "8 bits - enough to store one character"], correct: 3 },
            { id: 45, category: "Hardware", q: "How many bytes are in a kilobyte (KB)?", a: "1,024 bytes (2^10)", choices: ["1,024 bytes", "1,000 bytes (decimal)", "512 bytes", "2,048 bytes"], correct: 0 },
            { id: 46, category: "Hardware", q: "How many megabytes are in a gigabyte (GB)?", a: "1,024 MB", choices: ["1,000 MB (decimal)", "1,024 MB", "512 MB", "2,048 MB"], correct: 1 },
            { id: 47, category: "Hardware", q: "What characterized first-generation computers (1946-1959)?", a: "Vacuum tubes for circuitry and magnetic drums for memory; large, expensive, generated excessive heat", choices: ["Transistors and magnetic core memory", "Integrated circuits on silicon chips", "Vacuum tubes and magnetic drums", "Microprocessors and semiconductor memory"], correct: 2 },
            { id: 48, category: "Hardware", q: "What characterized second-generation computers (1959-1965)?", a: "Transistors replaced vacuum tubes; smaller, more reliable, used assembly and high-level languages", choices: ["Vacuum tubes and punch card input", "Single-chip microprocessors", "Integrated circuits combining multiple transistors", "Transistors replacing vacuum tubes"], correct: 3 },
            { id: 49, category: "Hardware", q: "What characterized third-generation computers (1965-1971)?", a: "Integrated circuits on silicon chips; cheaper, faster, smaller; could run multiple applications", choices: ["Integrated circuits on silicon chips", "Discrete transistors on circuit boards", "Vacuum tubes and magnetic drum memory", "VLSI microprocessors with millions of transistors"], correct: 0 },
            { id: 50, category: "Hardware", q: "What characterized fourth-generation computers (1971-present)?", a: "Microprocessors with thousands of integrated circuits on a single chip; personal computers emerged", choices: ["Vacuum tubes as primary components", "Microprocessors on single chips", "Small-scale integrated circuits", "Individual transistors wired together"], correct: 1 },
            { id: 51, category: "Hardware", q: "What are the three types of buses in a computer?", a: "Address bus, Data bus, and Control bus", choices: ["System bus, Expansion bus, Local bus", "PCI bus, USB bus, SATA bus", "Address bus, Data bus, Control bus", "Front-side bus, Back-side bus, Memory bus"], correct: 2 },
            { id: 52, category: "Hardware", q: "What does the system clock do?", a: "Sends out pulses of electricity at regular intervals that electronic components need to operate; measured in MHz or GHz", choices: ["Maintains the current date and time for the OS", "Controls the timing of data writes to storage", "Measures CPU temperature and adjusts fan speed", "Sends electrical pulses for component operation"], correct: 3 },
            { id: 53, category: "Hardware", q: "What is an expansion slot?", a: "A socket on the motherboard where expansion cards (graphics, sound, network) can be installed", choices: ["A socket for installing expansion cards", "A memory slot for installing RAM modules", "A connector for external USB devices", "A slot for inserting storage drives"], correct: 0 },
            { id: 54, category: "Hardware", q: "What is the keyboard classified as?", a: "An input device - it translates data into a form the computer can understand", choices: ["An output device that displays text", "Input device", "A storage device for keystrokes", "A processing device for text"], correct: 1 },
            { id: 55, category: "Hardware", q: "What are monitors and printers classified as?", a: "Output devices - they translate information into a form humans can understand", choices: ["Input devices for capturing visual data", "Storage devices for display data", "Output devices", "Processing devices for rendering"], correct: 2 },
            { id: 56, category: "Hardware", q: "What is a supercomputer?", a: "The biggest and fastest computers, designed to process huge amounts of data using thousands of interconnected processors", choices: ["A high-end workstation for professional use", "A personal computer with enhanced graphics", "A server with redundant components", "The biggest/fastest computers for processing huge data"], correct: 3 },
            { id: 57, category: "Hardware", q: "What is a mainframe computer?", a: "A computer designed to support hundreds or thousands of users simultaneously and multiple programs at once", choices: ["A computer supporting hundreds/thousands of users simultaneously", "A powerful single-user workstation", "A cluster of standard PCs networked together", "A computer optimized for scientific calculations"], correct: 0 },
            { id: 58, category: "Hardware", q: "What is a workstation?", a: "A single-user computer designed for technical or scientific applications with faster processors and more RAM", choices: ["A multi-user server for enterprise applications", "A single-user computer for technical/scientific work", "A basic PC for home use", "A mobile computing device"], correct: 1 },

            // Networking
            { id: 59, category: "Networking", q: "Which network type spans a single building or campus?", a: "A network spanning a single building or building complex, connecting devices within the same location", choices: ["MAN (Metropolitan Area Network)", "VPN (Virtual Private Network)", "LAN (Local Area Network)", "WAN (Wide Area Network)"], correct: 2 },
            { id: 60, category: "Networking", q: "Which network type reaches across cities, states, or countries?", a: "A network that reaches across cities, states, or even across the world; the internet is the largest WAN", choices: ["LAN (Local Area Network)", "PAN (Personal Area Network)", "MAN (Metropolitan Area Network)", "WAN (Wide Area Network)"], correct: 3 },
            { id: 61, category: "Networking", q: "Which network type connects devices within a few feet, like wireless headphones to a phone?", a: "A network used for short-range communications within a few feet, like wireless headphones to a smartphone", choices: ["PAN (Personal Area Network)", "MAN (Metropolitan Area Network)", "LAN (Local Area Network)", "WAN (Wide Area Network)"], correct: 0 },
            { id: 62, category: "Networking", q: "Which topology connects devices to a shared communication line?", a: "A topology where machines are connected to a common communication line called a bus", choices: ["Ring topology", "Bus topology", "Star topology", "Mesh topology"], correct: 1 },
            { id: 63, category: "Networking", q: "Which topology connects all devices to a single central point?", a: "A topology with a single machine serving as a central point to which all others are connected", choices: ["Ring topology", "Bus topology", "Star topology", "Mesh topology"], correct: 2 },
            { id: 64, category: "Networking", q: "Which topology connects devices in a continuous loop?", a: "A topology where devices connect directly to each other as peers in a circular arrangement", choices: ["Bus topology", "Star topology", "Mesh topology", "Ring topology"], correct: 3 },
            { id: 65, category: "Networking", q: "Which topology connects every device to every other device for redundancy?", a: "A topology connecting every device to every other device, enabling redundancy", choices: ["Mesh topology", "Bus topology", "Star topology", "Ring topology"], correct: 0 },
            { id: 66, category: "Networking", q: "What is the client/server model?", a: "A model where clients make requests and servers satisfy those requests", choices: ["All devices share equal responsibilities", "Requesters send queries to centralized providers for resources", "Devices communicate without any hierarchy", "Multiple servers compete to serve requests"], correct: 1 },
            { id: 67, category: "Networking", q: "What is peer-to-peer (P2P) networking?", a: "A model where processes both request and provide services to each other, like instant messaging", choices: ["A dedicated server handles all requests", "Only receiving data is possible", "Processes both request and provide services", "A hierarchical network structure"], correct: 2 },
            { id: 68, category: "Networking", q: "What is TCP/IP?", a: "The most popular protocol for network communication, commonly found on the internet and home networks", choices: ["A physical network interface standard", "A wireless networking standard", "A type of network cabling", "The most popular network communication protocol"], correct: 3 },
            { id: 69, category: "Networking", q: "What is twisted pair cable?", a: "The most widely used transmission media; two insulated copper wires wound around each other", choices: ["Two insulated copper wires wound together", "A single copper conductor with shielding", "Glass fiber transmitting light signals", "A coaxial cable with inner and outer conductors"], correct: 0 },
            { id: 70, category: "Networking", q: "What is the maximum segment length for twisted pair cable?", a: "100 meters (328 feet)", choices: ["50 meters (164 feet)", "100 meters (328 feet)", "200 meters (656 feet)", "500 meters (1640 feet)"], correct: 1 },
            { id: 71, category: "Networking", q: "What minimum cable category is required for 1 Gbps?", a: "CAT5e", choices: ["CAT3", "CAT5", "CAT5e", "CAT4"], correct: 2 },
            { id: 72, category: "Networking", q: "What is fiber-optic cable?", a: "Cable using light reflection through a glass or plastic core; can provide up to 26,000 times the bandwidth of twisted pair", choices: ["Copper cable with improved shielding", "Enhanced coaxial cable design", "High-frequency radio transmission", "Cable using light through glass/plastic core"], correct: 3 },
            { id: 73, category: "Networking", q: "What does a repeater do?", a: "Extends the range of cabling by increasing the strength of the network signal", choices: ["Extends cable range by increasing signal strength", "Filters network traffic by MAC address", "Routes packets between different networks", "Connects different network protocols"], correct: 0 },
            { id: 74, category: "Networking", q: "What does a bridge do in networking?", a: "Connects different types of networks and only bridges messages addressed to devices on the other side", choices: ["Amplifies signals without filtering", "Connects different network types intelligently", "Routes traffic between subnets", "Provides wireless access points"], correct: 1 },
            { id: 75, category: "Networking", q: "What does a switch do?", a: "Reduces network traffic on LANs by sending messages only to the destination device instead of all devices", choices: ["Forwards packets between different IP networks using routing tables", "Connects network segments and forwards frames based on IP addresses", "Sends frames only to the specific port for the destination MAC address", "Regenerates and retimes network signals to extend cable distances"], correct: 2 },
            { id: 76, category: "Networking", q: "What does a router do?", a: "Makes the internet possible by forwarding messages between networks using routing tables", choices: ["Forwards frames to ports based on MAC address tables", "Segments collision domains within a single broadcast domain", "Extends network range by regenerating electrical signals", "Forwards packets between networks using IP routing tables"], correct: 3 },
            { id: 77, category: "Networking", q: "What are the three tiers of ISPs?", a: "Tier 1 (backbone), Tier 2 (regional), Tier 3 (access ISPs for homes/businesses)", choices: ["Tier 1 backbone, Tier 2 regional, Tier 3 access", "Enterprise, Business, Consumer tiers", "High-speed, Medium-speed, Low-speed tiers", "Fiber, Cable, DSL tiers"], correct: 0 },
            { id: 78, category: "Networking", q: "What is cluster computing?", a: "Using many independent computers to provide computation comparable to a larger machine", choices: ["A single powerful supercomputer", "Many independent computers working together", "Virtual machines on one physical host", "Remote desktop computing"], correct: 1 },
            { id: 79, category: "Networking", q: "What is grid computing?", a: "A distributed system more loosely coupled than clusters, working together to complete large tasks", choices: ["Tightly coupled computers in one location", "A single mainframe computer", "Loosely coupled systems completing large tasks together", "Virtual machine clusters"], correct: 2 },
            { id: 80, category: "Networking", q: "What is cloud computing?", a: "Large pools of shared computers allocated to clients as needed, like Amazon's EC2", choices: ["Dedicated on-premises servers", "Mainframe time-sharing systems", "Personal computers networked together", "Shared computers allocated to clients as needed"], correct: 3 },

            // Internet & Web
            { id: 81, category: "Internet", q: "What does DNS stand for and what does it do?", a: "Domain Name System - translates human-readable domain names into IP addresses", choices: ["Domain Name System - converts website names to numeric addresses", "Dynamic Network Service - manages network connections", "Data Naming Standard - organizes file names", "Distributed Node System - manages server clusters"], correct: 0 },
            { id: 82, category: "Internet", q: "What is an IP address?", a: "A unique identifier assigned to each machine on a network; IPv4 uses 32-bit, IPv6 uses 128-bit", choices: ["A domain name like google.com", "A unique network identifier for machines", "A MAC address assigned by manufacturers", "A port number for applications"], correct: 1 },
            { id: 83, category: "Internet", q: "How are IPv4 addresses written?", a: "In dotted decimal notation with bytes separated by periods (e.g., 192.207.177.103)", choices: ["In hexadecimal with colons like IPv6", "In pure binary format only", "In dotted decimal notation like 192.207.177.103", "In domain name format only"], correct: 2 },
            { id: 84, category: "Internet", q: "What is a URL?", a: "Uniform Resource Locator - the unique address of a web document including protocol, domain, and path", choices: ["Universal Routing Language - a network protocol", "User Request Link - a browser feature", "Unified Record Locator - a database term", "Uniform Resource Locator - web address with protocol, domain, and path"], correct: 3 },
            { id: 85, category: "Internet", q: "What does HTTP stand for?", a: "HyperText Transfer Protocol - the protocol for transferring hypertext over networks", choices: ["HyperText Transfer Protocol - used by browsers to fetch web pages", "Hyperlink Text Transport Protocol - links documents together", "Host Terminal Transfer Process - manages server connections", "Hybrid Text Transmission Protocol - combines text formats"], correct: 0 },
            { id: 86, category: "Internet", q: "What is HTML?", a: "HyperText Markup Language - a way of encoding documents with tags describing appearance and links", choices: ["Hosted Text Management Layer - a server-side technology", "HyperText Markup Language - tag-based language for web pages", "Hierarchical Template Modeling Language - for data structures", "High-level Text Manipulation Logic - a scripting approach"], correct: 1 },
            { id: 87, category: "Internet", q: "Who invented the World Wide Web?", a: "Tim Berners-Lee in the late 1980s", choices: ["Vint Cerf", "Steve Wozniak", "Tim Berners-Lee", "Marc Andreessen"], correct: 2 },
            { id: 88, category: "Internet", q: "What is VoIP?", a: "Voice over Internet Protocol - used for voice communication over the internet", choices: ["Video over Internet Protocol - streams visual content online", "Verified Online Identity Protocol - authenticates users", "Virtual Operating Internet Platform - hosts cloud services", "Voice over Internet Protocol - enables phone calls via internet"], correct: 3 },
            { id: 89, category: "Internet", q: "What is streaming?", a: "Transporting audio and video data across the internet in near real-time", choices: ["Transporting audio/video in near real-time", "Downloading complete files before playback", "Uploading content to servers", "Compressing media for storage"], correct: 0 },
            { id: 90, category: "Internet", q: "What is ICANN responsible for?", a: "Internet Corporation for Assigned Names and Numbers - coordinates internet operations and awards IP address blocks to ISPs", choices: ["Developing web standards and protocols", "Coordinating internet operations and IP addresses", "Regulating internet service providers", "Managing internet security threats"], correct: 1 },
            { id: 91, category: "Internet", q: "What does the TLD '.edu' indicate?", a: "An educational institution", choices: ["A commercial business", "A government agency", "An educational institution", "A nonprofit organization"], correct: 2 },
            { id: 92, category: "Internet", q: "What does the TLD '.gov' indicate?", a: "A government agency", choices: ["An educational institution", "A commercial business", "A nonprofit organization", "A government agency"], correct: 3 },

            // Security
            { id: 93, category: "Security", q: "What is malware?", a: "Malicious software intentionally designed to cause damage to a computer, server, client, or network", choices: ["Malicious software designed to cause damage", "Software with unintentional bugs", "Outdated software needing updates", "Beta software in testing"], correct: 0 },
            { id: 94, category: "Security", q: "What is a computer virus?", a: "Software that infects a computer by inserting itself into existing programs and executes when the host program runs", choices: ["Self-replicating malware that spreads across networks without user action", "Malware that attaches to host programs and runs when they execute", "Malware disguised as legitimate software to trick users into installing it", "Malware that encrypts files and demands payment for decryption"], correct: 1 },
            { id: 95, category: "Security", q: "What is a worm?", a: "An autonomous program that forwards copies of itself to other machines in a network", choices: ["Malware that requires attaching to executable files to spread", "Malware that appears legitimate but contains hidden malicious code", "Self-propagating malware that spreads without needing a host program", "Malware that records keystrokes and sends them to attackers"], correct: 2 },
            { id: 96, category: "Security", q: "What is spyware?", a: "Malicious software that resides on a computer, collecting information and reporting back to its creator", choices: ["Malware that displays unwanted advertisements in browsers", "Malware that encrypts user files and demands ransom", "Malware that replicates itself across network connections", "Malware that secretly monitors activity and exfiltrates data"], correct: 3 },
            { id: 97, category: "Security", q: "What is phishing?", a: "A technique to obtain private information by posing as a legitimate business and asking for it", choices: ["Posing as legitimate to obtain private information", "Scanning networks for vulnerabilities", "Intercepting encrypted communications", "Overloading servers with requests"], correct: 0 },
            { id: 98, category: "Security", q: "What is a denial-of-service (DoS) attack?", a: "The process of overloading a computer with messages, suffocating network resources", choices: ["Stealing user credentials through deception", "Overloading a computer to suffocate resources", "Intercepting data between two parties", "Guessing passwords through trial and error"], correct: 1 },
            { id: 99, category: "Security", q: "What is a man-in-the-middle (MITM) attack?", a: "An attack where the attacker intercepts data traveling to or from a victim's device", choices: ["Overwhelming a server with traffic", "Trying all password combinations", "Intercepting data between victim and destination", "Injecting malicious code into websites"], correct: 2 },
            { id: 100, category: "Security", q: "Which attack systematically tries every possible character combination to crack passwords?", a: "An attack using all possible character combinations to learn a user's password", choices: ["Rainbow table attack", "Dictionary attack", "Phishing attack", "Brute force attack"], correct: 3 },
            { id: 101, category: "Security", q: "Which attack uses wordlists of common terms and phrases to guess passwords?", a: "An attack trying hundreds or thousands of words from a dictionary file to identify passwords", choices: ["Dictionary attack", "Brute force attack", "Rainbow table attack", "SQL injection attack"], correct: 0 },
            { id: 102, category: "Security", q: "What is a firewall?", a: "A program that filters traffic passing through a point in the network, blocking suspicious messages", choices: ["A system that detects and alerts on suspicious network activity", "A barrier that filters traffic based on security rules", "Software that scans files for known malware signatures", "A tool that encrypts data in transit between endpoints"], correct: 1 },
            { id: 103, category: "Security", q: "What is a proxy server?", a: "Software that acts as an intermediary between client and server to shield the client from adverse actions", choices: ["A firewall blocking network traffic", "A VPN encrypting all traffic", "An intermediary protecting clients from server threats", "A load balancer distributing requests"], correct: 2 },
            { id: 104, category: "Security", q: "What is encryption?", a: "Encoding information to keep it confidential even if stolen", choices: ["Compressing data to save space", "Backing up data for recovery", "Hashing data for verification", "Encoding information to keep it confidential"], correct: 3 },
            { id: 105, category: "Security", q: "What is network auditing software?", a: "Software that monitors network behaviors looking for anomalies to proactively mitigate unwanted occurrences", choices: ["Software monitoring networks for anomalies", "Software that blocks malicious traffic", "Antivirus software scanning files", "Encryption software protecting data"], correct: 0 },

            // Operating Systems
            { id: 106, category: "Operating Systems", q: "What is an operating system?", a: "Software that manages computer hardware and software resources and provides common services for programs", choices: ["The CPU that processes instructions", "Software managing hardware/software resources", "The BIOS firmware on the motherboard", "Application software like web browsers"], correct: 1 },
            { id: 107, category: "Operating Systems", q: "What are the four categories of operating systems?", a: "Network OS, Server OS, Mobile OS, and Personal Computer OS", choices: ["Real-time, Batch, Distributed, Embedded", "Single-user, Multi-user, Single-task, Multi-task", "Network, Server, Mobile, Personal Computer", "Desktop, Laptop, Tablet, Smartphone"], correct: 2 },
            { id: 108, category: "Operating Systems", q: "What is Windows?", a: "A closed-source operating system developed by Microsoft with the largest market share for servers and PCs", choices: ["An open-source OS based on Unix", "A mobile-only operating system", "A Unix-based system like macOS", "Closed-source OS by Microsoft with largest market share"], correct: 3 },
            { id: 109, category: "Operating Systems", q: "What is macOS?", a: "A closed-source operating system developed by Apple, designed to run only on Apple hardware", choices: ["Closed-source OS by Apple for Apple hardware", "An open-source Unix derivative", "A Linux distribution for desktops", "A Windows-compatible system"], correct: 0 },
            { id: 110, category: "Operating Systems", q: "What is Linux?", a: "An open-source operating system that can be modified and distributed by anyone; has many distributions (flavors)", choices: ["Closed-source like Windows", "Open-source OS with many distributions", "Made by Apple for servers", "A proprietary Unix system"], correct: 1 },
            { id: 111, category: "Operating Systems", q: "What is Android?", a: "An open-source mobile operating system allowing OEMs to customize it; has the largest mobile user base", choices: ["A closed-source mobile OS by Apple", "A desktop operating system", "Open-source mobile OS with largest user base", "A proprietary OS by Samsung"], correct: 2 },
            { id: 112, category: "Operating Systems", q: "What is iOS?", a: "Apple's proprietary mobile operating system designed for Apple hardware only", choices: ["An open-source mobile OS", "An Android variant for Apple", "A mobile version of macOS", "Apple's proprietary mobile OS for Apple devices"], correct: 3 },
            { id: 113, category: "Operating Systems", q: "What is the kernel?", a: "The internal part of an operating system containing components that perform basic functions", choices: ["The internal core of an OS performing basic functions", "The graphical user interface", "The file system structure", "The device driver collection"], correct: 0 },
            { id: 114, category: "Operating Systems", q: "What is a file manager?", a: "An OS component that coordinates storage, maintains file records, controls access, and manages available space", choices: ["The memory management system", "An OS component managing files and storage", "The process scheduler", "The network stack"], correct: 1 },
            { id: 115, category: "Operating Systems", q: "What is utility software?", a: "Software that extends the capabilities of an operating system, like compression or network communication tools", choices: ["Core kernel components", "Device driver software", "Software extending OS capabilities", "System BIOS firmware"], correct: 2 },
            { id: 116, category: "Operating Systems", q: "What is the difference between CLI and GUI?", a: "CLI (Command Line Interface) uses text commands; GUI (Graphical User Interface) uses visual elements and input devices", choices: ["CLI is faster; GUI is more accurate", "CLI is newer; GUI is older technology", "CLI requires more RAM; GUI requires more storage", "CLI uses text; GUI uses visual elements"], correct: 3 },
            { id: 117, category: "Operating Systems", q: "What is a device driver?", a: "Software that communicates with controllers or peripheral devices, translating generic requests into technical steps", choices: ["Software enabling communication with peripherals", "The physical controller on the device", "The cable connecting devices", "The port on the motherboard"], correct: 0 },
            { id: 118, category: "Operating Systems", q: "What is virtual memory?", a: "Additional memory space created in secondary memory by paging when more main memory is needed", choices: ["RAM installed in the computer", "Additional memory created by paging to secondary storage", "Cache memory in the CPU", "Read-only memory for firmware"], correct: 1 },
            { id: 119, category: "Operating Systems", q: "What is paging?", a: "A technique where the OS rotates programs and data between primary and secondary memory", choices: ["Allocating memory in fixed blocks", "Caching frequently used data", "Rotating programs between primary and secondary memory", "Defragmenting the hard drive"], correct: 2 },
            { id: 120, category: "Operating Systems", q: "In Windows, what character separates directory paths?", a: "Backward slash (\\)", choices: ["Forward slash (/)", "Semicolon (;)", "Colon (:)", "Backward slash (\\)"], correct: 3 },
            { id: 121, category: "Operating Systems", q: "In Linux, what character separates directory paths?", a: "Forward slash (/)", choices: ["Forward slash (/)", "Backward slash (\\)", "Colon (:)", "Semicolon (;)"], correct: 0 },
            { id: 122, category: "Operating Systems", q: "Is Linux case-sensitive for file names?", a: "Yes, Linux is case-sensitive", choices: ["No, Linux ignores case", "Yes, Linux is case-sensitive", "Only for executable files", "Only in the home directory"], correct: 1 },

            // Programming
            { id: 123, category: "Programming", q: "What is source code?", a: "Computer programs written in high-level language that humans can understand", choices: ["Compiled executable files", "Binary machine instructions", "Human-readable code in high-level languages", "Assembly language mnemonics"], correct: 2 },
            { id: 124, category: "Programming", q: "What is machine code?", a: "Programs written in binary (0s and 1s) that computers can directly execute", choices: ["High-level source code", "Pseudocode algorithms", "Interpreted script files", "Binary code (0s and 1s) computers execute directly"], correct: 3 },
            { id: 125, category: "Programming", q: "What does a compiler do?", a: "Translates entire source code into machine language at once, checking for errors before translation", choices: ["Converts all source code to executable machine code before running", "Translates and executes source code one statement at a time", "Checks syntax without producing executable output", "Links object files together into a single executable"], correct: 0 },
            { id: 126, category: "Programming", q: "What does an interpreter do?", a: "Translates and executes source code into machine language one line at a time", choices: ["Converts entire program to machine code before execution begins", "Translates and runs code one statement at a time during execution", "Combines multiple object files into a single executable", "Converts bytecode into native machine instructions"], correct: 1 },
            { id: 127, category: "Programming", q: "Which languages use compilers?", a: "C, C++, C#, Java, Go/GoLang, Visual Basic .NET", choices: ["Python, JavaScript, PHP, Ruby", "Perl, TCL, Bash, PowerShell", "C, C++, C#, Java, Go", "HTML, CSS, SQL, XML"], correct: 2 },
            { id: 128, category: "Programming", q: "Which languages use interpreters?", a: "Python, Perl, JavaScript, PHP, TCL, Ruby", choices: ["C, C++, C#, Go", "Assembly, COBOL, Fortran", "Java, Kotlin, Swift, Rust", "Python, Perl, JavaScript, PHP"], correct: 3 },
            { id: 129, category: "Programming", q: "What is an algorithm?", a: "A step-by-step formula or set of instructions outlining how to execute a task", choices: ["Step-by-step instructions for executing a task", "A specific programming language syntax", "A compiled executable program", "A debugging tool for code"], correct: 0 },
            { id: 130, category: "Programming", q: "What is debugging?", a: "The process of finding and fixing errors in code", choices: ["Adding new features to code", "Finding and fixing code errors", "Compiling source code", "Documenting code functionality"], correct: 1 },

            // Licensing & IP
            { id: 131, category: "Licensing", q: "Which license type allows anyone to modify and distribute the software with accessible source code?", a: "Software that can be modified and distributed by anyone, with accessible source code", choices: ["Proprietary software", "Commercial software", "Open-source software", "Public domain software"], correct: 2 },
            { id: 132, category: "Licensing", q: "Which license type restricts code modification to only the owning company?", a: "Software where only the owning company can modify the code", choices: ["Open-source software", "Public domain software", "Freeware", "Proprietary software"], correct: 3 },
            { id: 133, category: "Licensing", q: "Which license type provides trial software with time or feature limitations?", a: "An application installed as a trial limited by time and/or functionality", choices: ["Shareware", "Public domain software", "Open-source software", "Freeware"], correct: 0 },
            { id: 134, category: "Licensing", q: "Which license type provides free software protected by EULA and copyright?", a: "Free software protected by EULA and copyright laws", choices: ["Shareware", "Freeware", "Public domain software", "Open-source software"], correct: 1 },
            { id: 135, category: "Licensing", q: "What is public domain software?", a: "Software with no EULA and no intellectual property protections, available for anyone to use", choices: ["Software protected by copyright", "Software requiring license fees", "Software with no EULA or IP protections", "Open-source with GPL restrictions"], correct: 2 },
            { id: 136, category: "Licensing", q: "What is a EULA?", a: "End-User License Agreement - defines terms and conditions for legally using software", choices: ["Extended Utility License Application - grants extra permissions", "Encrypted User Login Access - secures authentication", "Enterprise Unified Licensing Arrangement - covers organizations", "End-User License Agreement - defines software usage terms"], correct: 3 },
            { id: 137, category: "Licensing", q: "What is copyright?", a: "Legal protection giving an author the ability to prevent unauthorized duplication for at least 35 years", choices: ["Legal protection against unauthorized duplication", "A license to freely copy software", "A type of software patent", "Permission to modify source code"], correct: 0 },
            { id: 138, category: "Licensing", q: "What does a patent protect in software?", a: "Unique methods, algorithms, or processes embedded within software applications", choices: ["The source code itself", "Unique methods, algorithms, or processes", "The user interface design", "The software's brand name"], correct: 1 },
            { id: 139, category: "Licensing", q: "What is bespoke software?", a: "Custom-made software specifically designed and developed for an organization", choices: ["Generic software for mass market", "Open-source community software", "Custom software made for a specific organization", "Pre-packaged enterprise solutions"], correct: 2 },
            { id: 140, category: "Licensing", q: "What is off-the-shelf software?", a: "Software providing general features useful to a broad range of users, not customizable", choices: ["Custom-developed enterprise software", "Software built to specific requirements", "Open-source modifiable software", "General software for broad use, not customizable"], correct: 3 },

            // Databases
            { id: 141, category: "Databases", q: "What is a database?", a: "An organized collection of data stored and maintained by an organization, integrated across systems", choices: ["An organized collection of integrated data", "A single spreadsheet file", "A data backup system", "A file storage system"], correct: 0 },
            { id: 142, category: "Databases", q: "What is a DBMS?", a: "Database Management System - software that manages the database and handles queries from applications", choices: ["A type of database model", "Software managing databases and handling queries", "A query language like SQL", "A database backup tool"], correct: 1 },
            { id: 143, category: "Databases", q: "What is a record in a database?", a: "A row in a table containing related information about a single entity", choices: ["A column containing one data type", "The entire database table", "A row containing related information", "A relationship between tables"], correct: 2 },
            { id: 144, category: "Databases", q: "What is a field in a database?", a: "A column containing a single piece of data about the subject of a record", choices: ["A complete row of data", "A table relationship", "A database index", "A column with a single piece of data"], correct: 3 },
            { id: 145, category: "Databases", q: "What is a primary key?", a: "A unique identifier for each record in a table that creates relationships among tables", choices: ["A field that uniquely identifies each record in a table", "A field that references the primary key of another table", "A data structure that speeds up query performance", "A constraint that ensures values in a column are not null"], correct: 0 },
            { id: 146, category: "Databases", q: "What is a foreign key?", a: "A field in one table that refers to the primary key in another table, creating a relationship", choices: ["A field that uniquely identifies each record within its own table", "A field that references the primary key of a different table", "A composite key made from multiple columns combined", "A candidate key that was not chosen as the primary key"], correct: 1 },
            { id: 147, category: "Databases", q: "Which database type stores data in plain text with one record per line?", a: "A database storing data in a plain text file with one record per line, using delimiters", choices: ["Relational database", "Hierarchical database", "Flat-file database", "Graph database"], correct: 2 },
            { id: 148, category: "Databases", q: "Which database type organizes data in a tree structure with parent-child relationships?", a: "A database with data organized in a tree structure with parent-child relationships", choices: ["Flat-file database", "Document database", "Relational database", "Hierarchical database"], correct: 3 },
            { id: 149, category: "Databases", q: "Which database type uses tables joined together via primary and foreign keys?", a: "A database containing tables that can be joined together using primary and foreign keys", choices: ["Relational database", "Flat-file database", "Hierarchical database", "Key-value database"], correct: 0 },
            { id: 150, category: "Databases", q: "What is SQL?", a: "Structured Query Language - code used to query, manipulate, and manage relational databases", choices: ["A general-purpose programming language", "Language for querying and managing databases", "A NoSQL query format", "A database modeling notation"], correct: 1 },
            { id: 151, category: "Databases", q: "What does SELECT * FROM Patient mean in SQL?", a: "Retrieve all fields from all records in the Patient table", choices: ["Delete all records from Patient table", "Insert a new record into Patient", "Retrieve all data from Patient table", "Update all records in Patient"], correct: 2 },
            { id: 152, category: "Databases", q: "What does the WHERE clause do in SQL?", a: "Specifies conditions for filtering which records to return", choices: ["Sorts the results in order", "Joins tables together", "Groups records by a field", "Filters records based on conditions"], correct: 3 },
            { id: 153, category: "Databases", q: "What is NoSQL?", a: "Not Only SQL - databases accommodating various data models including key-value, document, and graph formats", choices: ["Databases with various models beyond traditional SQL", "Databases that don't use any queries", "A newer version of SQL syntax", "Relational databases without tables"], correct: 0 },
            { id: 154, category: "Databases", q: "What is a cloud database?", a: "A database optimized for cloud environments with scalability and high availability", choices: ["A database storing weather data", "A remotely-hosted DB with elastic scaling and high availability", "An on-premises database server", "A local SQLite database"], correct: 1 },
            { id: 155, category: "Databases", q: "What is a data lake?", a: "A system storing data in raw format, including both structured and unstructured enterprise data", choices: ["A normalized relational database", "A data warehouse with processed data", "Storage for raw structured and unstructured data", "A backup and recovery system"], correct: 2 },
            { id: 156, category: "Databases", q: "What are DBA responsibilities?", a: "Database security, tuning, high availability, business continuity, backup/recovery, reporting, and development", choices: ["Only performing backups", "Only managing user accounts", "Only writing SQL queries", "Security, tuning, availability, backup, reporting, development"], correct: 3 },

            // Project Management
            { id: 157, category: "Project Management", q: "What is a project?", a: "A purpose-driven event with a defined start and finish", choices: ["A purpose-driven event with defined start and finish", "Continuous operational work", "Ongoing maintenance activities", "Regular business operations"], correct: 0 },
            { id: 158, category: "Project Management", q: "What are the four phases of the project management life cycle?", a: "Initiation, Planning, Execution, and Closure", choices: ["Analysis, Design, Development, Testing", "Initiation, Planning, Execution, Closure", "Requirements, Design, Implementation, Maintenance", "Concept, Development, Testing, Release"], correct: 1 },
            { id: 159, category: "Project Management", q: "What happens during project initiation?", a: "The project is broadly defined with a business case, feasibility study, and project charter", choices: ["Actual development work begins", "Quality assurance testing starts", "Project is defined with business case and charter", "Final deliverables are handed off"], correct: 2 },
            { id: 160, category: "Project Management", q: "What happens during project planning?", a: "Goals are set, scope defined, and project management plan created with resources, cost, and time estimates", choices: ["The actual project work is performed", "Initial concept is developed", "The project is handed off to stakeholders", "Goals, scope, and plan created with estimates"], correct: 3 },
            { id: 161, category: "Project Management", q: "What does SMART stand for in goal setting?", a: "Specific, Measurable, Attainable, Realistic, Timely", choices: ["Specific, Measurable, Attainable, Realistic, Timely", "Strategic, Managed, Actionable, Reviewed, Tracked", "Simple, Modular, Agile, Rapid, Technical", "Scoped, Monitored, Approved, Resourced, Tested"], correct: 0 },
            { id: 162, category: "Project Management", q: "What is scope creep?", a: "Uncontrolled change of a project's scope, typically adding tasks and unplanned costs", choices: ["Proper scope management and control", "Uncontrolled scope changes adding tasks and costs", "Reducing project scope to meet deadlines", "Formal change request process"], correct: 1 },
            { id: 163, category: "Project Management", q: "What is a work breakdown structure (WBS)?", a: "A document breaking the project into manageable segments for the team", choices: ["A detailed project budget", "A timeline with milestones", "Breaking project into manageable segments", "A list of team members"], correct: 2 },
            { id: 164, category: "Project Management", q: "What are key performance indicators (KPIs)?", a: "Metrics used to monitor project progress and determine if milestones are being met", choices: ["Employee satisfaction scores", "Software testing results", "Financial accounting measures", "Metrics monitoring project progress"], correct: 3 },

            // SDLC
            { id: 165, category: "SDLC", q: "What is SDLC?", a: "Software Development Life Cycle - a framework for developing software through defined phases", choices: ["Software Development Life Cycle - framework for building software through phases", "System Data Logic Controller - hardware component for processing", "Structured Design Language Code - a programming paradigm", "Software Debug and Log Checker - a testing tool"], correct: 0 },
            { id: 166, category: "SDLC", q: "What is the waterfall model?", a: "A sequential development process where each phase must be completed before moving to the next", choices: ["Iterative cycles with continuous feedback", "Sequential development completing phases in order", "Rapid prototyping with user testing", "Flexible development without fixed phases"], correct: 1 },
            { id: 167, category: "SDLC", q: "What is the incremental model?", a: "A model where the system is constructed in increments, with each version adding more features", choices: ["Building complete system at once", "Prototyping without final production", "System built in increments adding features", "Sequential phases without iteration"], correct: 2 },
            { id: 168, category: "SDLC", q: "What is prototyping?", a: "Building and evaluating basic versions of a proposed system before full development", choices: ["Completing full development immediately", "Documenting requirements without building", "Testing only after development", "Building and evaluating basic versions first"], correct: 3 },
            { id: 169, category: "SDLC", q: "What is Agile methodology?", a: "System development with incremental implementations, responding to rapidly changing requirements", choices: ["Incremental development responding to changing requirements", "Rigid sequential development phases", "Extensive upfront planning without changes", "Single delivery at project end"], correct: 0 },
            { id: 170, category: "SDLC", q: "What is Scrum?", a: "An Agile methodology using sprints, daily scrums, and prioritized wish lists", choices: ["A waterfall-based methodology", "An iterative approach with time-boxed cycles and daily standups", "A testing framework", "A documentation standard"], correct: 1 },
            { id: 171, category: "SDLC", q: "What is requirements analysis?", a: "Determining what services the system will provide and how users will interact with it", choices: ["Writing implementation code", "Performing system testing", "Determining system services and user interaction", "Deploying the final system"], correct: 2 },
            { id: 172, category: "SDLC", q: "What is the SRS?", a: "System Requirement Specification - a written agreement recording system requirements to guide development", choices: ["Software Release Schedule - timeline for deployments", "System Recovery Script - restores after failures", "Structured Review Summary - feedback from code reviews", "Software Requirements Specification - documents what the system must do"], correct: 3 },

            // Testing
            { id: 173, category: "Testing", q: "What is alpha testing?", a: "First stage testing where developers and/or internal UX team test a preliminary version", choices: ["Internal testing by developers before external release", "Testing by selected external users in a controlled environment", "Final validation testing in production by end users", "Automated testing that runs after each code commit"], correct: 0 },
            { id: 174, category: "Testing", q: "What is beta testing?", a: "Second stage where end users test the system before final release, also called pilot testing", choices: ["Internal testing by the development team before any external exposure", "External user testing in real-world conditions before final release", "Formal validation that system meets documented requirements", "Testing individual code modules in isolation"], correct: 1 },
            { id: 175, category: "Testing", q: "What is user acceptance testing?", a: "Final stage where users test the system in an operational setting to ensure business objectives are met", choices: ["Initial developer testing phase", "Automated integration testing", "Final operational testing for business objectives", "Code review by developers"], correct: 2 },
            { id: 176, category: "Testing", q: "What is white-box testing?", a: "Testing based on knowledge of a system's internal components, also called glass-box testing", choices: ["Testing system behavior without viewing source code", "Testing against documented requirements only", "Testing user interface and user experience", "Testing with full visibility into internal code structure"], correct: 3 },
            { id: 177, category: "Testing", q: "What is black-box testing?", a: "Testing focused on user experience without knowledge of the system's internal structure", choices: ["Testing inputs and outputs without knowledge of internal code", "Testing internal logic paths and code coverage", "Testing individual functions in complete isolation", "Testing with access to source code and documentation"], correct: 0 },
            { id: 178, category: "Testing", q: "What is the Pareto principle in testing?", a: "The theory that 80% of errors come from 20% of the system", choices: ["All modules have equal defects", "80% of errors come from 20% of the system", "Testing covers 100% of code", "Defects are evenly distributed"], correct: 1 },

            // System Maintenance
            { id: 179, category: "Maintenance", q: "What is corrective maintenance?", a: "Maintenance to remove errors and ensure system functionality", choices: ["Adding new features to the system", "Improving system performance", "Removing errors for functionality", "Preventing future issues"], correct: 2 },
            { id: 180, category: "Maintenance", q: "What is adaptive maintenance?", a: "Maintenance performed when organizational changes affect system requirements", choices: ["Fixing bugs and defects", "Preventive code restructuring", "Performance optimization", "Changes due to organizational requirement changes"], correct: 3 },
            { id: 181, category: "Maintenance", q: "What is perfective maintenance?", a: "Maintenance when new components are added or existing components improved for better performance", choices: ["Adding or improving components for performance", "Fixing critical system bugs", "Adapting to external changes", "Restructuring to prevent decay"], correct: 0 },
            { id: 182, category: "Maintenance", q: "What is preventive maintenance?", a: "Changes to increase system life span, including restructuring, optimizing code, and updating documentation", choices: ["Fixing reported bugs", "Changes to increase system life span", "Adding requested features", "Emergency security patches"], correct: 1 },

            // IT Governance & Organization
            { id: 183, category: "IT Governance", q: "What is IT governance?", a: "The system of processes ensuring effective and efficient IT use to achieve business goals", choices: ["Government IT regulations", "IT department management only", "Processes ensuring effective IT use for business goals", "Technical standards compliance"], correct: 2 },
            { id: 184, category: "IT Governance", q: "What are the five IT function domains?", a: "Communication, data collection/management, information security, customer relationship management, process improvement", choices: ["Hardware, software, network, security, support", "Planning, execution, monitoring, closing, maintenance", "Development, testing, deployment, monitoring, support", "Communication, data, security, CRM, process improvement"], correct: 3 },
            { id: 185, category: "IT Governance", q: "What is outsourcing?", a: "Using resources and skills from an external organization for IT functions", choices: ["Contracting third-party vendors for business functions", "Hiring internal IT staff", "Developing in-house solutions", "Training existing employees"], correct: 0 },
            { id: 186, category: "IT Governance", q: "What is insourcing?", a: "Assigning a project to employees within the organization", choices: ["Hiring external contractors", "Using your own staff instead of third-party vendors", "Offshoring to other countries", "Using managed service providers"], correct: 1 },
            { id: 187, category: "IT Governance", q: "What is offshoring?", a: "Outsourcing outside country lines", choices: ["Keeping operations in the same country", "Moving operations nearby", "Relocating work to a foreign country", "Using local contractors"], correct: 2 },
            { id: 188, category: "IT Governance", q: "What is nearshoring?", a: "Offshoring to countries in a closer time zone or with similar economic structure", choices: ["Outsourcing to distant countries", "Using domestic contractors", "Keeping work fully internal", "Relocating work to geographically close regions"], correct: 3 },

            // Software Types
            { id: 189, category: "Software", q: "What is system software?", a: "General-purpose software used to operate computer hardware and provide a platform for application software", choices: ["Software to operate hardware and support applications", "End-user productivity applications", "Custom business applications", "Web-based services"], correct: 0 },
            { id: 190, category: "Software", q: "What is application software?", a: "Specific-purpose software used to perform specific tasks like word processing or email", choices: ["Operating system software", "Software for specific tasks like word processing", "Hardware driver software", "System utility programs"], correct: 1 },
            { id: 191, category: "Software", q: "What is productivity software?", a: "Software used to complete daily tasks such as writing documents, presentations, and managing data", choices: ["Entertainment and gaming software", "System administration tools", "Software for documents, presentations, data management", "Security and antivirus programs"], correct: 2 },
            { id: 192, category: "Software", q: "Which software type helps people communicate, work together, and share information?", a: "Software helping people communicate and work together, and computers share information", choices: ["System software", "Utility software", "Productivity software", "Groupware and teamwork platforms"], correct: 3 },
            { id: 193, category: "Software", q: "Give examples of word processing software.", a: "Microsoft Word, Google Docs, OpenOffice Writer", choices: ["Word, Google Docs, OpenOffice Writer", "Excel, Sheets", "PowerPoint, Slides", "Access, MySQL"], correct: 0 },
            { id: 194, category: "Software", q: "Give examples of spreadsheet software.", a: "Microsoft Excel, Google Sheets, OpenOffice Calc", choices: ["Word, Docs", "Excel, Google Sheets, OpenOffice Calc", "PowerPoint, Slides", "Access, MySQL"], correct: 1 },
            { id: 195, category: "Software", q: "Give examples of presentation software.", a: "Microsoft PowerPoint, Google Slides, OpenOffice Impress", choices: ["Word, Docs", "Excel, Sheets", "PowerPoint, Google Slides, OpenOffice Impress", "Access, MySQL"], correct: 2 },

            // More questions from embedded quizzes
            { id: 196, category: "IT Roles", q: "Which role is responsible for maintaining websites?", a: "Web Administrator", choices: ["Data analyst", "Network engineer", "Cloud architect", "Webmaster"], correct: 3 },
            { id: 197, category: "Databases", q: "What is the collection of names, addresses, and account balances called?", a: "A database", choices: ["A database", "A key field", "A file", "A record"], correct: 0 },
            { id: 198, category: "Databases", q: "What is a tree-like structure of records in a database called?", a: "Hierarchical database structure", choices: ["Flat file", "Hierarchical database structure", "Field", "Relational database structure"], correct: 1 },
            { id: 199, category: "Hardware", q: "What is the role of the CPU in a computing system?", a: "Performing instructions of computer programs", choices: ["Permanently storing all data", "Distributing signals", "Performing instructions of computer programs", "Temporary storage"], correct: 2 },
            { id: 200, category: "Networking", q: "Which network topology best handles downed links without losing connectivity?", a: "Mesh", choices: ["Bus", "Ring", "Star", "Mesh"], correct: 3 },
            { id: 201, category: "Networking", q: "Which type of network interconnects devices in a single office or building?", a: "LAN (Local Area Network)", choices: ["LAN", "PAN", "SAN", "WAN"], correct: 0 },
            { id: 202, category: "Internet", q: "IP addresses are traditionally written in what notation?", a: "Dotted decimal notation", choices: ["Encrypted", "Dotted decimal", "Mnemonic", "Binary"], correct: 1 },
            { id: 203, category: "Internet", q: "What tool is used to encode a document while focusing on appearance?", a: "HTML", choices: ["DNS", "HTTP", "HTML", "URL"], correct: 2 },
            { id: 205, category: "Security", q: "Which technique obtains sensitive information by pretending to be trustworthy?", a: "Phishing", choices: ["Phishing", "Black hat", "Packet sniffing", "Buffer overflow"], correct: 0 },
            { id: 206, category: "Security", q: "What role does a firewall play?", a: "Filtering incoming and outgoing network traffic for security purposes", choices: ["Managing local network traffic", "Filtering network traffic for security", "Directing data packets", "Converting signals"], correct: 1 },
            { id: 207, category: "Hardware", q: "Which component converts analog signals to digital signals?", a: "Modem", choices: ["Switch", "Router", "Modem", "Firewall"], correct: 2 },
            { id: 208, category: "Operating Systems", q: "Where are the basic functions of the operating system located?", a: "Kernel", choices: ["Applications", "File manager", "Utility software", "Kernel"], correct: 3 },
            { id: 209, category: "Operating Systems", q: "Which OS is known for open-source nature and server use?", a: "Linux", choices: ["Linux", "Windows", "macOS", "Android"], correct: 0 },
            { id: 210, category: "Programming", q: "What is the main difference between compiler and interpreter?", a: "Compiler translates all at once; interpreter translates line by line", choices: ["Compiler to machine code, interpreter to high-level", "Interpreter line by line, compiler all at once to executable", "Compiler for web, interpreter for software", "Compiler is faster"], correct: 1 },
            { id: 211, category: "Programming", q: "What is the function of a compiler?", a: "To convert high-level language code into machine code for execution", choices: ["Debug and test code", "Execute source code directly", "Convert high-level to machine code", "Interpret code line-by-line"], correct: 2 },
            { id: 213, category: "Databases", q: "What fundamental structure organizes data in a relational database?", a: "Tables", choices: ["Tables", "Arrays", "Loops", "Pointers"], correct: 0 },
            { id: 214, category: "Databases", q: "What characterizes NoSQL database organization?", a: "Flexibility in handling unstructured and semi-structured data", choices: ["Strict fixed schema", "Flexibility with unstructured data", "SQL queries only", "Relational models only"], correct: 1 },
            { id: 215, category: "SDLC", q: "Which phase organizes project scope, objectives, and deliverables?", a: "Planning", choices: ["Initiating", "Execution", "Planning", "Closing"], correct: 2 },
            { id: 216, category: "Data & Information", q: "Most stored data today is what type?", a: "Unstructured (text, blogs, tweets, audio)", choices: ["Structured", "Organized", "Semi-structured", "Unstructured"], correct: 3 },
            { id: 217, category: "Hardware", q: "What defines output in computing?", a: "Processed or generated information produced by a system", choices: ["Processed information produced by system", "Information stored for later", "Data awaiting processing", "Data input into system"], correct: 0 },
            { id: 219, category: "Hardware", q: "Which category do barcode scanners and webcams belong to?", a: "Input", choices: ["Temporary memory", "Output", "Input", "Storage"], correct: 2 },
            { id: 220, category: "Software", q: "Which software category performs system maintenance like disk cleaning?", a: "Utility Software", choices: ["System Software", "Security Software", "Firmware", "Utility Software"], correct: 3 },

            // CIA Triad
            { id: 221, category: "Security", q: "What does CIA stand for in cybersecurity?", a: "Confidentiality, Integrity, Availability", choices: ["Central Intelligence Agency - a government organization", "Confidentiality, Integrity, Availability - the security triad", "Cybersecurity, Internet, Accessibility - web standards", "Compliance, Information, Authorization - access controls"], correct: 1 },
            { id: 222, category: "Security", q: "Which element of the CIA triad ensures data is not modified by unauthorized users?", a: "Integrity", choices: ["Confidentiality", "Integrity", "Availability", "Authentication"], correct: 1 },
            { id: 223, category: "Security", q: "Which element of the CIA triad ensures authorized users can access data when needed?", a: "Availability", choices: ["Confidentiality", "Integrity", "Availability", "Authorization"], correct: 2 },
            { id: 224, category: "Security", q: "Which element of the CIA triad restricts access to only those who need to know?", a: "Confidentiality", choices: ["Confidentiality", "Integrity", "Availability", "Accountability"], correct: 0 },

            // Ethics & Professional Codes
            { id: 225, category: "Ethics", q: "What is the difference between ethics and regulations?", a: "Regulations are requirements from governing bodies with penalties; ethics are personal/organizational morals", choices: ["Ethics have legal penalties; regulations are optional", "Regulations are requirements with penalties; ethics are morals", "They are the same thing", "Ethics apply only to IT; regulations apply everywhere"], correct: 1 },
            { id: 226, category: "Ethics", q: "What is a conflict of interest?", a: "A situation where a person has two relationships that might be incompatible with each other", choices: ["A disagreement between colleagues", "When a person has incompatible loyalties or relationships", "A software licensing dispute", "A data privacy violation"], correct: 1 },
            { id: 227, category: "Ethics", q: "What is an Acceptable Use Policy (AUP)?", a: "A policy detailing how computer systems owned by an organization can be used", choices: ["A software license agreement", "A data backup policy", "Rules governing employee conduct on company IT resources", "A network security protocol"], correct: 2 },
            { id: 228, category: "Ethics", q: "What did the Computer Ethics Institute develop?", a: "Ten Commandments of Computer Ethics", choices: ["Ten Commandments of Computer Ethics", "IEEE Code of Ethics", "ACM Code of Conduct", "AITP Standards of Practice"], correct: 0 },
            { id: 229, category: "Ethics", q: "What does ACM stand for?", a: "Association for Computing Machinery", choices: ["American Computer Manufacturers - hardware trade group", "Association for Computing Machinery - professional CS organization", "Automated Computing Management - IT operations framework", "Advanced Computer Methods - programming techniques"], correct: 1 },
            { id: 230, category: "Ethics", q: "What does IEEE stand for?", a: "Institute of Electrical and Electronics Engineers", choices: ["International Electronics Engineering Entity - EU standards body", "Institute of Electrical and Electronics Engineers - professional association", "Information Engineering and Ethics Experts - advisory board", "Internet Engineering Excellence Establishment - web consortium"], correct: 1 },

            // Business Continuity & Disaster Recovery
            { id: 231, category: "IT Governance", q: "What is a disaster recovery plan (DRP)?", a: "A plan that ensures systems can recover from catastrophic events with minimal data loss", choices: ["A plan for daily backups", "A strategy for restoring IT systems after catastrophic failures", "An insurance policy for IT equipment", "A network monitoring strategy"], correct: 1 },
            { id: 232, category: "IT Governance", q: "What is a business continuity plan?", a: "A plan defining how to resume services and vital business operations during disruptions", choices: ["A marketing strategy", "A plan for resuming services during disruptions", "An employee training program", "A software development plan"], correct: 1 },
            { id: 233, category: "IT Governance", q: "What is hot storage in disaster recovery?", a: "Storage allowing quickest access to restore critical data after a disaster", choices: ["Storage in warm locations", "Always-online data with instant access for rapid restoration", "Storage that runs continuously", "Overheated storage devices"], correct: 1 },
            { id: 234, category: "IT Governance", q: "What is cold storage in disaster recovery?", a: "Less expensive storage with less frequent access and slower recovery times", choices: ["Refrigerated storage for servers", "Low-cost archival data accessed infrequently with longer retrieval time", "Storage in cold climates", "Frozen backup tapes"], correct: 1 },
            { id: 235, category: "IT Governance", q: "What does 'five nines' mean for system uptime?", a: "99.999% availability, approximately 5 minutes of downtime per year", choices: ["Five backup copies", "99.999% uptime availability", "Five data centers", "Five security levels"], correct: 1 },

            // IoT & Emerging Tech
            { id: 236, category: "Networking", q: "What is the Internet of Things (IoT)?", a: "A system of interconnected devices with unique identifiers that can transfer data via a network without human interaction", choices: ["The World Wide Web", "Smart devices communicating and exchanging data autonomously", "A social media network", "A cloud computing platform"], correct: 1 },
            { id: 237, category: "IT Governance", q: "What is globalization in the context of IT?", a: "The growing interdependence of world economies and cultures brought about by trade and the flow of information", choices: ["Using global IP addresses", "Growing interdependence of economies through trade and information", "Having servers worldwide", "Using international domain names"], correct: 1 },

            // Computer History
            { id: 238, category: "Hardware", q: "What was the abacus used for?", a: "One of the earliest computing devices for performing calculations using beads on rods", choices: ["Storing written documents", "Performing calculations using beads", "Sending messages", "Keeping time"], correct: 1 },
            { id: 239, category: "Hardware", q: "Who is considered the world's first computer programmer?", a: "Ada Lovelace", choices: ["Charles Babbage", "Ada Lovelace", "Alan Turing", "Grace Hopper"], correct: 1 },
            { id: 240, category: "Hardware", q: "What was ENIAC?", a: "Electronic Numerical Integrator and Calculator - an early electronic computer from the 1940s", choices: ["A programming language", "An early electronic computer", "A type of vacuum tube", "A network protocol"], correct: 1 },
            { id: 241, category: "Internet", q: "Who invented the World Wide Web?", a: "Tim Berners-Lee in the late 1980s", choices: ["Bill Gates", "Steve Jobs", "Tim Berners-Lee", "Vint Cerf"], correct: 2 },

            // Technical Details
            { id: 242, category: "Networking", q: "What is baseband transmission?", a: "A signal at a narrow frequency range on which data is transmitted, like Ethernet LANs", choices: ["High-speed wireless transmission", "Narrow frequency signal transmission like Ethernet", "Satellite communication", "Fiber optic transmission"], correct: 1 },
            { id: 243, category: "Networking", q: "What is broadband transmission?", a: "High-capacity transmission technologies for data, voice, and video across long distances", choices: ["Low-speed local transmission", "High-capacity transmission for data/voice/video", "Wireless Bluetooth transmission", "Near-field communication"], correct: 1 },
            { id: 244, category: "Hardware", q: "What is a petabyte (PB)?", a: "1,024 terabytes", choices: ["1,000 gigabytes", "1,024 gigabytes", "1,024 terabytes", "1,024 megabytes"], correct: 2 },
            { id: 245, category: "Operating Systems", q: "What is a superuser or root account?", a: "An administrator account that can alter settings, modify software, and perform maintenance activities", choices: ["A regular user with limited access", "An administrator account with full system access", "A guest account", "An automated system account"], correct: 1 },
            { id: 246, category: "Networking", q: "What is a CDN (Content Delivery Network)?", a: "A distributed network of servers that delivers web content based on user geographic location", choices: ["A central database network", "Geographically distributed servers caching data closer to users", "A computer data network", "A cable distribution node"], correct: 1 },
            { id: 247, category: "Internet", q: "What is VoIP?", a: "Voice over Internet Protocol - technology for delivering voice communications over IP networks", choices: ["Video over Internet Protocol - streams visual media online", "Voice over Internet Protocol - enables phone calls through internet", "Virtual Online Integration Platform - connects cloud services", "Verified Online Identity Protocol - authenticates users securely"], correct: 1 }
        ];

        // Active questions array - switches based on logged-in user
        let questions = [...demoQuestions];

        // Check if user is the owner and switch question sets
        function updateQuestionSet(email) {
            const isOwner = email && email.toLowerCase() === OWNER_EMAIL.toLowerCase();
            const rawLink = document.getElementById('raw-content-link');
            if (isOwner) {
                questions.length = 0;
                wguQuestions.forEach(q => questions.push(q));
                if (rawLink) rawLink.classList.remove('hidden');
            } else {
                questions.length = 0;
                demoQuestions.forEach(q => questions.push(q));
                if (rawLink) rawLink.classList.add('hidden');
            }
            // Reset progress when switching question sets
            state.mastered = [];
            state.answerCounts = {};
            state.totalCorrect = 0;
            state.totalAnswered = 0;
            state.examQuestions = [];
            state.examIndex = 0;
            state.examCorrect = 0;
            // Initialize category filter for new question set
            initCategoryFilter();
        }

        // State management
        let state = {
            mastered: [],
            answerCounts: {},
            totalCorrect: 0,
            totalAnswered: 0,
            currentQuestion: null,
            currentMode: 'menu', // menu, practice, exam
            examQuestions: [],
            examIndex: 0,
            examCorrect: 0,
            claimedKnowledge: false,
            isPro: false,
            licenseKey: null,
            email: null,
            importedQuestionCount: 0
        };

        // Category filter state
        let selectedCategories = new Set();
        let allCategories = [];
        let courseContentCategory = null;

        const VANDROMEDA_API = 'https://www.vandromeda.com/api';
        const FREE_IMPORT_LIMIT = 50;
        const STRIPE_PRICES = {
            monthly: 'price_1SosTEE0LClU4PH9magrG0Bo',
            yearly: 'price_1SosUDE0LClU4PH9ycCWqpQ5'
        };
        let currentKeyword = '';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDC76Oepi1KPfHImPt51kTlgUT3X1iPWTY",
            authDomain: "quizmyself-f7c1b.firebaseapp.com",
            projectId: "quizmyself-f7c1b",
            storageBucket: "quizmyself-f7c1b.firebasestorage.app",
            messagingSenderId: "1038445985794",
            appId: "1:1038445985794:web:550af5efff1020679f671b",
            measurementId: "G-MY6LJ1Y3FS"
        };

        // Initialize Firebase
        let firebaseApp = null;
        let auth = null;
        let currentUser = null;
        let authToken = null;
        let userKeywords = [];

        try {
            firebaseApp = firebase.initializeApp(firebaseConfig);
            auth = firebase.auth();
        } catch (e) {
            console.log('Firebase not configured yet');
        }

        // ========== AUTH FUNCTIONS ==========

        async function getAuthToken() {
            if (currentUser) {
                try {
                    authToken = await currentUser.getIdToken();
                    return authToken;
                } catch (e) {
                    console.error('Failed to get auth token:', e);
                    return null;
                }
            }
            return null;
        }

        function showAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('auth-login-form').style.display = tab === 'login' ? 'block' : 'none';
            document.getElementById('auth-register-form').style.display = tab === 'register' ? 'block' : 'none';
            document.getElementById('auth-forgot-form').style.display = 'none';
            document.getElementById('auth-error').style.display = 'none';
        }

        function showAuthError(message) {
            const el = document.getElementById('auth-error');
            el.textContent = message;
            el.style.display = 'block';
        }

        async function handleLogin() {
            if (!auth) {
                showAuthError('Auth not configured. Use keyword access.');
                return;
            }
            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value;

            if (!email || !password) {
                showAuthError('Please enter email and password');
                return;
            }

            try {
                await auth.signInWithEmailAndPassword(email, password);
                document.getElementById('hamburger-dropdown').classList.remove('show');
                document.getElementById('login-email').value = '';
                document.getElementById('login-password').value = '';
            } catch (error) {
                showAuthError(error.message);
            }
        }

        async function handleRegister() {
            if (!auth) {
                showAuthError('Auth not configured. Use keyword access.');
                return;
            }
            const email = document.getElementById('register-email').value.trim();
            const password = document.getElementById('register-password').value;
            const confirm = document.getElementById('register-confirm').value;

            if (!email || !password) {
                showAuthError('Please fill in all fields');
                return;
            }

            if (password !== confirm) {
                showAuthError('Passwords do not match');
                return;
            }

            if (password.length < 6) {
                showAuthError('Password must be at least 6 characters');
                return;
            }

            try {
                await auth.createUserWithEmailAndPassword(email, password);
                document.getElementById('hamburger-dropdown').classList.remove('show');
                document.getElementById('register-email').value = '';
                document.getElementById('register-password').value = '';
                document.getElementById('register-confirm').value = '';
            } catch (error) {
                showAuthError(error.message);
            }
        }

        function showForgotPassword() {
            document.getElementById('auth-login-form').style.display = 'none';
            document.getElementById('auth-forgot-form').style.display = 'block';
            document.getElementById('auth-error').style.display = 'none';
        }

        function hideForgotPassword() {
            document.getElementById('auth-forgot-form').style.display = 'none';
            document.getElementById('auth-login-form').style.display = 'block';
            document.getElementById('auth-error').style.display = 'none';
        }

        async function handleForgotPassword() {
            const email = document.getElementById('forgot-email').value.trim();

            if (!email) {
                showAuthError('Please enter your email');
                return;
            }

            try {
                const response = await fetch(`${VANDROMEDA_API}/auth/password-reset.php`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, product: 'quizmyself' })
                });

                const data = await response.json();

                if (data.success) {
                    document.getElementById('forgot-email').value = '';
                    showAuthError('Password reset email sent! Check your inbox.');
                    document.getElementById('auth-error').style.color = '#4caf50';
                } else {
                    document.getElementById('auth-error').style.color = '#ff5252';
                    showAuthError(data.error || 'Failed to send reset email');
                }
            } catch (error) {
                document.getElementById('auth-error').style.color = '#ff5252';
                showAuthError('Network error. Please try again.');
            }
        }

        async function handleSignOut() {
            // Always try to sign out from Firebase
            if (auth) {
                try {
                    await auth.signOut();
                } catch (e) {
                    console.error('Sign out error:', e);
                }
            }
            // Clear all local state
            currentUser = null;
            authToken = null;
            userKeywords = [];
            currentKeyword = '';
            state.isPro = false;
            state.licenseKey = null;
            state.email = null;
            // Clear all localStorage items
            localStorage.removeItem('quizmyself_keyword');
            localStorage.removeItem('quizmyself_active_keyword');
            document.getElementById('stats-bar').style.display = 'none';
            document.getElementById('hamburger-dropdown').classList.remove('show');
            updateHamburgerMenu();
            updateProUI();
            showScreen('menu-screen');
        }

        // Auth state listener
        if (auth) {
            auth.onAuthStateChanged(async (user) => {
                currentUser = user;
                if (user) {
                    authToken = await user.getIdToken();
                    state.email = user.email;

                    // Switch question set based on user (owner gets full content)
                    updateQuestionSet(user.email);
                    updateStats();

                    // Load user's keywords from server
                    await loadUserKeywords();

                    // Check for payment success (user returning from Stripe)
                    const urlParams = new URLSearchParams(window.location.search);
                    let licenseJustCaptured = false;
                    if (urlParams.get('payment') === 'success') {
                        const sessionId = urlParams.get('session_id');
                        // Clean up URL
                        window.history.replaceState({}, document.title, window.location.pathname);
                        if (sessionId) {
                            licenseJustCaptured = await fetchLicenseFromSession(sessionId);
                        }
                    }

                    // Check license status (tied to account) - skip if we just captured a license
                    // to avoid overwriting the freshly captured license with potentially stale account data
                    if (!licenseJustCaptured) {
                        await checkProStatusForAccount();
                    }

                    // Restore last active keyword
                    const lastKeyword = localStorage.getItem('quizmyself_active_keyword');
                    if (lastKeyword && userKeywords.find(k => k.keyword === lastKeyword)) {
                        await selectKeyword(lastKeyword);
                    } else if (userKeywords.length > 0) {
                        await selectKeyword(userKeywords[0].keyword);
                    }

                    updateHamburgerMenu();
                    document.getElementById('stats-bar').style.display = currentKeyword ? 'flex' : 'none';
                } else {
                    // Not signed in - show demo questions
                    updateQuestionSet(null);
                    updateStats();

                    // Check for payment success for keyword-only users
                    const urlParams = new URLSearchParams(window.location.search);
                    if (urlParams.get('payment') === 'success') {
                        const sessionId = urlParams.get('session_id');
                        // Clean up URL
                        window.history.replaceState({}, document.title, window.location.pathname);
                        if (sessionId && currentKeyword) {
                            await fetchLicenseFromSession(sessionId);
                        } else if (sessionId) {
                            // No keyword yet - show modal with pending status
                            showUpgradeModal({ pendingSessionId: sessionId });
                        }
                    }
                    updateHamburgerMenu();
                }
            });
        }

        // Initialize category filter on page load (for demo questions)
        initCategoryFilter();

        // ========== KEYWORD MANAGEMENT ==========

        async function loadUserKeywords() {
            if (!currentUser) return;

            try {
                const token = await getAuthToken();
                const response = await fetch(`${VANDROMEDA_API}/quizmyself/keywords.php`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (response.ok) {
                    const data = await response.json();
                    userKeywords = data.keywords || [];
                }
            } catch (error) {
                console.error('Failed to load keywords:', error);
            }
        }

        async function selectKeyword(keyword) {
            currentKeyword = keyword;
            localStorage.setItem('quizmyself_active_keyword', keyword);

            // Load progress for this keyword
            await loadState();

            // Update UI
            document.getElementById('menu-keyword').textContent = keyword;
            document.getElementById('stats-bar').style.display = 'flex';
            updateStats();
            updateHamburgerMenu();
        }

        async function addKeywordToAccount(keyword) {
            if (!currentUser) return { success: false, error: 'Not signed in' };

            try {
                const token = await getAuthToken();
                const response = await fetch(`${VANDROMEDA_API}/quizmyself/add-keyword.php`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ keyword })
                });

                const data = await response.json();

                if (data.success) {
                    await loadUserKeywords();
                    await selectKeyword(keyword);
                }

                return data;
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        async function deleteKeywordFromAccount(keyword) {
            if (!currentUser) return { success: false, error: 'Not signed in' };

            try {
                const token = await getAuthToken();
                const response = await fetch(`${VANDROMEDA_API}/quizmyself/delete-keyword.php`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ keyword })
                });

                const data = await response.json();

                if (data.success) {
                    await loadUserKeywords();

                    if (currentKeyword === keyword) {
                        if (userKeywords.length > 0) {
                            await selectKeyword(userKeywords[0].keyword);
                        } else {
                            currentKeyword = '';
                            document.getElementById('stats-bar').style.display = 'none';
                            updateHamburgerMenu();
                        }
                    }
                }

                return data;
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        async function claimKeyword(keyword) {
            if (!currentUser) return { success: false, error: 'Not signed in' };

            try {
                const token = await getAuthToken();
                const response = await fetch(`${VANDROMEDA_API}/quizmyself/claim-keyword.php`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ keyword })
                });

                const data = await response.json();

                if (data.success) {
                    await loadUserKeywords();
                    await selectKeyword(keyword);
                }

                return data;
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        async function checkProStatusForAccount() {
            if (!currentUser) {
                state.isPro = false;
                state.licenseKey = null;
                updateProUI();
                return;
            }

            try {
                const token = await getAuthToken();
                const response = await fetch(`${VANDROMEDA_API}/quizmyself/account.php`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.license && data.license.status === 'active') {
                        state.isPro = true;
                        state.licenseKey = data.license.license_key;
                    } else {
                        state.isPro = false;
                        state.licenseKey = null;
                    }
                }
            } catch (error) {
                console.error('Pro status check failed:', error);
            }

            updateProUI();
        }

        // ========== KEYWORD MODAL ==========

        function showKeywordManager() {
            document.getElementById('keyword-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            renderKeywordList();
            document.getElementById('hamburger-dropdown').classList.remove('show');
        }

        function closeKeywordModal() {
            document.getElementById('keyword-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        function renderKeywordList() {
            const list = document.getElementById('keyword-list');

            if (userKeywords.length === 0) {
                list.innerHTML = '<p style="color: #888; text-align: center; padding: 20px;">No keywords yet. Add one above.</p>';
                return;
            }

            list.innerHTML = userKeywords.map(kw => `
                <div class="keyword-item">
                    <div class="keyword-item-info">
                        <div class="keyword-item-name ${currentKeyword === kw.keyword ? 'active' : ''}">${kw.keyword}</div>
                        <div class="keyword-item-date">
                            ${kw.question_count > 0 ? `<span style="color: #4fc3f7;">${kw.question_count} questions</span>` : '<span style="color: #666;">No questions</span>'}
                            ${kw.source_count > 0 ? ` | <span style="color: #888;">${kw.source_count} source${kw.source_count > 1 ? 's' : ''}</span>` : ''}
                            | ${new Date(kw.created_at).toLocaleDateString()}${kw.is_migrated ? ' (Claimed)' : ''}
                        </div>
                    </div>
                    <div class="keyword-item-actions">
                        ${currentKeyword !== kw.keyword ?
                            `<button class="btn btn-small btn-primary" onclick="selectKeyword('${kw.keyword}'); renderKeywordList();">Use</button>` :
                            '<span style="color: #4fc3f7; font-size: 0.8rem; padding: 5px 10px;">Active</span>'}
                        <button class="btn btn-small btn-danger" onclick="confirmDeleteKeyword('${kw.keyword}')">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        async function handleAddKeyword() {
            const input = document.getElementById('new-keyword-input');
            const keyword = input.value.trim().toLowerCase().replace(/[^a-z0-9-]/g, '');

            if (!keyword || keyword.length < 3) {
                showKeywordModalMessage('Keyword must be at least 3 characters', 'error');
                return;
            }

            const result = await addKeywordToAccount(keyword);

            if (result.success) {
                input.value = '';
                renderKeywordList();
                showKeywordModalMessage('Keyword added!', 'success');
            } else {
                showKeywordModalMessage(result.message || result.error || 'Failed to add keyword', 'error');
            }
        }

        async function handleClaimKeyword() {
            const input = document.getElementById('claim-keyword-input');
            const keyword = input.value.trim().toLowerCase().replace(/[^a-z0-9-]/g, '');

            if (!keyword) {
                showKeywordModalMessage('Enter a keyword to claim', 'error');
                return;
            }

            const result = await claimKeyword(keyword);

            if (result.success) {
                input.value = '';
                renderKeywordList();
                showKeywordModalMessage('Keyword claimed! Your progress has been linked.', 'success');
            } else {
                showKeywordModalMessage(result.message || result.error || 'Failed to claim keyword', 'error');
            }
        }

        async function confirmDeleteKeyword(keyword) {
            if (!confirm(`Delete keyword "${keyword}"? Your progress will remain but can be claimed by others.`)) {
                return;
            }

            const result = await deleteKeywordFromAccount(keyword);

            if (result.success) {
                renderKeywordList();
                showKeywordModalMessage('Keyword deleted', 'success');
            } else {
                showKeywordModalMessage(result.message || result.error || 'Failed to delete keyword', 'error');
            }
        }

        function showKeywordModalMessage(message, type) {
            const el = document.getElementById('keyword-modal-message');
            el.textContent = message;
            el.style.display = 'block';
            el.style.background = type === 'success' ? 'rgba(39, 174, 96, 0.2)' : 'rgba(233, 69, 96, 0.2)';
            el.style.color = type === 'success' ? '#27ae60' : '#e94560';
            setTimeout(() => el.style.display = 'none', 3000);
        }

        // Hamburger menu functions
        function toggleHamburgerMenu() {
            const dropdown = document.getElementById('hamburger-dropdown');
            dropdown.classList.toggle('show');
        }

        function openHamburgerMenu() {
            const dropdown = document.getElementById('hamburger-dropdown');
            dropdown.classList.add('show');
        }

        function updateHamburgerMenu() {
            const signinSection = document.getElementById('menu-signin-section');
            const accountSection = document.getElementById('menu-account-section');
            const keywordEl = document.getElementById('menu-keyword');
            const emailSection = document.getElementById('menu-email-section');
            const emailEl = document.getElementById('menu-email');
            const licenseStatusEl = document.getElementById('menu-license-status');
            const manageKeywordsBtn = document.getElementById('manage-keywords-btn');
            const upgradeBtn = document.getElementById('menu-upgrade-btn');

            // Check if user is signed in with Firebase or using keyword-only mode
            const isSignedInWithFirebase = currentUser !== null;
            const hasKeyword = currentKeyword && currentKeyword.length > 0;

            if (isSignedInWithFirebase || hasKeyword) {
                // Signed in - show account section
                signinSection.style.display = 'none';
                accountSection.style.display = 'block';

                // Show keyword if set
                if (hasKeyword) {
                    keywordEl.textContent = currentKeyword;
                } else {
                    keywordEl.textContent = 'No keyword selected';
                }

                // Show email if Firebase user
                if (isSignedInWithFirebase && currentUser.email) {
                    emailSection.style.display = 'block';
                    emailEl.textContent = currentUser.email;
                    // Show manage keywords button for Firebase users
                    if (manageKeywordsBtn) {
                        manageKeywordsBtn.style.display = 'block';
                    }
                } else {
                    emailSection.style.display = 'none';
                    // Hide manage keywords for keyword-only users
                    if (manageKeywordsBtn) {
                        manageKeywordsBtn.style.display = 'none';
                    }
                }

                // Show license status and upgrade button
                if (state.isPro && state.licenseKey) {
                    licenseStatusEl.innerHTML = '<span style="color: #ffd700;">PRO</span> - ' + state.licenseKey;
                    if (upgradeBtn) upgradeBtn.style.display = 'none';
                } else {
                    licenseStatusEl.textContent = 'Free Account';
                    if (upgradeBtn) upgradeBtn.style.display = 'block';
                }
            } else {
                // Signed out - show signin section
                signinSection.style.display = 'block';
                accountSection.style.display = 'none';
            }
        }

        async function submitKeywordFromMenu() {
            const input = document.getElementById('menu-keyword-input');
            const keyword = input.value.trim();

            if (!keyword) {
                return;
            }

            currentKeyword = keyword;
            localStorage.setItem('quizmyself_keyword', keyword);

            // Load progress for this keyword
            await loadState();

            // Check pro status for this keyword
            await checkProStatus();

            // Show stats bar
            document.getElementById('stats-bar').style.display = 'flex';

            // Update hamburger menu and close dropdown
            updateHamburgerMenu();
            document.getElementById('hamburger-dropdown').classList.remove('show');

            input.value = '';
        }

        async function signOut() {
            // Sign out from Firebase if signed in
            if (currentUser) {
                try {
                    await firebase.auth().signOut();
                } catch (e) {
                    console.error('Firebase sign out error:', e);
                }
            }

            // Clear saved keyword
            localStorage.removeItem('quizmyself_keyword');
            localStorage.removeItem('quizmyself_active_keyword');

            currentKeyword = '';
            currentUser = null;
            userKeywords = [];
            state.mastered = [];
            state.answerCounts = {};
            state.totalCorrect = 0;
            state.totalAnswered = 0;
            state.examQuestions = [];
            state.examIndex = 0;
            state.examCorrect = 0;
            state.isPro = false;
            state.licenseKey = null;
            state.email = null;

            document.getElementById('stats-bar').style.display = 'none';
            updateStats();
            updateResumeExamButton(false);
            updateHamburgerMenu();
            updateProUI();

            // Close dropdown
            document.getElementById('hamburger-dropdown').classList.remove('show');

            // Go back to menu if on another screen
            showScreen('menu-screen');
        }

        // Close hamburger menu when clicking outside
        document.addEventListener('click', function(e) {
            const menu = document.getElementById('hamburger-menu');
            const statusBtn = document.getElementById('top-bar-status');
            if (menu && !menu.contains(e.target) && !statusBtn.contains(e.target)) {
                document.getElementById('hamburger-dropdown').classList.remove('show');
            }
        });

        // Load state from server
        async function loadState() {
            if (!currentKeyword) return;
            try {
                const res = await fetch(`${VANDROMEDA_API}/quizmyself/progress.php?keyword=${encodeURIComponent(currentKeyword)}`);
                if (res.ok) {
                    const data = await res.json();
                    state.mastered = data.mastered || [];
                    state.answerCounts = data.answerCounts || {};
                    state.totalCorrect = data.totalCorrect || 0;
                    state.totalAnswered = data.totalAnswered || 0;

                    // Load custom questions for this keyword (if any exist)
                    const customQuestions = data.customQuestions || [];
                    if (customQuestions.length > 0) {
                        // Replace questions array with custom questions from DB
                        questions.length = 0;
                        customQuestions.forEach(q => questions.push(q));
                        state.importedQuestionCount = customQuestions.length;
                        console.log(`Loaded ${customQuestions.length} custom questions for keyword: ${currentKeyword}`);
                    }
                    // If no custom questions, leave questions array as-is (could be wguQuestions or demoQuestions)

                    // Restore exam progress if exists
                    if (data.examInProgress && data.examQuestionIds && data.examQuestionIds.length > 0) {
                        // Rebuild examQuestions from IDs
                        state.examQuestions = data.examQuestionIds.map(id => questions.find(q => q.id === id)).filter(q => q);
                        state.examIndex = data.examIndex || 0;
                        state.examCorrect = data.examCorrect || 0;
                        // Show resume button
                        updateResumeExamButton(true);
                    } else {
                        state.examQuestions = [];
                        state.examIndex = 0;
                        state.examCorrect = 0;
                        updateResumeExamButton(false);
                    }
                }
            } catch (e) {
                console.log('Could not load from server');
            }
            updateStats();
        }

        // Update resume exam button visibility
        function updateResumeExamButton(show) {
            const btn = document.getElementById('resume-exam-btn');
            if (btn) {
                if (show && state.examQuestions.length > 0 && state.examIndex < state.examQuestions.length) {
                    btn.classList.remove('hidden');
                    btn.textContent = `Resume Exam (${state.examIndex}/${state.examQuestions.length})`;
                } else {
                    btn.classList.add('hidden');
                }
            }
        }

        // Save state to server
        let saveTimeout = null;
        function saveState(immediate = false) {
            if (!currentKeyword) return;
            clearTimeout(saveTimeout);

            const doSave = async () => {
                try {
                    const payload = {
                        mastered: state.mastered,
                        answerCounts: state.answerCounts,
                        totalCorrect: state.totalCorrect,
                        totalAnswered: state.totalAnswered
                    };

                    // Save custom questions if we have imported ones
                    if (state.importedQuestionCount > 0) {
                        payload.customQuestions = questions;
                    }

                    // Save exam progress if in exam mode
                    if (state.currentMode === 'exam' && state.examQuestions.length > 0) {
                        payload.examInProgress = true;
                        payload.examQuestionIds = state.examQuestions.map(q => q.id);
                        payload.examIndex = state.examIndex;
                        payload.examCorrect = state.examCorrect;
                    } else {
                        payload.examInProgress = false;
                    }
                    await fetch(`${VANDROMEDA_API}/quizmyself/progress.php?keyword=${encodeURIComponent(currentKeyword)}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                } catch (e) {
                    console.log('Could not save to server');
                }
            };

            if (immediate) {
                doSave();
            } else {
                saveTimeout = setTimeout(doSave, 500);
            }
        }

        // Update stats display
        function updateStats() {
            const filteredQuestions = getFilteredQuestions();
            document.getElementById('total-count').textContent = filteredQuestions.length;
            const masteredInFilter = state.mastered.filter(id => filteredQuestions.some(q => q.id === id));
            document.getElementById('mastered-count').textContent = masteredInFilter.length;
            document.getElementById('remaining-count').textContent = filteredQuestions.length - masteredInFilter.length;
            const accuracy = state.totalAnswered > 0
                ? Math.round((state.totalCorrect / state.totalAnswered) * 100)
                : 0;
            document.getElementById('accuracy').textContent = accuracy + '%';
        }

        // Get filtered questions based on selected categories
        function getFilteredQuestions() {
            if (selectedCategories.size === 0 || selectedCategories.size === allCategories.length) {
                return questions;
            }
            return questions.filter(q => selectedCategories.has(q.category));
        }

        // Initialize category filter
        function initCategoryFilter() {
            // Get unique categories from questions
            const categories = [...new Set(questions.map(q => q.category))];
            allCategories = categories;

            // Default: all categories selected
            selectedCategories = new Set(categories);

            // Render category chips
            renderCategoryChips();
        }

        // Render category chips
        function renderCategoryChips() {
            const container = document.getElementById('category-chips');
            if (!container) return;

            container.innerHTML = allCategories.map(cat => {
                const isActive = selectedCategories.has(cat);
                const count = questions.filter(q => q.category === cat).length;
                return `<button class="category-chip ${isActive ? 'active' : ''}"
                    onclick="toggleCategory('${cat}')">${cat} (${count})</button>`;
            }).join('');
        }

        // Toggle category selection
        function toggleCategory(category) {
            if (selectedCategories.has(category)) {
                selectedCategories.delete(category);
            } else {
                selectedCategories.add(category);
            }
            renderCategoryChips();
            updateStats();
        }

        // Select all categories
        function selectAllCategories() {
            selectedCategories = new Set(allCategories);
            renderCategoryChips();
            updateStats();
        }

        // Clear all categories
        function clearAllCategories() {
            selectedCategories.clear();
            renderCategoryChips();
            updateStats();
        }

        // Show course content (study material from quiz questions)
        function showCourseContent() {
            // Initialize course content category filter
            renderCourseCategoryChips();
            renderCourseContent();
            showScreen('course-content-screen');
        }

        // Render category chips for course content screen
        function renderCourseCategoryChips() {
            const container = document.getElementById('course-category-chips');
            if (!container) return;

            // If no category selected for course content, show all
            const showAll = courseContentCategory === null;

            container.innerHTML = `<button class="category-chip ${showAll ? 'active' : ''}"
                onclick="filterCourseContent(null)">All</button>` +
                allCategories.map(cat => {
                    const isActive = courseContentCategory === cat;
                    const count = questions.filter(q => q.category === cat).length;
                    return `<button class="category-chip ${isActive ? 'active' : ''}"
                        onclick="filterCourseContent('${cat}')">${cat} (${count})</button>`;
                }).join('');
        }

        // Filter course content by category
        function filterCourseContent(category) {
            courseContentCategory = category;
            renderCourseCategoryChips();
            renderCourseContent();
        }

        // Render course content items
        function renderCourseContent() {
            const container = document.getElementById('course-content-list');
            if (!container) return;

            let filteredQuestions = questions;
            if (courseContentCategory !== null) {
                filteredQuestions = questions.filter(q => q.category === courseContentCategory);
            }

            if (filteredQuestions.length === 0) {
                container.innerHTML = '<p style="color: #888; text-align: center;">No content available for the selected category.</p>';
                return;
            }

            container.innerHTML = filteredQuestions.map((q, index) => `
                <div class="course-item">
                    <span class="course-item-category">${q.category}</span>
                    <div class="course-item-question">${index + 1}. ${q.q}</div>
                    <div class="course-item-answer">${q.a}</div>
                </div>
            `).join('');
        }

        // Show/hide screens
        function showScreen(screenId) {
            ['menu-screen', 'quiz-screen', 'exam-screen', 'result-screen', 'progress-screen', 'mastered-screen', 'course-content-screen'].forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        // Back to menu
        function backToMenu() {
            state.currentMode = 'menu';
            showScreen('menu-screen');
            updateStats();
        }

        // Get random unmastered question from filtered set
        function getRandomQuestion() {
            const filteredQuestions = getFilteredQuestions();
            const unmastered = filteredQuestions.filter(q => !state.mastered.includes(q.id));
            if (unmastered.length === 0) return null;
            return unmastered[Math.floor(Math.random() * unmastered.length)];
        }

        // Start practice mode
        function startPractice() {
            const filteredQuestions = getFilteredQuestions();
            if (filteredQuestions.length === 0) {
                alert('No questions available. Select at least one category or import some questions!');
                return;
            }
            state.currentMode = 'practice';
            showScreen('quiz-screen');
            loadNextQuestion();
        }

        // Load next question
        function loadNextQuestion() {
            const filteredQuestions = getFilteredQuestions();
            state.currentQuestion = getRandomQuestion();
            state.claimedKnowledge = false;

            // If all mastered in filtered set, practice from all filtered questions (review mode)
            if (!state.currentQuestion && filteredQuestions.length > 0) {
                state.currentQuestion = filteredQuestions[Math.floor(Math.random() * filteredQuestions.length)];
            }

            if (!state.currentQuestion) {
                alert('No questions available!');
                backToMenu();
                return;
            }

            const q = state.currentQuestion;
            const remaining = questions.filter(qn => !state.mastered.includes(qn.id)).length;

            document.getElementById('question-counter').textContent = `${remaining} questions remaining`;
            document.getElementById('category-badge').textContent = q.category;
            document.getElementById('question-text').textContent = q.q;

            // Show answer count
            const count = state.answerCounts[q.id] || 0;
            const countEl = document.getElementById('streak-indicator');
            if (count > 0) {
                countEl.textContent = `Seen ${count}x`;
                countEl.classList.remove('hidden');
            } else {
                countEl.classList.add('hidden');
            }

            // Show choices immediately
            document.getElementById('practice-next-btn').classList.add('hidden');
            renderChoices();
        }

        // Shuffle array helper
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Render multiple choice
        function renderChoices() {
            const q = state.currentQuestion;
            const container = document.getElementById('choices-container');
            container.innerHTML = '';

            // Create array with original indices and shuffle
            const choicesWithIndices = q.choices.map((choice, index) => ({ choice, originalIndex: index }));
            const shuffled = shuffleArray(choicesWithIndices);
            state.shuffledChoices = shuffled;

            shuffled.forEach((item, index) => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.textContent = item.choice;
                btn.onclick = () => selectChoice(index);
                container.appendChild(btn);
            });
        }

        // Select choice
        function selectChoice(index) {
            const q = state.currentQuestion;
            const buttons = document.querySelectorAll('#choices-container .choice-btn');
            const shuffled = state.shuffledChoices;

            // Find which shuffled index contains the correct answer
            const correctShuffledIndex = shuffled.findIndex(item => item.originalIndex === q.correct);

            buttons.forEach((btn, i) => {
                btn.classList.add('disabled');
                if (i === correctShuffledIndex) {
                    btn.classList.add('correct');
                } else if (i === index && index !== correctShuffledIndex) {
                    btn.classList.add('incorrect');
                }
            });

            // Store whether the answer was correct and show Next button
            state.lastAnswerCorrect = index === correctShuffledIndex;
            document.getElementById('practice-next-btn').classList.remove('hidden');
        }

        // Proceed to next question after reviewing answer
        function proceedToNextQuestion() {
            document.getElementById('practice-next-btn').classList.add('hidden');
            recordAnswer(state.lastAnswerCorrect);
        }

        // Record answer
        function recordAnswer(correct) {
            const q = state.currentQuestion;

            state.totalAnswered++;
            state.answerCounts[q.id] = (state.answerCounts[q.id] || 0) + 1;
            if (correct) {
                state.totalCorrect++;
            }

            saveState();
            updateStats();
            loadNextQuestion();
        }

        // Mark as always know
        function markAlwaysKnow() {
            if (state.currentQuestion) {
                const q = state.currentQuestion;
                if (!state.mastered.includes(q.id)) {
                    state.mastered.push(q.id);
                    state.totalAnswered++;
                    state.totalCorrect++;
                    saveState();
                    updateStats();
                }
                loadNextQuestion();
            }
        }

        // Start final exam
        function startFinalExam() {
            // Shuffle all questions using Fisher-Yates
            state.examQuestions = shuffleArray([...questions]);
            state.examIndex = 0;
            state.examCorrect = 0;
            state.currentMode = 'exam';

            showScreen('exam-screen');
            loadExamQuestion();
            saveState(); // Save immediately so exam can be resumed
        }

        // Resume in-progress exam
        function resumeExam() {
            if (state.examQuestions.length === 0 || state.examIndex >= state.examQuestions.length) {
                alert('No exam in progress');
                return;
            }
            state.currentMode = 'exam';
            showScreen('exam-screen');
            loadExamQuestion();
        }

        // Load exam question
        function loadExamQuestion() {
            if (state.examIndex >= state.examQuestions.length) {
                showExamResults();
                return;
            }

            const q = state.examQuestions[state.examIndex];
            const progress = ((state.examIndex) / state.examQuestions.length) * 100;

            document.getElementById('exam-progress').style.width = progress + '%';
            document.getElementById('exam-counter').textContent =
                `Question ${state.examIndex + 1} of ${state.examQuestions.length}`;
            document.getElementById('exam-category').textContent = q.category;
            document.getElementById('exam-question').textContent = q.q;

            // Hide the Next Question button for fresh question
            document.getElementById('exam-next-btn').classList.add('hidden');

            const container = document.getElementById('exam-choices');
            container.innerHTML = '';

            // Shuffle choices for exam
            const choicesWithIndices = q.choices.map((choice, index) => ({ choice, originalIndex: index }));
            const shuffled = shuffleArray(choicesWithIndices);
            state.examShuffledChoices = shuffled;

            shuffled.forEach((item, index) => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.textContent = item.choice;
                btn.onclick = () => selectExamChoice(index);
                container.appendChild(btn);
            });
        }

        // Select exam choice
        function selectExamChoice(index) {
            const q = state.examQuestions[state.examIndex];
            const buttons = document.querySelectorAll('#exam-choices .choice-btn');
            const shuffled = state.examShuffledChoices;

            // Find which shuffled index contains the correct answer
            const correctShuffledIndex = shuffled.findIndex(item => item.originalIndex === q.correct);

            buttons.forEach((btn, i) => {
                btn.classList.add('disabled');
                if (i === correctShuffledIndex) {
                    btn.classList.add('correct');
                } else if (i === index && index !== correctShuffledIndex) {
                    btn.classList.add('incorrect');
                }
            });

            if (index === correctShuffledIndex) {
                state.examCorrect++;
            }

            state.examIndex++;
            saveState(); // Save progress after each answer
            // Show Next Question button instead of auto-advancing
            document.getElementById('exam-next-btn').classList.remove('hidden');
        }

        // Proceed to next exam question after reviewing answer
        function proceedToNextExamQuestion() {
            document.getElementById('exam-next-btn').classList.add('hidden');
            loadExamQuestion();
        }

        // Show exam results
        function showExamResults() {
            const percentage = Math.round((state.examCorrect / state.examQuestions.length) * 100);
            const passed = percentage === 100;

            showScreen('result-screen');
            document.getElementById('result-score').textContent = percentage + '%';
            document.getElementById('result-score').className = 'result-score ' + (passed ? 'pass' : 'fail');

            if (passed) {
                document.getElementById('result-message').innerHTML =
                    '<span class="pass">PERFECT SCORE! You\'re ready for the exam!</span>';
                document.getElementById('retry-btn').classList.add('hidden');
            } else {
                document.getElementById('result-message').innerHTML =
                    `<span class="fail">You got ${state.examCorrect} out of ${state.examQuestions.length} correct.<br>You need 100% to pass. Keep practicing!</span>`;
                document.getElementById('retry-btn').classList.remove('hidden');
            }

            // Clear exam progress since exam is complete
            state.currentMode = 'menu';
            state.examQuestions = [];
            state.examIndex = 0;
            state.examCorrect = 0;
            saveState(); // Clear saved exam progress
            updateResumeExamButton(false);
        }

        // Show progress
        function showProgress() {
            showScreen('progress-screen');

            const categories = {};
            questions.forEach(q => {
                if (!categories[q.category]) {
                    categories[q.category] = { total: 0, mastered: 0 };
                }
                categories[q.category].total++;
                if (state.mastered.includes(q.id)) {
                    categories[q.category].mastered++;
                }
            });

            let html = `
                <div style="margin-bottom: 20px;">
                    <strong>Overall Progress:</strong> ${state.mastered.length} / ${questions.length} mastered (${Math.round((state.mastered.length/questions.length)*100)}%)
                </div>
                <div style="margin-bottom: 20px;">
                    <strong>Accuracy:</strong> ${state.totalAnswered > 0 ? Math.round((state.totalCorrect/state.totalAnswered)*100) : 0}% (${state.totalCorrect}/${state.totalAnswered})
                </div>
                <h3 style="margin: 20px 0 10px;">By Category:</h3>
            `;

            Object.entries(categories).sort((a,b) => a[0].localeCompare(b[0])).forEach(([cat, data]) => {
                const pct = Math.round((data.mastered / data.total) * 100);
                html += `
                    <div style="margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>${cat}</span>
                            <span>${data.mastered}/${data.total} (${pct}%)</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${pct}%"></div>
                        </div>
                    </div>
                `;
            });

            document.getElementById('progress-details').innerHTML = html;
        }

        // Show mastered questions list
        function showMasteredList() {
            showScreen('mastered-screen');

            const masteredQuestions = questions.filter(q => state.mastered.includes(q.id));
            const container = document.getElementById('mastered-list');

            if (masteredQuestions.length === 0) {
                container.innerHTML = '<div class="empty-list-message">No mastered questions yet.</div>';
                return;
            }

            let html = '';
            masteredQuestions.forEach(q => {
                html += `
                    <div class="mastered-item" id="mastered-item-${q.id}">
                        <div class="mastered-item-text">
                            <div class="mastered-item-category">${q.category}</div>
                            ${q.q}
                        </div>
                        <button class="unmaster-btn" onclick="unmasterQuestion(${q.id})">Remove</button>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // Remove a question from mastered list
        function unmasterQuestion(id) {
            const index = state.mastered.indexOf(id);
            if (index > -1) {
                state.mastered.splice(index, 1);
                saveState();
                updateStats();
                // Remove the item from the DOM
                const item = document.getElementById('mastered-item-' + id);
                if (item) {
                    item.remove();
                }
                // Check if list is now empty
                if (state.mastered.length === 0) {
                    document.getElementById('mastered-list').innerHTML = '<div class="empty-list-message">No mastered questions yet.</div>';
                }
            }
        }

        // Reset progress
        function resetProgress() {
            if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                state.mastered = [];
                state.answerCounts = {};
                state.totalCorrect = 0;
                state.totalAnswered = 0;
                state.examQuestions = [];
                state.examIndex = 0;
                state.examCorrect = 0;
                saveState();
                updateStats();
                updateResumeExamButton(false);
                alert('Progress has been reset.');
            }
        }

        // Study Material Content by Category
        const studyMaterials = {
            "IT Roles": `
                <h3>IT Disciplines Overview</h3>
                <ul>
                    <li><span class="key-term">Computer Engineering (CE)</span> - Focuses on design of hardware systems and software that makes them work (drivers, embedded systems)</li>
                    <li><span class="key-term">Computer Science (CS)</span> - Design and implementation of software, solving computing problems (AI, robotics, algorithms)</li>
                    <li><span class="key-term">Software Engineering (SE)</span> - Development and maintenance of reliable, efficient software systems</li>
                    <li><span class="key-term">Information Systems (IS)</span> - Integrating IT solutions to meet business goals</li>
                    <li><span class="key-term">Information Technology (IT)</span> - Technology supporting information systems, practical solutions</li>
                </ul>
                <h3>Administrator Roles</h3>
                <ul>
                    <li><span class="key-term">System Administrator</span> - Technical support for hardware/software, login issues, network vulnerabilities</li>
                    <li><span class="key-term">Network Administrator</span> - Design, plan, setup, and maintain networks</li>
                    <li><span class="key-term">Database Administrator</span> - Install/configure databases, fix errors, create user accounts</li>
                    <li><span class="key-term">Security Administrator</span> - Install and troubleshoot network security</li>
                    <li><span class="key-term">Web Administrator</span> - Troubleshoot websites, analyze usage data, report breaches</li>
                </ul>
                <h3>Architect & Engineer Roles</h3>
                <ul>
                    <li><span class="key-term">Cloud Architect</span> - Oversees cloud computing systems</li>
                    <li><span class="key-term">Network Architect</span> - Designs networks, monitors traffic, installs routers/modems</li>
                    <li><span class="key-term">Cybersecurity Architect</span> - Designs, builds, tests security systems</li>
                    <li><span class="key-term">Machine Learning Engineer</span> - Uses Python, R, Java with ML frameworks</li>
                    <li><span class="key-term">Software Engineer</span> - Develops OS, database systems, embedded systems</li>
                </ul>
                <h3>Analyst & Support Roles</h3>
                <ul>
                    <li><span class="key-term">Systems Analyst</span> - Investigates business problems, creates IS solutions</li>
                    <li><span class="key-term">Data Analyst</span> - Uses statistics for organizational decision-making</li>
                    <li><span class="key-term">Security Analyst</span> - Monitors networks for security breaches</li>
                    <li><span class="key-term">Computer Support Specialist</span> - Supports and maintains workplace technology</li>
                    <li><span class="key-term">Project Manager</span> - Organizes people, time, resources to meet requirements on time/budget</li>
                </ul>`,
            "Data & Information": `
                <h3>DIKW Pyramid (Bottom to Top)</h3>
                <ul>
                    <li><span class="key-term">Data</span> - Raw facts or observations with no context</li>
                    <li><span class="key-term">Information</span> - Data given context that makes it meaningful</li>
                    <li><span class="key-term">Knowledge</span> - Combination of experience, values, contextual information, expert insight</li>
                    <li><span class="key-term">Wisdom</span> - Knowing the right thing to do</li>
                </ul>
                <h3>Data Types</h3>
                <ul>
                    <li><span class="key-term">Structured Data</span> - Easily converted for analysis (names, dates, phone numbers)</li>
                    <li><span class="key-term">Unstructured Data</span> - Complex, not easily decoded (text, videos, audio)</li>
                    <li><span class="key-term">Big Data</span> - Large collections requiring advanced analytical tools</li>
                </ul>
                <h3>Data Quality</h3>
                <ul>
                    <li><span class="key-term">Data Hygiene</span> - Processes ensuring data is error-free</li>
                    <li><span class="key-term">Data Scrubbing</span> - Amending/removing incorrect, incomplete, or duplicate data</li>
                    <li><span class="key-term">Five Quality Attributes</span> - Precise, Valid, Reliable, Timely, Complete</li>
                </ul>
                <h3>Cloud Service Models</h3>
                <ul>
                    <li><span class="key-term">IaaS</span> - Infrastructure as a Service (virtual servers, network connections)</li>
                    <li><span class="key-term">PaaS</span> - Platform as a Service (web application development platform)</li>
                    <li><span class="key-term">SaaS</span> - Software as a Service (Gmail, Office 365 - subscription based)</li>
                </ul>
                <p><span class="key-term">PII (Personally Identifiable Information)</span> - SSN, names, phone numbers that could identify someone</p>`,
            "Hardware": `
                <h3>IPOS - Four Functions of a Computer</h3>
                <ul>
                    <li><span class="key-term">Input</span> - Data entered into the system</li>
                    <li><span class="key-term">Process</span> - CPU executes instructions</li>
                    <li><span class="key-term">Output</span> - Processed information produced</li>
                    <li><span class="key-term">Storage</span> - Data saved for later use</li>
                </ul>
                <h3>CPU Components</h3>
                <ul>
                    <li><span class="key-term">ALU (Arithmetic Logic Unit)</span> - Performs calculations</li>
                    <li><span class="key-term">Control Unit</span> - Directs operations</li>
                    <li><span class="key-term">Processor Registers</span> - Temporary storage</li>
                </ul>
                <h3>Memory Types</h3>
                <ul>
                    <li><span class="key-term">RAM</span> - Random Access Memory, volatile (loses data when powered off)</li>
                    <li><span class="key-term">ROM</span> - Read Only Memory, non-volatile (retains data)</li>
                    <li><span class="key-term">Cache</span> - Fast temporary storage</li>
                </ul>
                <h3>Storage</h3>
                <ul>
                    <li><span class="key-term">HDD</span> - Hard Disk Drive, magnetic spinning platters</li>
                    <li><span class="key-term">SSD</span> - Solid State Drive, flash memory, no moving parts, faster</li>
                </ul>
                <h3>Data Measurement</h3>
                <ul>
                    <li><span class="key-term">Bit</span> - Smallest unit (0 or 1)</li>
                    <li><span class="key-term">Byte</span> - 8 bits (one character)</li>
                    <li><span class="key-term">Kilobyte (KB)</span> - 1,024 bytes</li>
                    <li><span class="key-term">Megabyte (MB)</span> - 1,024 KB</li>
                    <li><span class="key-term">Gigabyte (GB)</span> - 1,024 MB</li>
                </ul>
                <h3>Computer Generations</h3>
                <ul>
                    <li><span class="key-term">1st Gen (1946-1959)</span> - Vacuum tubes, magnetic drums</li>
                    <li><span class="key-term">2nd Gen (1959-1965)</span> - Transistors</li>
                    <li><span class="key-term">3rd Gen (1965-1971)</span> - Integrated circuits on silicon chips</li>
                    <li><span class="key-term">4th Gen (1971-present)</span> - Microprocessors</li>
                </ul>`,
            "Networking": `
                <h3>Network Types by Size</h3>
                <ul>
                    <li><span class="key-term">PAN</span> - Personal Area Network (few feet, like Bluetooth)</li>
                    <li><span class="key-term">LAN</span> - Local Area Network (single building)</li>
                    <li><span class="key-term">WAN</span> - Wide Area Network (cities, states, worldwide - Internet is largest)</li>
                </ul>
                <h3>Network Topologies</h3>
                <ul>
                    <li><span class="key-term">Bus</span> - Machines connected to a common line</li>
                    <li><span class="key-term">Star</span> - Central machine connects all others</li>
                    <li><span class="key-term">Ring</span> - Devices in circular arrangement as peers</li>
                    <li><span class="key-term">Mesh</span> - Every device connected to every other (redundancy)</li>
                </ul>
                <h3>Network Models</h3>
                <ul>
                    <li><span class="key-term">Client/Server</span> - Clients request, servers satisfy requests</li>
                    <li><span class="key-term">Peer-to-Peer (P2P)</span> - Processes both request and provide services</li>
                </ul>
                <h3>Cabling</h3>
                <ul>
                    <li><span class="key-term">Twisted Pair</span> - Two copper wires wound together, max 100m, CAT5e for 1Gbps</li>
                    <li><span class="key-term">Fiber Optic</span> - Light through glass/plastic, 26,000x bandwidth of twisted pair</li>
                </ul>
                <h3>Network Devices</h3>
                <ul>
                    <li><span class="key-term">Repeater</span> - Extends range by boosting signal</li>
                    <li><span class="key-term">Bridge</span> - Connects different network types intelligently</li>
                    <li><span class="key-term">Switch</span> - Reduces traffic by sending to destination only</li>
                    <li><span class="key-term">Router</span> - Forwards messages between networks using routing tables</li>
                    <li><span class="key-term">Modem</span> - Converts analog to digital signals</li>
                </ul>
                <h3>ISP Tiers</h3>
                <ul>
                    <li><span class="key-term">Tier 1</span> - Backbone providers</li>
                    <li><span class="key-term">Tier 2</span> - Regional providers</li>
                    <li><span class="key-term">Tier 3</span> - Access ISPs (homes/businesses)</li>
                </ul>`,
            "Internet": `
                <h3>Key Protocols & Systems</h3>
                <ul>
                    <li><span class="key-term">TCP/IP</span> - Most popular network protocol</li>
                    <li><span class="key-term">DNS</span> - Domain Name System, translates domain names to IP addresses</li>
                    <li><span class="key-term">HTTP</span> - HyperText Transfer Protocol</li>
                    <li><span class="key-term">VoIP</span> - Voice over Internet Protocol</li>
                </ul>
                <h3>IP Addresses</h3>
                <ul>
                    <li><span class="key-term">IPv4</span> - 32-bit, dotted decimal notation (192.207.177.103)</li>
                    <li><span class="key-term">IPv6</span> - 128-bit addresses</li>
                </ul>
                <h3>Web Concepts</h3>
                <ul>
                    <li><span class="key-term">URL</span> - Uniform Resource Locator (unique web address)</li>
                    <li><span class="key-term">HTML</span> - HyperText Markup Language (encodes web documents)</li>
                    <li><span class="key-term">Streaming</span> - Audio/video transport in near real-time</li>
                </ul>
                <h3>Domain TLDs</h3>
                <ul>
                    <li><span class="key-term">.edu</span> - Educational institution</li>
                    <li><span class="key-term">.gov</span> - Government agency</li>
                    <li><span class="key-term">.com</span> - Commercial</li>
                    <li><span class="key-term">.org</span> - Organization</li>
                </ul>
                <p><span class="key-term">Tim Berners-Lee</span> invented the World Wide Web in the late 1980s</p>
                <p><span class="key-term">ICANN</span> coordinates internet operations and awards IP address blocks</p>`,
            "Security": `
                <h3>Types of Malware</h3>
                <ul>
                    <li><span class="key-term">Virus</span> - Inserts into programs, executes when host runs</li>
                    <li><span class="key-term">Worm</span> - Autonomous, self-replicating across networks</li>
                    <li><span class="key-term">Spyware</span> - Collects info and reports to creator</li>
                </ul>
                <h3>Attack Types</h3>
                <ul>
                    <li><span class="key-term">Phishing</span> - Posing as legitimate to obtain private info</li>
                    <li><span class="key-term">DoS (Denial of Service)</span> - Overloading computer with messages</li>
                    <li><span class="key-term">MITM (Man-in-the-Middle)</span> - Intercepting data in transit</li>
                    <li><span class="key-term">Brute Force</span> - Trying all possible combinations</li>
                    <li><span class="key-term">Dictionary Attack</span> - Using dictionary words to crack passwords</li>
                </ul>
                <h3>Security Measures</h3>
                <ul>
                    <li><span class="key-term">Firewall</span> - Filters and blocks suspicious network traffic</li>
                    <li><span class="key-term">Proxy Server</span> - Intermediary protecting clients</li>
                    <li><span class="key-term">Encryption</span> - Encoding information to keep it confidential</li>
                    <li><span class="key-term">Network Auditing</span> - Monitors for anomalies</li>
                </ul>`,
            "Operating Systems": `
                <h3>OS Categories</h3>
                <ul>
                    <li><span class="key-term">Network OS</span></li>
                    <li><span class="key-term">Server OS</span></li>
                    <li><span class="key-term">Mobile OS</span></li>
                    <li><span class="key-term">Personal Computer OS</span></li>
                </ul>
                <h3>Major Operating Systems</h3>
                <ul>
                    <li><span class="key-term">Windows</span> - Closed-source by Microsoft, largest market share</li>
                    <li><span class="key-term">macOS</span> - Closed-source by Apple, Apple hardware only</li>
                    <li><span class="key-term">Linux</span> - Open-source, many distributions</li>
                    <li><span class="key-term">Android</span> - Open-source mobile, largest mobile user base</li>
                    <li><span class="key-term">iOS</span> - Apple's proprietary mobile OS</li>
                </ul>
                <h3>OS Components</h3>
                <ul>
                    <li><span class="key-term">Kernel</span> - Core performing basic functions</li>
                    <li><span class="key-term">File Manager</span> - Coordinates storage, maintains records</li>
                    <li><span class="key-term">Device Driver</span> - Enables communication with peripherals</li>
                    <li><span class="key-term">Utility Software</span> - Extends OS capabilities</li>
                </ul>
                <h3>Interfaces</h3>
                <ul>
                    <li><span class="key-term">CLI</span> - Command Line Interface (text commands)</li>
                    <li><span class="key-term">GUI</span> - Graphical User Interface (visual elements)</li>
                </ul>
                <h3>Path Separators</h3>
                <ul>
                    <li><span class="key-term">Windows</span> - Backslash (\\)</li>
                    <li><span class="key-term">Linux</span> - Forward slash (/), case-sensitive</li>
                </ul>`,
            "Programming": `
                <h3>Code Types</h3>
                <ul>
                    <li><span class="key-term">Source Code</span> - Human-readable high-level language</li>
                    <li><span class="key-term">Machine Code</span> - Binary (0s and 1s) computers execute directly</li>
                </ul>
                <h3>Translators</h3>
                <ul>
                    <li><span class="key-term">Compiler</span> - Translates entire source code at once (C, C++, Java, Go)</li>
                    <li><span class="key-term">Interpreter</span> - Translates line by line (Python, JavaScript, PHP, Ruby)</li>
                </ul>
                <h3>Key Concepts</h3>
                <ul>
                    <li><span class="key-term">Algorithm</span> - Step-by-step instructions for a task</li>
                    <li><span class="key-term">Debugging</span> - Finding and fixing code errors</li>
                </ul>`,
            "Licensing": `
                <h3>Software Types</h3>
                <ul>
                    <li><span class="key-term">Open-Source</span> - Anyone can modify and distribute, accessible source code</li>
                    <li><span class="key-term">Closed-Source/Proprietary</span> - Only owner can modify</li>
                    <li><span class="key-term">Shareware</span> - Trial with time/feature limits</li>
                    <li><span class="key-term">Freeware</span> - Free but protected by EULA/copyright</li>
                    <li><span class="key-term">Public Domain</span> - No EULA, no IP protections</li>
                </ul>
                <h3>Legal Protections</h3>
                <ul>
                    <li><span class="key-term">EULA</span> - End-User License Agreement, defines usage terms</li>
                    <li><span class="key-term">Copyright</span> - Prevents unauthorized duplication (35+ years)</li>
                    <li><span class="key-term">Patent</span> - Protects unique methods, algorithms, processes</li>
                </ul>
                <h3>Software Development Types</h3>
                <ul>
                    <li><span class="key-term">Bespoke</span> - Custom-made for specific organization</li>
                    <li><span class="key-term">Off-the-Shelf</span> - General features for broad use</li>
                </ul>`,
            "Databases": `
                <h3>Database Fundamentals</h3>
                <ul>
                    <li><span class="key-term">Database</span> - Organized collection of integrated data</li>
                    <li><span class="key-term">DBMS</span> - Database Management System, manages and handles queries</li>
                    <li><span class="key-term">Record</span> - A row containing related information</li>
                    <li><span class="key-term">Field</span> - A column with single piece of data</li>
                </ul>
                <h3>Keys</h3>
                <ul>
                    <li><span class="key-term">Primary Key</span> - Unique identifier for each record</li>
                    <li><span class="key-term">Foreign Key</span> - References another table's primary key</li>
                </ul>
                <h3>Database Types</h3>
                <ul>
                    <li><span class="key-term">Flat-File</span> - Plain text, one record per line</li>
                    <li><span class="key-term">Hierarchical</span> - Tree structure, parent-child relationships</li>
                    <li><span class="key-term">Relational</span> - Tables joined using keys</li>
                    <li><span class="key-term">NoSQL</span> - Various models (key-value, document, graph)</li>
                </ul>
                <h3>SQL Basics</h3>
                <ul>
                    <li><span class="key-term">SELECT * FROM table</span> - Retrieve all fields from all records</li>
                    <li><span class="key-term">WHERE</span> - Filters records based on conditions</li>
                </ul>`,
            "Project Management": `
                <h3>Project Definition</h3>
                <p>A <span class="key-term">Project</span> is a purpose-driven event with a defined start and finish</p>
                <h3>Project Life Cycle Phases</h3>
                <ul>
                    <li><span class="key-term">Initiation</span> - Business case, feasibility study, project charter</li>
                    <li><span class="key-term">Planning</span> - Goals, scope, project management plan with estimates</li>
                    <li><span class="key-term">Execution</span> - Actual work performed</li>
                    <li><span class="key-term">Closure</span> - Project completion and handoff</li>
                </ul>
                <h3>SMART Goals</h3>
                <ul>
                    <li><span class="key-term">S</span> - Specific</li>
                    <li><span class="key-term">M</span> - Measurable</li>
                    <li><span class="key-term">A</span> - Attainable</li>
                    <li><span class="key-term">R</span> - Realistic</li>
                    <li><span class="key-term">T</span> - Timely</li>
                </ul>
                <h3>Key Concepts</h3>
                <ul>
                    <li><span class="key-term">Scope Creep</span> - Uncontrolled changes adding tasks and costs</li>
                    <li><span class="key-term">WBS</span> - Work Breakdown Structure, breaks project into segments</li>
                    <li><span class="key-term">KPIs</span> - Key Performance Indicators, metrics for progress</li>
                </ul>`,
            "SDLC": `
                <h3>SDLC (Software Development Life Cycle)</h3>
                <p>A framework for developing software through defined phases</p>
                <h3>Development Models</h3>
                <ul>
                    <li><span class="key-term">Waterfall</span> - Sequential, complete each phase before next</li>
                    <li><span class="key-term">Incremental</span> - Built in increments, adding features</li>
                    <li><span class="key-term">Prototyping</span> - Build and evaluate basic versions first</li>
                    <li><span class="key-term">Agile</span> - Incremental, responds to changing requirements</li>
                    <li><span class="key-term">Scrum</span> - Agile method with sprints and daily scrums</li>
                </ul>
                <h3>Key Documents</h3>
                <ul>
                    <li><span class="key-term">Requirements Analysis</span> - Determines services and user interaction</li>
                    <li><span class="key-term">SRS</span> - System Requirement Specification document</li>
                </ul>`,
            "Testing": `
                <h3>Testing Stages</h3>
                <ul>
                    <li><span class="key-term">Alpha Testing</span> - First stage, internal team tests</li>
                    <li><span class="key-term">Beta Testing</span> - End users test before release (pilot testing)</li>
                    <li><span class="key-term">User Acceptance Testing</span> - Final operational testing for business objectives</li>
                </ul>
                <h3>Testing Approaches</h3>
                <ul>
                    <li><span class="key-term">White-Box Testing</span> - Based on internal component knowledge (glass-box)</li>
                    <li><span class="key-term">Black-Box Testing</span> - Focused on UX without internal knowledge</li>
                </ul>
                <p><span class="key-term">Pareto Principle</span> - 80% of errors come from 20% of the system</p>`,
            "Maintenance": `
                <h3>Maintenance Types</h3>
                <ul>
                    <li><span class="key-term">Corrective</span> - Removes errors, ensures functionality</li>
                    <li><span class="key-term">Adaptive</span> - Changes due to organizational requirement changes</li>
                    <li><span class="key-term">Perfective</span> - Adding/improving components for performance</li>
                    <li><span class="key-term">Preventive</span> - Increases system lifespan (restructuring, optimizing)</li>
                </ul>`,
            "IT Governance": `
                <h3>IT Governance</h3>
                <p>Processes ensuring effective IT use to achieve business goals</p>
                <h3>Five IT Function Domains</h3>
                <ul>
                    <li>Communication</li>
                    <li>Data Collection/Management</li>
                    <li>Information Security</li>
                    <li>Customer Relationship Management</li>
                    <li>Process Improvement</li>
                </ul>
                <h3>Sourcing Options</h3>
                <ul>
                    <li><span class="key-term">Outsourcing</span> - Using external organization resources</li>
                    <li><span class="key-term">Insourcing</span> - Assigning to internal employees</li>
                    <li><span class="key-term">Offshoring</span> - Outsourcing outside the country</li>
                    <li><span class="key-term">Nearshoring</span> - Offshoring to nearby countries/similar time zones</li>
                </ul>`,
            "Software": `
                <h3>Software Categories</h3>
                <ul>
                    <li><span class="key-term">System Software</span> - Operates hardware, platform for applications</li>
                    <li><span class="key-term">Application Software</span> - Specific tasks (word processing, email)</li>
                    <li><span class="key-term">Productivity Software</span> - Documents, presentations, data management</li>
                    <li><span class="key-term">Collaboration Software</span> - Communication and teamwork</li>
                    <li><span class="key-term">Utility Software</span> - System maintenance (disk cleaning)</li>
                </ul>
                <h3>Common Applications</h3>
                <ul>
                    <li><span class="key-term">Word Processing</span> - Word, Google Docs, OpenOffice Writer</li>
                    <li><span class="key-term">Spreadsheets</span> - Excel, Google Sheets, OpenOffice Calc</li>
                    <li><span class="key-term">Presentations</span> - PowerPoint, Google Slides, OpenOffice Impress</li>
                </ul>`,
            "Ethics": `
                <h3>Ethics vs Regulations</h3>
                <ul>
                    <li><span class="key-term">Ethics</span> - Personal or organizational morals guiding behavior</li>
                    <li><span class="key-term">Regulations</span> - Requirements from governing bodies with penalties for violations</li>
                    <li><span class="key-term">Conflict of Interest</span> - When a person has incompatible loyalties or relationships</li>
                </ul>
                <h3>Professional Organizations</h3>
                <ul>
                    <li><span class="key-term">ACM</span> - Association for Computing Machinery</li>
                    <li><span class="key-term">IEEE</span> - Institute of Electrical and Electronics Engineers</li>
                    <li><span class="key-term">AITP</span> - Association of Information Technology Professionals</li>
                    <li><span class="key-term">Computer Ethics Institute</span> - Created Ten Commandments of Computer Ethics</li>
                </ul>
                <h3>Policies & Standards</h3>
                <ul>
                    <li><span class="key-term">Acceptable Use Policy (AUP)</span> - Details how organizational computer systems can be used</li>
                    <li><span class="key-term">CIA Triad</span> - Confidentiality, Integrity, Availability</li>
                    <li><span class="key-term">Confidentiality</span> - Restricting access to those who need to know</li>
                    <li><span class="key-term">Integrity</span> - Ensuring data is not modified by unauthorized users</li>
                    <li><span class="key-term">Availability</span> - Ensuring authorized users can access data when needed</li>
                </ul>`
        };

        // Modal Functions
        function openStudyMaterial() {
            let category;
            if (state.currentMode === 'practice' && state.currentQuestion) {
                category = state.currentQuestion.category;
            } else if (state.currentMode === 'exam' && state.examQuestions[state.examIndex - 1]) {
                category = state.examQuestions[state.examIndex - 1].category;
            } else if (state.currentMode === 'exam' && state.examQuestions[state.examIndex]) {
                category = state.examQuestions[state.examIndex].category;
            }

            if (category && studyMaterials[category]) {
                document.getElementById('modal-title').textContent = category + ' - Study Material';
                document.getElementById('modal-body').innerHTML = studyMaterials[category];
            } else {
                document.getElementById('modal-title').textContent = 'Study Material';
                document.getElementById('modal-body').innerHTML = `
                    <p>No study material available for this category: <strong>${category || 'Unknown'}</strong></p>
                    <p style="margin-top: 15px;">For the full course content, return to the menu and click "View Course Content".</p>
                `;
            }
            document.getElementById('study-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeStudyMaterial() {
            document.getElementById('study-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        function closeModalOnOverlay(event) {
            if (event.target === document.getElementById('study-modal')) {
                closeStudyMaterial();
            }
        }

        // ========== IMPORT FUNCTIONALITY ==========
        let parsedImportData = [];
        let importSourceName = 'Pasted Content';
        let importSourceFormat = 'text';

        function showImportModal() {
            document.getElementById('import-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            // Reset state
            document.getElementById('import-textarea').value = '';
            document.getElementById('import-preview-section').style.display = 'none';
            document.getElementById('import-confirm-btn').disabled = true;
            parsedImportData = [];
            importSourceName = 'Pasted Content';
            importSourceFormat = 'text';
            setupDropZone();
        }

        function closeImportModal() {
            document.getElementById('import-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        function closeImportModalOnOverlay(event) {
            if (event.target === document.getElementById('import-modal')) {
                closeImportModal();
            }
        }

        function setupDropZone() {
            const dropZone = document.getElementById('drop-zone');

            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => dropZone.classList.add('drag-over'), false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => dropZone.classList.remove('drag-over'), false);
            });

            dropZone.addEventListener('drop', handleDrop, false);
        }

        function handleDrop(e) {
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        function handleFile(file) {
            importSourceName = file.name || 'Uploaded File';
            const ext = file.name.split('.').pop().toLowerCase();
            importSourceFormat = ext === 'json' ? 'json' : ext === 'csv' ? 'csv' : 'text';

            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('import-textarea').value = e.target.result;
                parseImportData();
            };
            reader.readAsText(file);
        }

        function parseImportData() {
            const text = document.getElementById('import-textarea').value.trim();
            if (!text) {
                alert('Please enter or paste some data to import.');
                return;
            }

            let result = { questions: [], format: 'Unknown' };

            // Try JSON first
            result = tryParseJSON(text);

            // Try CSV if JSON failed
            if (result.questions.length === 0) {
                result = tryParseCSV(text);
            }

            // Try Q&A text format
            if (result.questions.length === 0) {
                result = tryParseQAText(text);
            }

            // Try simple line-by-line (flashcard style)
            if (result.questions.length === 0) {
                result = tryParseFlashcards(text);
            }

            parsedImportData = result.questions;
            showImportPreview(result);
        }

        function tryParseJSON(text) {
            try {
                const data = JSON.parse(text);
                const arr = Array.isArray(data) ? data : [data];
                const questions = arr.map((item, idx) => normalizeQuestion(item, idx)).filter(q => q !== null);
                return { questions, format: 'JSON' };
            } catch (e) {
                return { questions: [], format: 'Unknown' };
            }
        }

        function tryParseCSV(text) {
            const lines = text.split('\n').map(l => l.trim()).filter(l => l);
            if (lines.length < 2) return { questions: [], format: 'Unknown' };

            // Check if first line looks like a header
            const firstLine = lines[0].toLowerCase();
            const hasHeader = firstLine.includes('question') || firstLine.includes('q,') || firstLine.includes('"q"');

            const dataLines = hasHeader ? lines.slice(1) : lines;
            const questions = [];

            for (let i = 0; i < dataLines.length; i++) {
                const parsed = parseCSVLine(dataLines[i]);
                if (parsed.length >= 2) {
                    const q = {
                        id: questions.length + 1,
                        category: 'Imported',
                        q: parsed[0],
                        a: parsed[1],
                        choices: parsed.length >= 6 ? [parsed[2], parsed[3], parsed[4], parsed[5]] : generateChoices(parsed[1]),
                        correct: parsed.length >= 7 ? parseInt(parsed[6]) || 0 : 0
                    };
                    questions.push(q);
                }
            }

            return { questions, format: questions.length > 0 ? 'CSV' : 'Unknown' };
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;

            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current.trim());
            return result;
        }

        function tryParseQAText(text) {
            const questions = [];
            // Match Q: ... A: ... patterns
            const qaPattern = /Q:\s*(.+?)[\n\r]+A:\s*(.+?)(?=[\n\r]+Q:|$)/gis;
            let match;

            while ((match = qaPattern.exec(text)) !== null) {
                const q = {
                    id: questions.length + 1,
                    category: 'Imported',
                    q: match[1].trim(),
                    a: match[2].trim(),
                    choices: generateChoices(match[2].trim()),
                    correct: 0
                };
                questions.push(q);
            }

            return { questions, format: questions.length > 0 ? 'Q&A Text' : 'Unknown' };
        }

        function tryParseFlashcards(text) {
            const questions = [];
            const lines = text.split('\n').map(l => l.trim()).filter(l => l);

            // Look for patterns like "term: definition" or "term - definition"
            for (const line of lines) {
                let parts = null;
                if (line.includes(':')) {
                    parts = line.split(':').map(p => p.trim());
                } else if (line.includes(' - ')) {
                    parts = line.split(' - ').map(p => p.trim());
                } else if (line.includes('\t')) {
                    parts = line.split('\t').map(p => p.trim());
                }

                if (parts && parts.length >= 2 && parts[0] && parts[1]) {
                    const q = {
                        id: questions.length + 1,
                        category: 'Imported',
                        q: parts[0].endsWith('?') ? parts[0] : `What is ${parts[0]}?`,
                        a: parts[1],
                        choices: generateChoices(parts[1]),
                        correct: 0
                    };
                    questions.push(q);
                }
            }

            return { questions, format: questions.length > 0 ? 'Flashcards' : 'Unknown' };
        }

        function normalizeQuestion(item, idx) {
            // Handle various JSON formats
            const q = item.q || item.question || item.Q || item.Question;
            const a = item.a || item.answer || item.A || item.Answer;

            if (!q) return null;

            let choices = item.choices || item.options || item.Options;
            let correct = item.correct ?? item.correctIndex ?? item.answer_index ?? 0;

            if (!choices || !Array.isArray(choices) || choices.length < 2) {
                choices = generateChoices(a || '');
                correct = 0;
            }

            return {
                id: idx + 1,
                category: item.category || item.Category || 'Imported',
                q: q,
                a: a || choices[correct] || '',
                choices: choices,
                correct: correct
            };
        }

        function generateChoices(answer) {
            // For Q&A without choices, generate placeholder choices
            return [
                answer,
                'Alternative answer 1',
                'Alternative answer 2',
                'Alternative answer 3'
            ];
        }

        function showImportPreview(result) {
            const previewSection = document.getElementById('import-preview-section');
            const previewContainer = document.getElementById('import-preview');
            const countEl = document.getElementById('import-count');
            const formatEl = document.getElementById('import-format');
            const confirmBtn = document.getElementById('import-confirm-btn');

            countEl.textContent = result.questions.length;
            formatEl.textContent = result.format;

            if (result.questions.length === 0) {
                previewContainer.innerHTML = '<p style="color: #e94560;">Could not parse any questions. Please check the format.</p>';
                confirmBtn.disabled = true;
            } else {
                const preview = result.questions.slice(0, 5).map((q, i) => `
                    <div class="import-preview-item">
                        <strong style="color: #4fc3f7;">${i + 1}.</strong> ${escapeHtml(q.q.substring(0, 100))}${q.q.length > 100 ? '...' : ''}
                    </div>
                `).join('');

                const moreText = result.questions.length > 5
                    ? `<p style="color: #888; margin-top: 10px;">...and ${result.questions.length - 5} more questions</p>`
                    : '';

                previewContainer.innerHTML = preview + moreText;
                confirmBtn.disabled = false;
            }

            previewSection.style.display = 'block';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        async function confirmImport() {
            if (parsedImportData.length === 0) {
                alert('No questions to import.');
                return;
            }

            const replaceMode = document.getElementById('import-replace').checked;

            // Check free limit for non-Pro users
            if (!state.isPro && !replaceMode) {
                const currentImported = state.importedQuestionCount || 0;
                const newTotal = currentImported + parsedImportData.length;
                if (newTotal > FREE_IMPORT_LIMIT) {
                    const remaining = FREE_IMPORT_LIMIT - currentImported;
                    alert(`Free accounts can import up to ${FREE_IMPORT_LIMIT} questions. You have ${remaining} imports remaining.\n\nUpgrade to Pro for unlimited imports!`);
                    closeImportModal();
                    showUpgradeModal();
                    return;
                }
            }

            // Save source material to API
            const sourceContent = document.getElementById('import-textarea').value;
            await saveSourceMaterial(importSourceName, sourceContent, importSourceFormat, parsedImportData.length);

            if (replaceMode) {
                // Replace all questions
                questions.length = 0;
                parsedImportData.forEach((q, idx) => {
                    q.id = idx + 1;
                    questions.push(q);
                });
                // Reset progress since questions changed
                state.mastered = [];
                state.answerCounts = {};
                state.totalCorrect = 0;
                state.totalAnswered = 0;
                state.importedQuestionCount = parsedImportData.length;
            } else {
                // Add to existing questions
                const startId = questions.length > 0 ? Math.max(...questions.map(q => q.id)) + 1 : 1;
                parsedImportData.forEach((q, idx) => {
                    q.id = startId + idx;
                    questions.push(q);
                });
                state.importedQuestionCount = (state.importedQuestionCount || 0) + parsedImportData.length;
            }

            // Update UI and save immediately (not debounced)
            updateStats();
            saveState(true);
            closeImportModal();

            alert(`Successfully imported ${parsedImportData.length} questions! They are now saved to your keyword "${currentKeyword}".${replaceMode ? ' Progress has been reset.' : ''}`);
        }

        // ========== SOURCE MATERIAL VIEWER ==========

        function showSourcesModal() {
            document.getElementById('sources-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            document.getElementById('source-content-view').style.display = 'none';
            document.getElementById('sources-list').style.display = 'block';
            loadSources();
        }

        function closeSourcesModal() {
            document.getElementById('sources-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        function closeSourcesModalOnOverlay(event) {
            if (event.target === event.currentTarget) {
                closeSourcesModal();
            }
        }

        async function loadSources() {
            const listEl = document.getElementById('sources-list');

            // Check if keyword is selected
            if (!currentKeyword) {
                listEl.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #ff6b6b;">
                        <p>No keyword selected. Please select a keyword first.</p>
                        <p style="font-size: 0.85rem; color: #888; margin-top: 10px;">Go to Manage Keywords in the menu to select or create a keyword.</p>
                    </div>
                `;
                return;
            }

            listEl.innerHTML = '<div style="text-align: center; padding: 40px; color: #888;">Loading sources...</div>';

            try {
                const url = `https://www.vandromeda.com/api/quizmyself/source.php?keyword=${encodeURIComponent(currentKeyword)}`;
                console.log('Loading sources for keyword:', currentKeyword, 'URL:', url);
                const headers = {};
                if (currentUser) {
                    const token = await currentUser.getIdToken();
                    headers['Authorization'] = `Bearer ${token}`;
                }

                const response = await fetch(url, { headers });
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error || 'Failed to load sources');
                }

                // Update storage bar
                const usedMB = (data.storageUsed / (1024 * 1024)).toFixed(2);
                const limitMB = (data.storageLimit / (1024 * 1024)).toFixed(0);
                const percent = data.storageLimit > 0 ? (data.storageUsed / data.storageLimit) * 100 : 0;

                document.getElementById('sources-storage-text').textContent = `${usedMB} MB / ${limitMB} MB${data.isPro ? ' (Pro)' : ''}`;
                document.getElementById('sources-storage-bar').style.width = `${Math.min(percent, 100)}%`;

                if (data.sources.length === 0) {
                    listEl.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #888;">
                            <div style="font-size: 48px; margin-bottom: 15px;">üì≠</div>
                            <p>No imported sources yet.</p>
                            <p style="font-size: 0.9rem;">Import quiz data to see your sources here.</p>
                        </div>
                    `;
                    return;
                }

                listEl.innerHTML = data.sources.map(source => `
                    <div class="source-item" style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #2a2a2a; border-radius: 8px; margin-bottom: 10px;">
                        <div style="flex: 1;">
                            <div style="font-weight: bold; color: #fff; margin-bottom: 5px;">${escapeHtml(source.name)}</div>
                            <div style="font-size: 0.85rem; color: #888;">
                                ${source.questionCount} questions | ${formatBytes(source.sizeBytes)} | ${formatDate(source.importedAt)}
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn btn-small" onclick="viewSourceContent(${source.id}, '${escapeHtml(source.name).replace(/'/g, "\\'")}')">View</button>
                            <button class="btn btn-danger btn-small" onclick="deleteSource(${source.id}, '${escapeHtml(source.name).replace(/'/g, "\\'")}')">Delete</button>
                        </div>
                    </div>
                `).join('');

            } catch (err) {
                console.error('Error loading sources:', err);
                listEl.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #ff6b6b;">
                        <p>Failed to load sources: ${escapeHtml(err.message)}</p>
                        <button class="btn btn-small" onclick="loadSources()" style="margin-top: 15px;">Retry</button>
                    </div>
                `;
            }
        }

        async function viewSourceContent(id, name) {
            document.getElementById('sources-list').style.display = 'none';
            document.getElementById('source-content-view').style.display = 'block';
            document.getElementById('source-content-title').textContent = name;
            document.getElementById('source-content-text').textContent = 'Loading...';

            try {
                const url = `https://www.vandromeda.com/api/quizmyself/source.php?keyword=${encodeURIComponent(currentKeyword)}&id=${id}`;
                const headers = {};
                if (currentUser) {
                    const token = await currentUser.getIdToken();
                    headers['Authorization'] = `Bearer ${token}`;
                }

                const response = await fetch(url, { headers });
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error || 'Failed to load source');
                }

                let content = data.content || '(No content)';

                // Decompress if content was stored compressed
                if (data.contentType && data.contentType.includes('+gzip')) {
                    document.getElementById('source-content-text').textContent = 'Decompressing...';
                    const decompressed = await decompressContent(content);
                    if (decompressed) {
                        content = decompressed;
                    } else {
                        content = '(Failed to decompress content)';
                    }
                }

                document.getElementById('source-content-text').textContent = content;

            } catch (err) {
                document.getElementById('source-content-text').textContent = `Error: ${err.message}`;
            }
        }

        function hideSourceContent() {
            document.getElementById('source-content-view').style.display = 'none';
            document.getElementById('sources-list').style.display = 'block';
        }

        async function deleteSource(id, name) {
            if (!confirm(`Delete "${name}"? This cannot be undone.`)) {
                return;
            }

            try {
                const url = `https://www.vandromeda.com/api/quizmyself/source.php?keyword=${encodeURIComponent(currentKeyword)}&id=${id}`;
                const headers = {};
                if (currentUser) {
                    const token = await currentUser.getIdToken();
                    headers['Authorization'] = `Bearer ${token}`;
                }

                const response = await fetch(url, { method: 'DELETE', headers });
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error || 'Failed to delete source');
                }

                // Reload the list
                loadSources();

            } catch (err) {
                alert(`Failed to delete: ${err.message}`);
            }
        }

        function formatBytes(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
        }

        function formatDate(dateStr) {
            const d = new Date(dateStr);
            return d.toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function escapeHtml(str) {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        // Compress content using gzip and return base64
        async function compressContent(content) {
            try {
                const encoder = new TextEncoder();
                const data = encoder.encode(content);
                const cs = new CompressionStream('gzip');
                const writer = cs.writable.getWriter();
                writer.write(data);
                writer.close();
                const compressedData = await new Response(cs.readable).arrayBuffer();
                // Convert to base64
                const bytes = new Uint8Array(compressedData);
                let binary = '';
                for (let i = 0; i < bytes.length; i++) {
                    binary += String.fromCharCode(bytes[i]);
                }
                return btoa(binary);
            } catch (err) {
                console.warn('Compression failed, storing uncompressed:', err);
                return null;
            }
        }

        // Decompress base64 gzip content
        async function decompressContent(base64Data) {
            try {
                const binary = atob(base64Data);
                const bytes = new Uint8Array(binary.length);
                for (let i = 0; i < binary.length; i++) {
                    bytes[i] = binary.charCodeAt(i);
                }
                const ds = new DecompressionStream('gzip');
                const writer = ds.writable.getWriter();
                writer.write(bytes);
                writer.close();
                const decompressedData = await new Response(ds.readable).arrayBuffer();
                const decoder = new TextDecoder();
                return decoder.decode(decompressedData);
            } catch (err) {
                console.warn('Decompression failed:', err);
                return null;
            }
        }

        async function saveSourceMaterial(name, content, contentType, questionCount) {
            try {
                const url = `https://www.vandromeda.com/api/quizmyself/source.php?keyword=${encodeURIComponent(currentKeyword)}`;
                const headers = { 'Content-Type': 'application/json' };
                if (currentUser) {
                    const token = await currentUser.getIdToken();
                    headers['Authorization'] = `Bearer ${token}`;
                }

                // Try to compress content
                let storedContent = content;
                let storedType = contentType;
                const compressed = await compressContent(content);
                if (compressed && compressed.length < content.length * 0.9) {
                    // Only use compression if it saves at least 10%
                    storedContent = compressed;
                    storedType = contentType + '+gzip';
                    console.log(`Compressed ${content.length} -> ${compressed.length} bytes (${Math.round(compressed.length/content.length*100)}%)`);
                }

                const response = await fetch(url, {
                    method: 'POST',
                    headers,
                    body: JSON.stringify({ name, content: storedContent, contentType: storedType, questionCount })
                });

                const data = await response.json();
                if (!response.ok) {
                    console.warn('Failed to save source material:', data.error);
                }
            } catch (err) {
                console.warn('Failed to save source material:', err);
            }
        }

        // ========== UPGRADE/PAYMENT FUNCTIONALITY ==========

        // Store pending session ID for license lookup
        let pendingLicenseSessionId = null;

        function showUpgradeModal(options = {}) {
            document.getElementById('upgrade-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            document.getElementById('upgrade-error').style.display = 'none';
            document.getElementById('upgrade-success').style.display = 'none';
            document.getElementById('license-key-input').value = '';

            // Handle license status display (with safety checks for DOM elements)
            const licenseStatusSection = document.getElementById('license-status-section');
            const licensePending = document.getElementById('license-pending');
            const licenseFound = document.getElementById('license-found');
            const licenseDisplay = document.getElementById('license-display');

            // Only try to show license status if the DOM elements exist
            if (licenseStatusSection && licensePending && licenseFound) {
                if (options.pendingSessionId) {
                    // Payment succeeded but license not yet captured
                    pendingLicenseSessionId = options.pendingSessionId;
                    licenseStatusSection.style.display = 'block';
                    licensePending.style.display = 'block';
                    licenseFound.style.display = 'none';
                } else if (options.licenseKey) {
                    // License was found - display it
                    pendingLicenseSessionId = null;
                    licenseStatusSection.style.display = 'block';
                    licensePending.style.display = 'none';
                    licenseFound.style.display = 'block';
                    if (licenseDisplay) {
                        licenseDisplay.textContent = options.licenseKey;
                    }
                } else {
                    // Normal modal open - hide license status
                    licenseStatusSection.style.display = 'none';
                    licensePending.style.display = 'none';
                    licenseFound.style.display = 'none';
                }
            } else if (options.licenseKey) {
                // Fallback: show alert with license key if DOM elements don't exist
                alert('Pro activated! Your license key: ' + options.licenseKey);
            }

            // Show login required message if not signed in with Firebase
            const loginRequired = document.getElementById('upgrade-login-required');
            const upgradeContent = document.getElementById('upgrade-content');
            if (currentUser) {
                loginRequired.style.display = 'none';
                upgradeContent.style.display = 'block';
            } else {
                loginRequired.style.display = 'block';
                upgradeContent.style.display = 'none';
            }
        }

        function closeUpgradeModal() {
            document.getElementById('upgrade-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        function closeUpgradeModalOnOverlay(event) {
            if (event.target === document.getElementById('upgrade-modal')) {
                closeUpgradeModal();
            }
        }

        async function checkForLicense() {
            if (!pendingLicenseSessionId) {
                showUpgradeError('No pending license to check.');
                return;
            }

            const btn = document.getElementById('check-license-btn');
            const originalText = btn.textContent;
            btn.textContent = 'Checking...';
            btn.disabled = true;

            try {
                const response = await fetch(`${VANDROMEDA_API}/license/by-session.php?session_id=${encodeURIComponent(pendingLicenseSessionId)}`);
                const data = await response.json();

                if (data.status === 'ok' && data.license_key) {
                    // License found!
                    state.isPro = true;
                    state.licenseKey = data.license_key;
                    if (data.email) {
                        state.email = data.email;
                    }

                    // For keyword-only users, store in localStorage
                    if (!currentUser && currentKeyword) {
                        localStorage.setItem(`quizmyself_license_${currentKeyword}`, data.license_key);
                        if (data.email) {
                            localStorage.setItem(`quizmyself_email_${currentKeyword}`, data.email);
                        }
                    }

                    updateProUI();
                    updateHamburgerMenu();
                    pendingLicenseSessionId = null;

                    // Auto-close modal after brief delay - user is now Pro
                    setTimeout(() => closeUpgradeModal(), 500);
                } else if (data.status === 'pending') {
                    showUpgradeError('License still processing. Please wait a moment and try again, or check your email.');
                } else {
                    showUpgradeError('Could not find license. Please check your email for the license key.');
                }
            } catch (error) {
                console.error('License check error:', error);
                showUpgradeError('Network error. Please try again.');
            } finally {
                btn.textContent = originalText;
                btn.disabled = false;
            }
        }

        function copyLicenseKey() {
            const licenseKey = document.getElementById('license-display').textContent;
            if (licenseKey) {
                navigator.clipboard.writeText(licenseKey).then(() => {
                    alert('License key copied to clipboard!');
                }).catch(() => {
                    // Fallback for older browsers
                    prompt('Copy your license key:', licenseKey);
                });
            }
        }

        function showProFeaturesModal() {
            document.getElementById('pro-features-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            document.getElementById('pro-license-display').textContent = state.licenseKey || '-';
        }

        function closeProFeaturesModal() {
            document.getElementById('pro-features-modal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        async function startCheckout(plan) {
            const priceId = STRIPE_PRICES[plan];
            if (!priceId || priceId.includes('TODO')) {
                alert('Payment is not yet configured. Please check back later or contact support.');
                return;
            }

            // Use logged-in user's email (user must be signed in to upgrade)
            const email = currentUser?.email;
            if (!email) {
                showUpgradeError('Please sign in to subscribe.');
                return;
            }

            try {
                const baseUrl = window.location.origin + window.location.pathname;
                const response = await fetch(`${VANDROMEDA_API}/payments/create-checkout.php`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        price_id: priceId,
                        product: 'quizmyself',
                        customer_email: email,
                        success_url: baseUrl + '?payment=success&session_id={CHECKOUT_SESSION_ID}',
                        cancel_url: baseUrl + '?payment=cancelled',
                        metadata: {
                            product: 'quizmyself',
                            tier: 'pro',
                            max_domains: '3'
                        }
                    })
                });

                const data = await response.json();

                if (data.status === 'ok' && data.checkout_url) {
                    // Redirect to Stripe Checkout
                    window.location.href = data.checkout_url;
                } else {
                    showUpgradeError(data.error || 'Failed to create checkout session');
                }
            } catch (error) {
                console.error('Checkout error:', error);
                showUpgradeError('Network error. Please try again.');
            }
        }

        async function activateLicense() {
            const licenseKey = document.getElementById('license-key-input').value.trim();
            if (!licenseKey) {
                showUpgradeError('Please enter a license key.');
                return;
            }

            try {
                const response = await fetch(`${VANDROMEDA_API}/license/validate.php`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        license_key: licenseKey,
                        domain: window.location.hostname || 'localhost'
                    })
                });

                const data = await response.json();

                if (data.valid) {
                    // License is valid - activate Pro
                    state.isPro = true;
                    state.licenseKey = licenseKey;
                    if (data.email) {
                        state.email = data.email;
                    }
                    // Store license per-keyword
                    if (currentKeyword) {
                        localStorage.setItem(`quizmyself_license_${currentKeyword}`, licenseKey);
                        if (data.email) {
                            localStorage.setItem(`quizmyself_email_${currentKeyword}`, data.email);
                        }
                    }
                    updateProUI();
                    updateHamburgerMenu();
                    showUpgradeSuccess('License activated! Welcome to Pro!');
                    setTimeout(() => closeUpgradeModal(), 2000);
                } else {
                    showUpgradeError(data.reason || 'Invalid license key.');
                }
            } catch (error) {
                console.error('License validation error:', error);
                showUpgradeError('Network error. Please try again.');
            }
        }

        async function fetchLicenseFromSession(sessionId) {
            // Try to fetch license created by webhook
            let attempts = 0;
            const maxAttempts = 5;

            while (attempts < maxAttempts) {
                try {
                    const response = await fetch(`${VANDROMEDA_API}/license/by-session.php?session_id=${encodeURIComponent(sessionId)}`);
                    const data = await response.json();

                    if (data.status === 'ok' && data.license_key) {
                        // License found - set state immediately
                        state.isPro = true;
                        state.licenseKey = data.license_key;
                        if (data.email) {
                            state.email = data.email;
                        }

                        // For keyword-only users, store in localStorage
                        if (!currentUser && currentKeyword) {
                            localStorage.setItem(`quizmyself_license_${currentKeyword}`, data.license_key);
                            if (data.email) {
                                localStorage.setItem(`quizmyself_email_${currentKeyword}`, data.email);
                            }
                        }

                        updateProUI();
                        updateHamburgerMenu();
                        // Close modal if open - user is now Pro
                        closeUpgradeModal();
                        return true; // Success - license captured
                    } else if (data.status === 'pending') {
                        // Webhook hasn't processed yet - wait and retry
                        attempts++;
                        await new Promise(r => setTimeout(r, 2000));
                        continue;
                    } else {
                        break;
                    }
                } catch (error) {
                    console.error('License fetch error:', error);
                    break;
                }
            }

            // Fallback - show modal with pending status
            showUpgradeModal({ pendingSessionId: sessionId });
            return false; // Failed to capture license
        }

        async function checkProStatus() {
            // For Firebase users, license is tied to account (handled by checkProStatusForAccount)
            // Don't override account-based pro status
            if (currentUser) {
                updateProUI();
                updateHamburgerMenu();
                return;
            }

            // Reset pro status for keyword-only users
            state.isPro = false;
            state.licenseKey = null;
            state.email = null;

            // Need keyword to check per-user license
            if (!currentKeyword) {
                updateProUI();
                updateHamburgerMenu();
                return;
            }

            // Check for stored email (per-keyword)
            const storedEmail = localStorage.getItem(`quizmyself_email_${currentKeyword}`);
            if (storedEmail) {
                state.email = storedEmail;
            }

            // Check for stored license (per-keyword)
            const storedLicense = localStorage.getItem(`quizmyself_license_${currentKeyword}`);
            if (storedLicense) {
                try {
                    const response = await fetch(`${VANDROMEDA_API}/license/validate.php`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            license_key: storedLicense,
                            domain: window.location.hostname || 'localhost'
                        })
                    });

                    const data = await response.json();

                    if (data.valid) {
                        state.isPro = true;
                        state.licenseKey = storedLicense;
                        if (data.email) {
                            state.email = data.email;
                            localStorage.setItem(`quizmyself_email_${currentKeyword}`, data.email);
                        }
                    } else {
                        // License expired or invalid - remove it
                        localStorage.removeItem(`quizmyself_license_${currentKeyword}`);
                        localStorage.removeItem(`quizmyself_email_${currentKeyword}`);
                        state.isPro = false;
                        state.licenseKey = null;
                        state.email = null;
                    }
                } catch (error) {
                    console.error('Pro status check failed:', error);
                    // On network error, trust the stored license temporarily
                    state.isPro = true;
                    state.licenseKey = storedLicense;
                }
            }

            // Note: Payment success handling is done in onAuthStateChanged to ensure
            // we know the auth state before processing (Firebase user vs keyword-only)

            updateProUI();
            updateHamburgerMenu();
        }

        function updateProUI() {
            const topBarStatus = document.getElementById('top-bar-status');
            const topBarText = document.getElementById('top-bar-status-text');

            if (state.isPro) {
                topBarStatus.classList.remove('free');
                topBarStatus.classList.add('pro');
                topBarStatus.onclick = showProFeaturesModal;
                topBarStatus.style.cursor = 'pointer';
                topBarText.innerHTML = 'Pro Member <span class="pro-badge">PRO</span>';
            } else {
                topBarStatus.classList.remove('pro');
                topBarStatus.classList.add('free');
                topBarStatus.onclick = toggleHamburgerMenu;
                topBarStatus.style.cursor = 'pointer';
                topBarText.textContent = 'Free Account';
            }
        }

        function showUpgradeError(message) {
            const errorEl = document.getElementById('upgrade-error');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
            document.getElementById('upgrade-success').style.display = 'none';
        }

        function showUpgradeSuccess(message) {
            const successEl = document.getElementById('upgrade-success');
            successEl.textContent = message;
            successEl.style.display = 'block';
            document.getElementById('upgrade-error').style.display = 'none';
        }

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeStudyMaterial();
                closeImportModal();
                closeUpgradeModal();
            }
        });

        // Welcome screen functions
        let welcomeSelectedCategories = new Set();

        function shouldShowWelcome() {
            // Don't show if user has seen welcome before
            if (localStorage.getItem('quizmyself_welcome_seen')) return false;
            // Don't show if user already has a keyword/session
            if (localStorage.getItem('quizmyself_keyword')) return false;
            // Don't show if returning from Stripe checkout
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('session_id') || urlParams.has('canceled')) return false;
            return true;
        }

        function showWelcome() {
            const welcomeScreen = document.getElementById('welcome-screen');
            welcomeScreen.classList.remove('hidden');
            populateWelcomeCategories();
        }

        function populateWelcomeCategories() {
            const container = document.getElementById('welcome-categories');
            const categories = [...new Set(demoQuestions.map(q => q.category))];

            container.innerHTML = categories.map(cat =>
                `<button class="welcome-category-chip selected" onclick="toggleWelcomeCategory(this, '${cat}')">${cat}</button>`
            ).join('');

            // Start with all selected
            welcomeSelectedCategories = new Set(categories);
        }

        function toggleWelcomeCategory(btn, category) {
            btn.classList.toggle('selected');
            if (welcomeSelectedCategories.has(category)) {
                welcomeSelectedCategories.delete(category);
            } else {
                welcomeSelectedCategories.add(category);
            }
        }

        function startWelcomeQuiz() {
            // If no categories selected, select all
            if (welcomeSelectedCategories.size === 0) {
                const categories = [...new Set(demoQuestions.map(q => q.category))];
                welcomeSelectedCategories = new Set(categories);
            }

            // Mark welcome as seen
            localStorage.setItem('quizmyself_welcome_seen', 'true');

            // Hide welcome screen
            document.getElementById('welcome-screen').classList.add('hidden');

            // Apply selected categories to the main category filter
            selectedCategories = new Set(welcomeSelectedCategories);
            updateCategoryChips();
            updateStats();

            // Start practice quiz
            startPractice();
        }

        function dismissWelcome() {
            localStorage.setItem('quizmyself_welcome_seen', 'true');
            document.getElementById('welcome-screen').classList.add('hidden');
        }

        // Initialize
        (async function() {
            // Check if we should show welcome screen
            if (shouldShowWelcome()) {
                showWelcome();
            }

            const savedKeyword = localStorage.getItem('quizmyself_keyword');
            if (savedKeyword) {
                currentKeyword = savedKeyword;
                document.getElementById('stats-bar').style.display = 'flex';
                await loadState();
                await checkProStatus();
            } else {
                document.getElementById('stats-bar').style.display = 'none';
            }
            updateHamburgerMenu();
            updateStats();
        })();
        checkDeploymentStatus();

        // Check if there's a newer version being deployed
        async function checkDeploymentStatus() {
            const REPO = 'FullStackKevinVanDriel/quizlet';
            const deployedSha = document.querySelector('meta[name="deployed-sha"]')?.content;

            try {
                // Get latest commit SHA
                const commitRes = await fetch(`https://api.github.com/repos/${REPO}/commits/main`);
                if (!commitRes.ok) return;
                const commitData = await commitRes.json();
                const latestSha = commitData.sha;

                // If deployed SHA doesn't match latest, check build status
                if (deployedSha && deployedSha !== '__COMMIT_SHA__' && deployedSha !== latestSha) {
                    showDeployBanner('New version merged, deploying...');
                    return;
                }

                // Also check if Pages is currently building
                const pagesRes = await fetch(`https://api.github.com/repos/${REPO}/pages/builds`);
                if (!pagesRes.ok) return;
                const builds = await pagesRes.json();

                if (builds[0]?.status === 'building' || builds[0]?.status === 'queued') {
                    showDeployBanner('Deploying update...');
                }
            } catch (e) {
                // Silently fail - don't disrupt the quiz
            }
        }

        function showDeployBanner(message) {
            const banner = document.getElementById('deploy-banner');
            banner.textContent = message;
            banner.classList.remove('hidden');
            document.body.classList.add('has-banner');
        }
    </script>
</body>
</html>
